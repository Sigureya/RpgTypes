"use strict";var ce=Object.defineProperty;var ie=(e,a,r)=>a in e?ce(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var k=(e,a,r)=>ie(e,typeof a!="symbol"?a+"":a,r);const s=require("./make.cjs2.js"),de=require("jsonpath-js"),pe=require("@sigureya/rmmz-plugin-schema"),P=require("./mergeItemsSource.cjs.js"),D=(e,a,r)=>e.filter(t=>t.code===s.CHANGE_ARMORS||t.code===s.CHANGE_ITEMS||t.code===s.CHANGE_WEAPONS).map(t=>Y(t,a,r)),le={[s.CHANGE_WEAPONS]:"weapon",[s.CHANGE_ARMORS]:"armor",[s.CHANGE_ITEMS]:"item"},Y=(e,a,r)=>{const t=s.isUsingVariableItemCommand(e)?{direct:!1,variableId:e.parameters[3]}:{direct:!0,value:e.parameters[3]},m=e.parameters[1]===s.OPERATION_GAIN?a.gain:e.parameters[1]===s.OPERATION_LOSE?a.lose:a.unknown,n=typeof e.parameters[4]=="boolean"?{includesEquip:e.parameters[4]}:{};return{itemKind:le[e.code],dataId:s.getItemIdFromItemCommand(e),code:e.code,commandNameMZ:r(e.code),operation:m,...n,...t}},ue=e=>!!e,V=(e,a)=>e.pages.map((r,t)=>a(r,t,e)),j=(e,a)=>e.events.filter(ue).flatMap(r=>V(r,a)),ge=e=>e.conditions.itemId>0&&e.conditions.itemValid?{pageCondition:{itemId:e.conditions.itemId}}:{},R=(e,a)=>{const r=e.trimEnd(),t=a.get(r);return t?t.trimEnd():r},i=(e,a)=>{const r=e.trimEnd(),t=a(r);return t?t.trimEnd():r},f=(e,a,r=`
`)=>s.replaceNote(e.note,t=>i(t.value,a),r),U=(e,a)=>{switch(e.code){case s.SHOW_MESSAGE:return he(e,a);case s.SHOW_CHOICES:return Ne(e,a);case s.SHOW_MESSAGE_BODY:case s.COMMENT_HEAD:case s.COMMENT_BODY:case s.SHOW_SCROLLING_TEXT_BODY:return ye(e,a);case s.CHANGE_NAME:case s.CHANGE_NICKNAME:case s.CHANGE_PROFILE:return xe(e,a);default:return e}},ye=(e,a)=>{const r=i(e.parameters[0],a);return{code:e.code,indent:e.indent,parameters:[r]}},he=(e,a)=>{const r=e.parameters[4]?i(e.parameters[4],a):"";return s.makeCommandShowMessage({facename:e.parameters[0],faceIndex:e.parameters[1],background:e.parameters[2],positionType:e.parameters[3],speakerName:r},e.indent)},xe=(e,a)=>{const r=i(e.parameters[1],a);return{code:e.code,indent:e.indent,parameters:[e.parameters[0],r]}},Ne=(e,a)=>{const r=e.parameters[0].map(t=>i(t,a));return{code:s.SHOW_CHOICES,indent:e.indent,parameters:[r,e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}},F=(e,a)=>({params:Se(e.params,r=>i(r,a)),messages:fe(e.messages,r=>i(r,a)),basic:Te(e.basic,r=>i(r,a)),commands:Ee(e.commands,r=>i(r,a))}),Te=(e,a)=>[a(e[0]),a(e[1]),a(e[2]),a(e[3]),a(e[4]),a(e[5]),a(e[6]),a(e[7]),a(e[8]),a(e[9])],Ee=(e,a)=>[a(e[0]),a(e[1]),a(e[2]),a(e[3]),a(e[4]),a(e[5]),a(e[6]),a(e[7]),a(e[8]),a(e[9]),a(e[10]),a(e[11]),a(e[12]),a(e[13]),a(e[14]),a(e[15]),a(e[16]),a(e[17]),a(e[18]),a(e[19]),"",a(e[21]),a(e[22]),"",a(e[24]),a(e[25])],Se=(e,a)=>[a(e[0]),a(e[1]),a(e[2]),a(e[3]),a(e[4]),a(e[5]),a(e[6]),a(e[7]),a(e[8]),a(e[9])],fe=(e,a)=>({actionFailure:a(e.actionFailure),actorDamage:a(e.actorDamage),actorDrain:a(e.actorDrain),actorGain:a(e.actorGain),actorLoss:a(e.actorLoss),actorNoDamage:a(e.actorNoDamage),actorNoHit:a(e.actorNoHit),actorRecovery:a(e.actorRecovery),alwaysDash:a(e.alwaysDash),autosave:a(e.autosave),bgmVolume:a(e.bgmVolume),bgsVolume:a(e.bgsVolume),buffAdd:a(e.buffAdd),buffRemove:a(e.buffRemove),commandRemember:a(e.commandRemember),counterAttack:a(e.counterAttack),criticalToActor:a(e.criticalToActor),criticalToEnemy:a(e.criticalToEnemy),defeat:a(e.defeat),debuffAdd:a(e.debuffAdd),emerge:a(e.emerge),enemyDamage:a(e.enemyDamage),enemyDrain:a(e.enemyDrain),enemyGain:a(e.enemyGain),enemyLoss:a(e.enemyLoss),enemyNoDamage:a(e.enemyNoDamage),enemyNoHit:a(e.enemyNoHit),enemyRecovery:a(e.enemyRecovery),escapeFailure:a(e.escapeFailure),escapeStart:a(e.escapeStart),evasion:a(e.evasion),expNext:a(e.expNext),expTotal:a(e.expTotal),file:a(e.file),loadMessage:a(e.loadMessage),levelUp:a(e.levelUp),magicEvasion:a(e.magicEvasion),magicReflection:a(e.magicReflection),meVolume:a(e.meVolume),obtainExp:a(e.obtainExp),obtainGold:a(e.obtainGold),obtainItem:a(e.obtainItem),obtainSkill:a(e.obtainSkill),partyName:a(e.partyName),possession:a(e.possession),preemptive:a(e.preemptive),saveMessage:a(e.saveMessage),seVolume:a(e.seVolume),substitute:a(e.substitute),surprise:a(e.surprise),touchUI:a(e.touchUI),useItem:a(e.useItem),victory:a(e.victory)}),M=(e,a)=>e.map(r=>i(r,a)),X=e=>e.map(a=>a.parameters[0].trimEnd()).join(`
`).trimEnd();class q{constructor(a,r){this.header=a,this.bodies=r}getBodyText(){return X(this.joinCommandBodies())}mergedBody(){return{code:this.header.code,indent:this.header.indent,parameters:[this.getBodyText()]}}joinCommandBodies(){return[this.header,...this.bodies]}normalizedCommands(){return[this.mergedBody()]}}class L{constructor(a,r,t){this.bodyCode=a,this.header=r,this.bodies=t}normalizedCommands(){const a={...this.header,code:this.header.code,indent:this.header.indent,parameters:[...this.header.parameters]};return this.bodies.length===0?[a]:[a,this.mergedBody()]}getBodyText(){return X(this.bodies)}joinCommandBodies(){return this.bodies}mergedBody(){return{code:this.bodyCode,indent:this.header.indent,parameters:[this.getBodyText()]}}}const v=(e,a,r,t)=>{const m=e[a];if(!r(m))throw new Error(`Invalid head at index ${a}: ${JSON.stringify(m)}`);const n=[];for(let o=a+1;o<e.length;o++){const c=e[o];if(!t(c))break;n.push(c)}return{header:m,bodies:n}},Ce=(e,a)=>{const{bodies:r,header:t}=((m,n)=>v(m,n,o=>o.code===s.COMMENT_HEAD,o=>o.code===s.COMMENT_BODY))(e,a);return be(t)?new L(s.COMMENT_BODY,t,r):new q(t,r)},be=e=>e.parameters[0]==="選択肢ヘルプ",_e=(e,a)=>{const{bodies:r,header:t}=((m,n)=>v(m,n,o=>o.code===s.SHOW_MESSAGE,o=>o.code===s.SHOW_MESSAGE_BODY))(e,a);return new L(s.SHOW_MESSAGE_BODY,t,r)},Ae=(e,a)=>{const{bodies:r,header:t}=((m,n)=>v(m,n,o=>o.code===s.SCRIPT_EVAL,o=>o.code===s.SCRIPT_EVAL_BODY))(e,a);return new q(t,r)},Ie=(e,a)=>{const{bodies:r,header:t}=((m,n)=>v(m,n,o=>o.code===s.SHOW_SCROLLING_TEXT,o=>o.code===s.SHOW_SCROLLING_TEXT_BODY))(e,a);return new L(s.SHOW_SCROLLING_TEXT_BODY,t,r)},Me={[s.SHOW_MESSAGE]:(e,a,r)=>r.showMessage(_e(e,a),a,e),[s.SCRIPT_EVAL]:(e,a,r)=>r.script(Ae(e,a),a,e),[s.COMMENT_HEAD]:(e,a,r)=>r.comment(Ce(e,a),a,e),[s.SHOW_SCROLLING_TEXT]:(e,a,r)=>r.showScrollingText(Ie(e,a),a,e)},J=e=>Me[e],Oe=e=>((a,r)=>({code:a.code,paramIndex:r,value:a.parameters[r]}))(e,1),O=(e,a)=>z(e,a),z=(e,a)=>e.flatMap((r,t)=>ve(r,t,e,a)).filter(r=>r!==null),ve=(e,a,r,t)=>{if(e.code===s.SHOW_CHOICES)return(n=>n.parameters[0].map((o,c)=>({code:102,paramIndex:c,value:o})))(e);const m=J(e.code);if(m){const n=m(r,a,De);if(n!==void 0)return[n]}return e.code===s.CHANGE_NICKNAME||e.code===s.CHANGE_NAME||e.code===s.CHANGE_PROFILE?Oe(e):e.code===s.PLUGIN_COMMAND_MZ?t(e):null},De={comment:e=>{return a=e,{code:s.COMMENT_HEAD,paramIndex:0,value:a.getBodyText()};var a},showMessage:e=>{return a=e,{code:s.SHOW_MESSAGE_BODY,paramIndex:0,value:a.getBodyText(),speaker:(r=a.header,r.parameters[4]?r.parameters[4].trimEnd():"")};var a,r},script:e=>(a=>({code:s.SCRIPT_EVAL,paramIndex:0,value:a.getBodyText()}))(e),showScrollingText:e=>(a=>({code:s.SHOW_SCROLLING_TEXT_BODY,paramIndex:0,value:a.getBodyText()}))(e)},Z=(e,a=()=>[])=>({eventId:e.id,commands:O(e.list,a)}),K=(e,a=()=>[])=>e.pages.map((r,t)=>({eventId:e.id,pageIndex:t,commands:O(r.list,a)})),Q=(e,a=()=>[])=>({note:e.note,noteItems:s.readNote(e.note),displayedName:e.displayName,events:Be(e,a)}),Be=(e,a)=>j(e,(r,t,m)=>({eventId:m.id,pageIndex:t,commands:O(r.list,a),note:m.note,noteItems:s.readNote(m.note),name:m.name})),ee=e=>(a=>a.kind.endsWith("[]"))(e.attr),ae=e=>e.kind==="struct",re=e=>e.attr.kind==="struct[]",He=e=>te[e.kind.replace("[]","")].type==="number",Ge=e=>te[e.kind.replace("[]","")].type==="string",A={type:"string",hasText:!0},x={type:"number",hasText:!1},h={type:"number",hasText:!1},te={string:A,number:{type:"number",hasText:!1},boolean:{type:"boolean"},armor:x,actor:x,class:x,enemy:x,skill:x,state:x,item:x,weapon:x,common_event:x,switch:x,variable:x,troop:x,multiline_string:A,file:{type:"string",hasText:!1},"file[]":{type:"string",hasText:!1},"multiline_string[]":A,"string[]":A,combo:A,select:A,any:A,struct:{type:"struct"},"actor[]":h,"enemy[]":h,"class[]":h,"skill[]":h,"state[]":h,"item[]":h,"weapon[]":h,"common_event[]":h,"troop[]":h,"armor[]":h,"switch[]":h,"variable[]":h,"number[]":h};function we(e){return Le(e,a=>!0,a=>!0)}const Le=(e,a,r)=>{const t=[],m=[],n=[],o=[];return e.forEach(c=>{if(ae(c.attr))t.push({name:c.name,attr:c.attr});else if(re(c))m.push(c);else if(ee(c)){if(r(c))return void o.push(c)}else a(c)&&n.push(c)}),{structs:t,structArrays:m,scalars:n,scalarArrays:o}};function ke(e){const a=e.map(r=>[r.name,r.attr]);return Object.fromEntries(a)}const Pe=(e,a)=>{if(e.length!==0)return`${a}[${e.map(r=>`"${r.name}"`).join(",")}]`},Re=(e,a)=>e.map(r=>({path:`${a}["${r.name}"][*]`,param:r})),se={undefinedStruct:"undefined_struct",cyclicStruct:"cyclic_struct"};function me(e,a,r,t){const m={items:[],errs:[],frames:[{schemaName:e,basePath:a,ancestry:[]}]},n=Math.max(1,3*r.size+5),o=Array.from({length:n}).reduce(c=>c.frames.length===0?c:function(d,T,E){if(d.frames.length===0)return d;const p=d.frames[d.frames.length-1],N=d.frames.slice(0,-1);if(p.ancestry.includes(p.schemaName))return{frames:N,items:d.items,errs:[...d.errs,{code:E.cyclicStruct,path:p.basePath}]};const u=T.get(p.schemaName);if(!u)return{frames:N,items:d.items,errs:[...d.errs,{code:E.undefinedStruct,path:p.basePath}]};const C=function(y,g){const l=y.ancestry.concat(y.schemaName),b=y.basePath;return[...g.structs.map(_=>({schemaName:_.attr.struct,basePath:`${b}["${_.name}"]`,ancestry:l})),...g.structArrays.map(_=>({schemaName:_.attr.struct,basePath:`${b}["${_.name}"][*]`,ancestry:l}))].reverse()}(p,u);if(u.scalars.length>0||u.scalarArrays.length>0){const y=function(g,{path:l,structName:b}){return{category:"struct",objectSchema:ke(g.scalars),name:b,scalarArrays:Re(g.scalarArrays,l),scalarsPath:g.scalars.length>0?Pe(g.scalars,l):void 0}}(u,{path:p.basePath,structName:p.schemaName});return N.push(...C),{frames:N,items:[...d.items,y],errs:d.errs}}return N.push(...C),{frames:N,items:d.items,errs:d.errs}}(c,r,t),m);return{items:o.items,errors:o.errs}}const Fe=(e,a,r,t=se)=>me(e.attr.struct,`${a}["${e.name}"]`,r,t),We=(e,a,r,t=se)=>me(e.attr.struct,`${a}["${e.name}"][*]`,r,t),$e=(e,a,r,t)=>(m=>ae(m.attr))(r)?je(e,r,t):re(r)?Ue(e,r,t):ee(r)?Ye(e,a,r):Ve(e,a,r),Ye=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{name:"",objectSchema:{},scalarsPath:void 0,scalarArrays:[{path:`$["${r.name}"][*]`,param:r}]},structs:{items:[],errors:[]},structArrays:{items:[],errors:[]}}),Ve=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{name:r.attr.kind,objectSchema:{[r.name]:r.attr},scalarsPath:`$["${r.name}"]`,scalarArrays:[]},structArrays:{items:[],errors:[]},structs:{items:[],errors:[]}}),je=(e,a,r)=>({rootName:a.name,rootCategory:e,scalars:void 0,structArrays:{items:[],errors:[]},structs:Fe(a,"$",r)}),Ue=(e,a,r)=>({structArrays:We(a,"$",r),rootName:a.name,rootCategory:e,scalars:void 0,structs:{items:[],errors:[]}}),Xe=(e,a)=>a.map(r=>qe(e,r)).flat(3),qe=(e,a)=>[a.top?B(a,e,a.top,""):[],a.structs.map(r=>B(a,e,r)),a.structArrays.map(r=>B(a,e,r))],B=(e,a,r,t=r.bundleName)=>{const m=r.scalar?((o,c,d,T,E)=>T.pathSegments(d).map(({value:p,segments:N})=>((u,C,y,g,l)=>{if(typeof y=="object"||y===null)return null;const b=g[g.length-1];if(typeof b=="number")return null;const _=l[b];return _?{rootName:u.rootName,rootType:u.rootCategory,structName:C,value:y,param:{name:b,attr:_}}:null})(o,c,p,N,E)).filter(p=>p!==null))(e,t,a,r.scalar.jsonPathJS,r.scalar.record):[],n=r.arrays.map(o=>((c,d,T,E)=>{const p=E.jsonPathJS.find(T);if(!Array.isArray(p))return[];const N=E.schema.attr;return Ge(N)?((u,C,y,g)=>C.filter(l=>typeof l=="string").map(l=>({rootName:u.rootName,rootType:u.rootCategory,value:l,structName:y,param:g})))(c,p,d,E.schema):He(N)?((u,C,y,g)=>C.filter(l=>typeof l=="number").map(l=>({rootName:u.rootName,rootType:u.rootCategory,value:l,structName:y,param:g})))(c,p,d,E.schema):[]})(e,t,a,o));return[m,n].flat(2)},H=(e,a)=>e.scalarsPath?{bundleName:e.name,arrays:W(e.scalarArrays,e.name,a),scalar:Je(e.scalarsPath,e.objectSchema,a)}:{bundleName:e.name,arrays:W(e.scalarArrays,e.name,a)},W=(e,a,r)=>e.map(t=>({jsonPathJS:r(t.path),schema:t.param,parentType:a})),Je=(e,a,r)=>({jsonPathJS:r(e),record:a}),ze=(e,a,r,t)=>({pluginName:e,commandName:a.command,desc:a.desc??"",text:a.text??"",extractors:Ze(a,r,t)}),Ze=(e,a,r)=>e.args.map(t=>((m,n)=>{const o=m.scalars?H(m.scalars,n):void 0,c=m.structs.items.map(T=>H(T,n)),d=m.structArrays.items.map(T=>H(T,n));return{rootCategory:m.rootCategory,rootName:m.rootName,top:o,structs:c,structArrays:d}})($e("args",e.command,t,a),r)),Ke=(e,a)=>{const r=(t=>new Map(t.map(m=>[m.struct,we(m.params)])))(e.schema.structs);return Qe(e.pluginName,e.schema.commands,r,a)},Qe=(e,a,r,t)=>a.map(m=>[`${e}:${m.command}`,ze(e,m,r,t)]),ne=(e,a)=>{const[r,t]=e.parameters,m=`${r}:${t}`,n=a.get(m);return n?((o,c)=>({pluginName:c.pluginName,commandName:c.commandName,args:Xe(o,c.extractors)}))(pe.parseDeepRecord(e.parameters[3]),n):{pluginName:r,commandName:t,args:[]}};class G{constructor(a){k(this,"_commandMap");this._commandMap=a}keys(){return Array.from(this._commandMap.keys())}extractMapTexts(a){return Q(a,r=>this.extractArgs(r))}extractBattleText(a){return K(a,r=>this.extractArgs(r))}extractCommonEventText(a){return Z(a,r=>this.extractArgs(r))}extractArgs(a){const r=ne(a,this._commandMap);return r.args.filter(ea).map(t=>({code:s.PLUGIN_COMMAND_MZ,value:t.value,paramIndex:3,argName:t.param.name,argTitle:t.param.attr.text??t.param.name,commandName:r.commandName,pluginName:r.pluginName}))}extractCommandTexts(a){return O(a,r=>this.extractArgs(r))}}const ea=e=>typeof e.value=="string",w=(e,a,r)=>({folder:r,key:a,image:e[a],id:e.id}),S=(e,a)=>({note:oe(e),main:a.map(r=>({key:r,text:e[r],id:e.id}))}),oe=e=>s.readNoteEx(e.note,(a,r)=>({key:a,text:r,id:e.id})),aa=(e,a,r,t)=>{if(e.code===s.SHOW_MESSAGE_BODY||e.code===s.SHOW_SCROLLING_TEXT_BODY||e.code===s.COMMENT_BODY)return;const m=J(e.code);return m?m(r,a,t):e.code===s.SHOW_CHOICES?ra(e):e.code===s.CHANGE_NAME||e.code===s.CHANGE_NICKNAME||e.code===s.CHANGE_PROFILE?ta(e):e.code!==s.SCRIPT_EVAL_BODY?e:void 0},ra=e=>({code:s.SHOW_CHOICES,indent:e.indent,parameters:[e.parameters[0].map(a=>a.trimEnd()),e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}),ta=e=>({code:e.code,indent:e.indent,parameters:[e.parameters[0],e.parameters[1].trimEnd()]}),sa=e=>({code:s.SCRIPT_EVAL,indent:e.header.indent,parameters:[e.getBodyText().trimEnd()]}),ma=e=>{const a=e.getBodyText().trimEnd(),r={code:s.SHOW_MESSAGE_BODY,indent:e.header.indent,parameters:[a]};return[oa(e.header),r]},na=e=>{const a=e.getBodyText().trimEnd(),r={code:s.SHOW_SCROLLING_TEXT_BODY,indent:e.header.indent,parameters:[a]};return[e.header,r]},oa=e=>{const a=e.parameters[4]?e.parameters[4].trimEnd():"";return{code:e.code,indent:e.indent,parameters:[e.parameters[0],e.parameters[1],e.parameters[2],e.parameters[3],a]}},I=(e,a)=>{const r=t=>a.text(t);return(t=>{const m={comment:n=>n.normalizedCommands(),script:sa,showMessage:ma,showScrollingText:na};return t.map((n,o)=>n.code===s.PLUGIN_COMMAND_MZ?n:aa(n,o,t,m)).filter(n=>n!==void 0).flat()})(e).map(t=>t.code===s.PLUGIN_COMMAND_MZ?a.pluginCommand(t):t.code===s.SCRIPT_EVAL?a.scriptCommand(t):U(t,r))},$=(e,a,r)=>({note:f(e,a),displayName:i(e.displayName,a),events:s.repleaceMapEventCommands(e.events,r),data:e.data,tilesetId:e.tilesetId,encounterStep:e.encounterStep,scrollType:e.scrollType,specifyBattleback:e.specifyBattleback,autoplayBgm:e.autoplayBgm,autoplayBgs:e.autoplayBgs,battleback1Name:e.battleback1Name,battleback2Name:e.battleback2Name,bgm:e.bgm,bgs:e.bgs,disableDashing:e.disableDashing,encounterList:e.encounterList,height:e.height,width:e.width,parallaxLoopX:e.parallaxLoopX,parallaxLoopY:e.parallaxLoopY,parallaxName:e.parallaxName,parallaxShow:e.parallaxShow,parallaxSx:e.parallaxSx,parallaxSy:e.parallaxSy});exports.buildReferenceItemSources=(e,a,r,t,m,n)=>[...s.defineTraitItems(r,t),...s.defineGameDataSources(e,a),...s.defineSystemItems(m,n)],exports.compileItemEffectDisplayData=(e,a,r)=>{const t=s.resolveItemEffectLabels(a);return P.mergeItemsSource(r?[...t,...r]:t,e)},exports.compileTraitDisplayData=(e,a)=>P.mergeItemsSource(s.resolveTraitLabels(a),e),exports.createTextDataExtractor=()=>new G(new Map),exports.createTextDataExtractorFromCommandItems=e=>{const a=new Map(e);return new G(a)},exports.createTextDataExtractorFromSchemas=e=>{const a=e.flatMap(r=>Ke(r,t=>new de.JSONPathJS(t)));return new G(new Map(a))},exports.extractBattleEventTexts=K,exports.extractCommonEventTexts=Z,exports.extractImageFromActor=e=>[w(e,"faceName","faces"),w(e,"characterName","characters"),w(e,"battlerName","sv_actors")],exports.extractImageFromEnemy=e=>({key:"battlerName",image:e.battlerName,id:e.id}),exports.extractItemChangeData=Y,exports.extractItemCommands=D,exports.extractItemFromMap=(e,a,r)=>j(e.map,(t,m,n)=>({...ge(t),commands:D(t.list,a,r),eventName:n.name,pageIndex:m})),exports.extractItemFromTroop=(e,a,r)=>{return t=(m,n,o)=>({commands:D(m.list,a,r),eventName:o.name,troopId:o.id,pageIndex:n}),e.flatMap(m=>V(m,t));var t},exports.extractMapText=Q,exports.extractNoteText=oe,exports.extractPluginCommandMzArgs=ne,exports.extractTextData=S,exports.extractTextFromActor=e=>S(e,["name","nickname","profile"]),exports.extractTextFromArmor=e=>S(e,["name","description"]),exports.extractTextFromClass=e=>S(e,["name"]),exports.extractTextFromEnemy=e=>S(e,["name"]),exports.extractTextFromEventCommands=e=>z(e,()=>[]),exports.extractTextFromEventCommandsEx=O,exports.extractTextFromItem=e=>S(e,["name","description"]),exports.extractTextFromSkill=e=>S(e,["name","description","message1","message2"]),exports.extractTextFromState=e=>S(e,["name","message1","message2","message3","message4"]),exports.extractTextFromSystem=e=>({gameTitle:e.gameTitle,currencyUnit:e.currencyUnit,equipTypes:[...e.equipTypes],armorTypes:[...e.armorTypes],weaponTypes:[...e.weaponTypes],terms:{basic:s.makeTermsBasicFromArray(e.terms.basic),commands:s.makeTermsCommandFromArray(e.terms.commands),messages:s.makeTermsMessages(e.terms.messages),params:s.makeParamNamesFromArray(e.terms.params)}}),exports.extractTextFromWeapon=e=>S(e,["name","description"]),exports.replaceActorText=(e,a)=>{const r=f(e,a),t=i(e.name,a),m=i(e.nickname,a),n=i(e.profile,a);return{...e,name:t,nickname:m,profile:n,note:r}},exports.replaceBasicEventCommandTexts=U,exports.replaceClassText=(e,a)=>{const r=f(e,a),t=i(e.name,a);return{...e,name:t,note:r}},exports.replaceCommonEventData=(e,a)=>({id:e.id,name:e.name,trigger:e.trigger,switchId:e.switchId,list:I(e.list,a)}),exports.replaceCommonEventTexts=(e,a)=>({id:e.id,name:i(e.name,a),trigger:e.trigger,switchId:e.switchId,list:I(e.list,{pluginCommand:r=>r,scriptCommand:r=>r,text:a})}),exports.replaceEnemyText=(e,a)=>{const r=f(e,a),t=i(e.name,a);return{...e,name:t,note:r}},exports.replaceEventCommandTexts=I,exports.replaceItemText=(e,a)=>{const r=f(e,a),t=i(e.name,a),m=i(e.description,a);return{...e,name:t,description:m,note:r}},exports.replaceMapData=(e,a)=>$(e,r=>a.text(r),r=>I(r,a)),exports.replaceMapTexts=(e,a)=>$(e,a,r=>I(r,{pluginCommand:t=>t,scriptCommand:t=>t,text:a})),exports.replaceNoteTextByFunction=f,exports.replaceNoteTextByMap=(e,a,r=`
`)=>f(e,t=>a.get(t),r),exports.replaceSkillText=(e,a)=>{const r=f(e,a),t=i(e.name,a),m=i(e.description,a),n=i(e.message1,a),o=i(e.message2,a);return{...e,name:t,description:m,message1:n,message2:o,note:r}},exports.replaceStateText=(e,a)=>{const r=f(e,a),t=i(e.name,a),m=i(e.message1,a),n=i(e.message2,a),o=i(e.message3,a),c=i(e.message4,a);return{...e,name:t,message1:m,message2:n,message3:o,message4:c,note:r}},exports.replaceSystemTermsByMap=(e,a)=>F(e,r=>R(r,a)),exports.replaceSystemText=(e,a)=>({...e,gameTitle:i(e.gameTitle,a),currencyUnit:i(e.currencyUnit,a),elements:M(e.elements,a),skillTypes:M(e.skillTypes,a),weaponTypes:M(e.weaponTypes,a),armorTypes:M(e.armorTypes,a),equipTypes:M(e.equipTypes,a),terms:F(e.terms,a)}),exports.replaceTextByMap=R,exports.replaceTroopData=(e,a)=>({members:e.members,id:e.id,name:e.name,pages:e.pages.map(r=>({conditions:r.conditions,span:r.span,list:I(r.list,a)}))}),exports.replaceTroopTexts=(e,a)=>{const r={pluginCommand:t=>t,scriptCommand:t=>t,text:a};return{members:e.members,id:e.id,name:i(e.name,a),pages:e.pages.map(t=>({conditions:t.conditions,span:t.span,list:I(t.list,r)}))}};
