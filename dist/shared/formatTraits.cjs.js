"use strict";var ie=Object.defineProperty;var de=(e,a,r)=>a in e?ie(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var R=(e,a,r)=>de(e,typeof a!="symbol"?a+"":a,r);const n=require("./make.cjs2.js"),pe=require("jsonpath-js"),ue=require("@sigureya/rmmz-plugin-schema"),F=require("./mergeItemsSource.cjs.js"),M=(e,a,r)=>e.reduce((s,m)=>(m.code!==n.CHANGE_ARMORS&&m.code!==n.CHANGE_ITEMS&&m.code!==n.CHANGE_WEAPONS||s.push(V(m,a,r)),s),[]),le={[n.CHANGE_WEAPONS]:"weapon",[n.CHANGE_ARMORS]:"armor",[n.CHANGE_ITEMS]:"item"},V=(e,a,r)=>{const s=e.parameters[3]===n.OPERAND_DIRECT?{direct:!0,value:e.parameters[2]}:{direct:!1,variableId:e.parameters[2]},m=e.parameters[0]===n.OPERATION_GAIN?a.gain:e.parameters[0]===n.OPERATION_LOSE?a.lose:a.unknown,o=typeof e.parameters[4]=="boolean"?{includesEquip:e.parameters[4]}:{};return{itemKind:le[e.code],dataId:e.parameters[1],code:e.code,commandNameMZ:r(e.code),operation:m,...o,...s}},ye=e=>!!e,G=(e,a)=>e.pages.map((r,s)=>a(r,s,e)),Y=(e,a)=>e.events.filter(ye).flatMap(r=>G(r,a)),ge=e=>e.conditions.itemId>0&&e.conditions.itemValid?{pageCondition:{itemId:e.conditions.itemId}}:{},t=(e,a)=>{const r=e.trimEnd(),s=a.get(r);return s?s.trimEnd():r},h=(e,a,r=`
`)=>n.replaceNote(e.note,s=>t(s.value,a),r),_=(e,a)=>e.map(r=>{switch(r.code){case n.SHOW_MESSAGE:return q(r,a);case n.SHOW_CHOICES:return X(r,a);case n.SHOW_MESSAGE_BODY:case n.COMMENT_HEAD:case n.COMMENT_BODY:case n.SHOW_SCROLLING_TEXT_BODY:return U(r,a);case n.CHANGE_NAME:case n.CHANGE_NICKNAME:case n.CHANGE_PROFILE:return J(r,a);default:return r}}),U=(e,a)=>{const r=t(e.parameters[0],a);return{code:e.code,indent:e.indent,parameters:[r]}},q=(e,a)=>{const r=e.parameters[4]?t(e.parameters[4],a):"";return n.makeCommandShowMessage({facename:e.parameters[0],faceIndex:e.parameters[1],background:e.parameters[2],positionType:e.parameters[3],speakerName:r},e.indent)},J=(e,a)=>{const r=t(e.parameters[1],a);return{code:e.code,indent:e.indent,parameters:[e.parameters[0],r]}},X=(e,a)=>{const r=e.parameters[0].map(s=>t(s,a));return{code:n.SHOW_CHOICES,indent:e.indent,parameters:[r,e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}},L=(e,a)=>({params:xe(e.params,a),messages:Ne(e.messages,a),commands:Te(e.commands,a),basic:he(e.basic,a)}),he=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a)],Te=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a),t(e[10],a),t(e[11],a),t(e[12],a),t(e[13],a),t(e[14],a),t(e[15],a),t(e[16],a),t(e[17],a),t(e[18],a),t(e[19],a),"",t(e[21],a),t(e[22],a),"",t(e[24],a),t(e[25],a)],xe=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a)],Ne=(e,a)=>({actionFailure:t(e.actionFailure,a),actorDamage:t(e.actorDamage,a),actorDrain:t(e.actorDrain,a),actorGain:t(e.actorGain,a),actorLoss:t(e.actorLoss,a),actorNoDamage:t(e.actorNoDamage,a),actorNoHit:t(e.actorNoHit,a),actorRecovery:t(e.actorRecovery,a),alwaysDash:t(e.alwaysDash,a),autosave:t(e.autosave,a),bgmVolume:t(e.bgmVolume,a),bgsVolume:t(e.bgsVolume,a),buffAdd:t(e.buffAdd,a),buffRemove:t(e.buffRemove,a),commandRemember:t(e.commandRemember,a),counterAttack:t(e.counterAttack,a),criticalToActor:t(e.criticalToActor,a),criticalToEnemy:t(e.criticalToEnemy,a),defeat:t(e.defeat,a),debuffAdd:t(e.debuffAdd,a),emerge:t(e.emerge,a),enemyDamage:t(e.enemyDamage,a),enemyDrain:t(e.enemyDrain,a),enemyGain:t(e.enemyGain,a),enemyLoss:t(e.enemyLoss,a),enemyNoDamage:t(e.enemyNoDamage,a),enemyNoHit:t(e.enemyNoHit,a),enemyRecovery:t(e.enemyRecovery,a),escapeFailure:t(e.escapeFailure,a),escapeStart:t(e.escapeStart,a),evasion:t(e.evasion,a),expNext:t(e.expNext,a),expTotal:t(e.expTotal,a),file:t(e.file,a),loadMessage:t(e.loadMessage,a),levelUp:t(e.levelUp,a),magicEvasion:t(e.magicEvasion,a),magicReflection:t(e.magicReflection,a),meVolume:t(e.meVolume,a),obtainExp:t(e.obtainExp,a),obtainGold:t(e.obtainGold,a),obtainItem:t(e.obtainItem,a),obtainSkill:t(e.obtainSkill,a),partyName:t(e.partyName,a),possession:t(e.possession,a),preemptive:t(e.preemptive,a),saveMessage:t(e.saveMessage,a),seVolume:t(e.seVolume,a),substitute:t(e.substitute,a),surprise:t(e.surprise,a),touchUI:t(e.touchUI,a),useItem:t(e.useItem,a),victory:t(e.victory,a)}),v=(e,a)=>e.map(r=>t(r,a)),z=e=>e.map(a=>a.parameters[0].trimEnd()).join(`
`).trimEnd();class K{constructor(a,r){this.header=a,this.bodies=r}getBodyText(){return z(this.joinCommandBodies())}mergedBody(){return{code:this.header.code,indent:this.header.indent,parameters:[this.getBodyText()]}}joinCommandBodies(){return[this.header,...this.bodies]}normalizedCommands(){return[this.mergedBody()]}}class w{constructor(a,r,s){this.bodyCode=a,this.header=r,this.bodies=s}normalizedCommands(){const a={...this.header,code:this.header.code,indent:this.header.indent,parameters:[...this.header.parameters]};return this.bodies.length===0?[a]:[a,this.mergedBody()]}getBodyText(){return z(this.bodies)}joinCommandBodies(){return this.bodies}mergedBody(){return{code:this.bodyCode,indent:this.header.indent,parameters:[this.getBodyText()]}}}const I=(e,a,r,s)=>{const m=e[a];if(!r(m))throw new Error(`Invalid head at index ${a}: ${JSON.stringify(m)}`);const o=[];for(let c=a+1;c<e.length;c++){const i=e[c];if(!s(i))break;o.push(i)}return{header:m,bodies:o}},fe=(e,a)=>{const{bodies:r,header:s}=((m,o)=>I(m,o,c=>c.code===n.COMMENT_HEAD,c=>c.code===n.COMMENT_BODY))(e,a);return Ee(s)?new w(n.COMMENT_BODY,s,r):new K(s,r)},Ee=e=>e.parameters[0]==="選択肢ヘルプ",Se=(e,a)=>{const{bodies:r,header:s}=((m,o)=>I(m,o,c=>c.code===n.SHOW_MESSAGE,c=>c.code===n.SHOW_MESSAGE_BODY))(e,a);return new w(n.SHOW_MESSAGE_BODY,s,r)},Ae=(e,a)=>{const{bodies:r,header:s}=((m,o)=>I(m,o,c=>c.code===n.SCRIPT_EVAL,c=>c.code===n.SCRIPT_EVAL_BODY))(e,a);return new K(s,r)},ve=(e,a)=>{const{bodies:r,header:s}=((m,o)=>I(m,o,c=>c.code===n.SHOW_SCROLLING_TEXT,c=>c.code===n.SHOW_SCROLLING_TEXT_BODY))(e,a);return new w(n.SHOW_SCROLLING_TEXT_BODY,s,r)},be={[n.SHOW_MESSAGE]:(e,a,r)=>r.showMessage(Se(e,a),a,e),[n.SCRIPT_EVAL]:(e,a,r)=>r.script(Ae(e,a),a,e),[n.COMMENT_HEAD]:(e,a,r)=>r.comment(fe(e,a),a,e),[n.SHOW_SCROLLING_TEXT]:(e,a,r)=>r.showScrollingText(ve(e,a),a,e)},O=e=>((a,r)=>({code:a.code,paramIndex:r,value:a.parameters[r]}))(e,1),Ce=e=>e.parameters[0].map((a,r)=>({code:102,paramIndex:r,value:a})),b=(e,a)=>Z(e,a),Z=(e,a)=>e.reduce((r,s,m)=>{if(s.code===n.SHOW_CHOICES)return[...r,...Ce(s)];const o=(c=s.code,be[c]);var c;if(o){const i=o(e,m,_e);if(i!==void 0)return[...r,i]}if(s.code===n.CHANGE_NICKNAME)return[...r,O(s)];if(s.code===n.CHANGE_NAME)return[...r,O(s)];if(s.code===n.CHANGE_PROFILE)return[...r,O(s)];if(s.code===n.PLUGIN_COMMAND_MZ){const i=a(s);return i.length===0?r:[...r,...i]}return r},[]),_e={comment:e=>{return a=e,{code:n.COMMENT_HEAD,paramIndex:0,value:a.getBodyText()};var a},showMessage:e=>{return a=e,{code:n.SHOW_MESSAGE_BODY,paramIndex:0,value:a.getBodyText(),speaker:(r=a.header,r.parameters[4]?r.parameters[4].trimEnd():"")};var a,r},script:e=>(a=>({code:n.SCRIPT_EVAL,paramIndex:0,value:a.getBodyText()}))(e),showScrollingText:e=>(a=>({code:n.SHOW_SCROLLING_TEXT_BODY,paramIndex:0,value:a.getBodyText()}))(e)},Q=(e,a=()=>[])=>{return r=(s,m,{id:o})=>({eventId:o,commands:b(s.list,a)}),e.map(s=>r(s,0,s));var r},ee=(e,a=()=>[])=>((r,s)=>r.map(m=>G(m,s)))(e,(r,s,{id:m})=>({eventId:m,pageIndex:s,commands:b(r.list,a)})),ae=(e,a=()=>[])=>({note:e.note,noteItems:n.readNote(e.note),displayedName:e.displayName,events:Ie(e,a)}),Ie=(e,a)=>Y(e,(r,s,m)=>({eventId:m.id,pageIndex:s,commands:b(r.list,a),note:m.note,noteItems:n.readNote(m.note),name:m.name})),re=e=>(a=>a.kind.endsWith("[]"))(e.attr),te=e=>e.kind==="struct",se=e=>e.attr.kind==="struct[]",x={type:"string",hasText:!0},u={type:"number",hasText:!1},p={type:"number",hasText:!1},$={string:x,number:{type:"number",hasText:!1},boolean:{type:"boolean"},armor:u,actor:u,class:u,enemy:u,skill:u,state:u,item:u,weapon:u,common_event:u,switch:u,variable:u,troop:u,multiline_string:x,file:{type:"string",hasText:!1},"file[]":{type:"string",hasText:!1},"multiline_string[]":x,"string[]":x,combo:x,select:x,any:x,struct:{type:"struct"},"actor[]":p,"enemy[]":p,"class[]":p,"skill[]":p,"state[]":p,"item[]":p,"weapon[]":p,"common_event[]":p,"troop[]":p,"armor[]":p,"switch[]":p,"variable[]":p,"number[]":p},Me=e=>Oe(e,a=>!0,a=>!0),Oe=(e,a,r)=>{const s=[],m=[],o=[],c=[];return e.forEach(i=>{if(te(i.attr))s.push({name:i.name,attr:i.attr});else if(se(i))m.push(i);else if(re(i)){if(r(i))return void c.push(i)}else a(i)&&o.push(i)}),{structs:s,structArrays:m,scalars:o,scalarArrays:c}};function De(e){const a=e.map(r=>[r.name,r.attr]);return Object.fromEntries(a)}const He=(e,a)=>{if(e.length!==0)return`${a}[${e.map(r=>`"${r.name}"`).join(",")}]`},ke=(e,a)=>e.map(r=>({path:`${a}.${r.name}[*]`,param:r})),me={undefinedStruct:"undefined_struct",cyclicStruct:"cyclic_struct"};function oe(e,a,r,s){const m={items:[],errs:[],frames:[{schemaName:e,basePath:a,ancestry:[]}]},o=Math.max(1,3*r.size+5),c=Array.from({length:o}).reduce(i=>i.frames.length===0?i:function(d,y,B){if(d.frames.length===0)return d;const g=d.frames[d.frames.length-1],N=d.frames.slice(0,-1);if(g.ancestry.includes(g.schemaName))return{frames:N,items:d.items,errs:[...d.errs,{code:B.cyclicStruct,path:g.basePath}]};const f=y.get(g.schemaName);if(!f)return{frames:N,items:d.items,errs:[...d.errs,{code:B.undefinedStruct,path:g.basePath}]};const P=function(E,T){const S=E.ancestry.concat(E.schemaName),C=E.basePath;return[...T.structs.map(A=>({schemaName:A.attr.struct,basePath:`${C}.${A.name}`,ancestry:S})),...T.structArrays.map(A=>({schemaName:A.attr.struct,basePath:`${C}.${A.name}[*]`,ancestry:S}))].reverse()}(g,f);if(f.scalars.length>0||f.scalarArrays.length>0){const E=function(T,{path:S,structName:C}){return{category:"struct",objectSchema:De(T.scalars),name:C,scalarArrays:ke(T.scalarArrays,S),scalarsPath:T.scalars.length>0?He(T.scalars,S):void 0}}(f,{path:g.basePath,structName:g.schemaName});return N.push(...P),{frames:N,items:[...d.items,E],errs:d.errs}}return N.push(...P),{frames:N,items:d.items,errs:d.errs}}(i,r,s),m);return{items:c.items,errors:c.errs}}const Ge=(e,a,r,s=me)=>{const m=e.map(o=>oe(o.attr.struct,`${a}.${o.name}`,r,s));return{items:m.flatMap(o=>o.items),errors:m.flatMap(o=>o.errors)}},we=(e,a,r,s=me)=>{const m=e.map(o=>oe(o.attr.struct,`${a}.${o.name}[*]`,r,s));return{items:m.flatMap(o=>o.items),errors:m.flatMap(o=>o.errors)}},Be=(e,a,r,s)=>(m=>te(m.attr))(r)?Fe(e,r,s):se(r)?Le(e,r,s):re(r)?Pe(e,a,r):Re(e,a,r),Pe=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{category:e,name:"array",objectSchema:{},scalarsPath:void 0,scalarArrays:[{path:`$.${r.name}[*]`,param:r}]},structs:{items:[],errors:[]},structArrays:{items:[],errors:[]}}),Re=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{category:"primitive",name:r.attr.kind,objectSchema:{[r.name]:r.attr},scalarsPath:`$.${r.name}`,scalarArrays:[]},structArrays:{items:[],errors:[]},structs:{items:[],errors:[]}}),Fe=(e,a,r)=>({rootName:a.name,rootCategory:e,scalars:void 0,structArrays:{items:[],errors:[]},structs:Ge([a],"$",r)}),Le=(e,a,r)=>({structArrays:we([a],"$",r),rootName:a.name,rootCategory:e,scalars:void 0,structs:{items:[],errors:[]}}),$e=(e,a)=>a.map(r=>We(e,r)).flat(3),We=(e,a)=>[a.top?D(a,e,a.top):[],a.structs.map(r=>D(a,e,r)),a.structArrays.map(r=>D(a,e,r))],D=(e,a,r)=>{const s=r.bundleName;return[r.scalar?je(e,s,a,r.scalar.jsonPathJS,r.scalar.record):[],r.arrays.map(m=>Ve(e,s,a,m))].flat(2)},je=(e,a,r,s,m)=>s.pathSegments(r).reduce((o,{value:c,segments:i})=>{if(typeof c=="object")return o;const d=i[i.length-1];if(typeof d=="number")return o;const y=m[d];return y&&o.push({roootName:e.rootName,rootType:e.rootCategory,category:"struct",name:a,value:c,param:{name:d,attr:y}}),o},[]),Ve=(e,a,r,s)=>{const m=s.jsonPathJS.find(r);if(!Array.isArray(m))return[];const o=s.schema.attr;return(c=>$[c.kind.replace("[]","")].type==="string")(o)?m.filter(c=>typeof c=="string").map(c=>({value:c,category:"struct",rootType:e.rootCategory,roootName:e.rootName,name:a,param:s.schema})):(c=>$[c.kind.replace("[]","")].type==="number")(o)?m.filter(c=>typeof c=="number").map(c=>({roootName:e.rootName,rootType:e.rootCategory,value:c,category:"struct",name:a,param:s.schema})):[]},H=(e,a)=>e.scalarsPath?{bundleName:e.name,arrays:W(e.scalarArrays,e.name,a),scalar:Ye(e.scalarsPath,e.objectSchema,a)}:{bundleName:e.name,arrays:W(e.scalarArrays,e.name,a)},W=(e,a,r)=>e.map(s=>({jsonPathJS:r(s.path),schema:s.param,parentType:a})),Ye=(e,a,r)=>({jsonPathJS:r(e),record:a}),Ue=(e,a,r,s)=>({pluginName:e,commandName:a.command,desc:a.desc??"",text:a.text??"",extractors:qe(a,r,s)}),qe=(e,a,r)=>e.args.map(s=>((m,o)=>{const c=m.scalars?H(m.scalars,o):void 0,i=m.structs.items.map(y=>H(y,o)),d=m.structArrays.items.map(y=>H(y,o));return{rootCategory:m.rootCategory,rootName:m.rootName,top:c,structs:i,structArrays:d}})(Be("args",e.command,s,a),r)),Je=(e,a)=>{const r=(s=>new Map(s.map(m=>[m.struct,Me(m.params)])))(e.schema.structs);return e.schema.commands.map(s=>[`${e.pluginName}:${s.command}`,Ue(e.pluginName,s,r,a)])},ne=(e,a)=>{const[r,s]=e.parameters,m=`${r}:${s}`,o=a.get(m);if(!o)return{pluginName:r,commandName:s,values:[]};return i=ue.parseDeepRecord(e.parameters[3]),{pluginName:(d=o).pluginName,commandName:d.commandName,values:$e(i,d.extractors)};var i,d};class j{constructor(a){R(this,"_commandMap");this._commandMap=a}keys(){return Array.from(this._commandMap.keys())}extractMapTexts(a){return ae(a,r=>this.extractArgs(r))}extractBattleText(a){return ee(a,r=>this.extractArgs(r))}extractCommonEventText(a){return Q(a,r=>this.extractArgs(r))}extractArgs(a){const r=ne(a,this._commandMap);return r.values.filter(Xe).map(s=>({code:n.PLUGIN_COMMAND_MZ,value:s.value,paramIndex:3,commandName:r.commandName,pluginName:r.pluginName}))}extractCommandTexts(a){return b(a,r=>this.extractArgs(r))}}const Xe=e=>typeof e.value=="string",k=(e,a,r)=>({folder:r,key:a,image:e[a],id:e.id}),l=(e,a)=>({note:ce(e),main:a.map(r=>({key:r,text:e[r],id:e.id}))}),ce=e=>n.readNoteEx(e.note,(a,r)=>({key:a,text:r,id:e.id}));exports.buildReferenceItemSources=(e,a,r,s,m,o)=>[...n.defineTraitItems(r,s),...n.defineGameDataSources(e,a),...n.defineSystemItems(m,o)],exports.compileItemEffectDisplayData=(e,a,r)=>{const s=n.resolveItemEffectLabels(a);return F.mergeItemsSource(r?[...s,...r]:s,e)},exports.compileTraitDisplayData=(e,a)=>F.mergeItemsSource(n.resolveTraitLabels(a),e),exports.createTextDataExtractorFromCommandItems=e=>{const a=new Map(e);return new j(a)},exports.createTextDataExtractorFromSchemas=e=>{const a=(r=s=>new pe.JSONPathJS(s),new Map(e.flatMap(s=>Je(s,r))));var r;return new j(a)},exports.extractBattleEventTexts=ee,exports.extractCommonEventTexts=Q,exports.extractImageFromActor=e=>[k(e,"faceName","faces"),k(e,"characterName","characters"),k(e,"battlerName","sv_actors")],exports.extractImageFromEnemy=e=>({key:"battlerName",image:e.battlerName,id:e.id}),exports.extractItemChangeData=V,exports.extractItemCommands=M,exports.extractItemFromMap=(e,a,r)=>Y(e.map,(s,m,o)=>({...ge(s),commands:M(s.list,a,r),eventName:o.name,pageIndex:m})),exports.extractItemFromTroop=(e,a,r)=>{return s=(m,o,c)=>({commands:M(m.list,a,r),eventName:c.name,troopId:c.id,pageIndex:o}),e.flatMap(m=>G(m,s));var s},exports.extractMapText=ae,exports.extractNoteText=ce,exports.extractPluginCommandMzArgs=ne,exports.extractTextData=l,exports.extractTextFromActor=e=>l(e,["name","nickname","profile"]),exports.extractTextFromArmor=e=>l(e,["name","description"]),exports.extractTextFromClass=e=>l(e,["name"]),exports.extractTextFromEnemy=e=>l(e,["name"]),exports.extractTextFromEventCommands=e=>Z(e,()=>[]),exports.extractTextFromEventCommandsEx=b,exports.extractTextFromItem=e=>l(e,["name","description"]),exports.extractTextFromSkill=e=>l(e,["name","description","message1","message2"]),exports.extractTextFromState=e=>l(e,["name","message1","message2","message3","message4"]),exports.extractTextFromSystem=e=>({gameTitle:e.gameTitle,currencyUnit:e.currencyUnit,equipTypes:[...e.equipTypes],armorTypes:[...e.armorTypes],weaponTypes:[...e.weaponTypes],terms:{basic:n.makeTermsBasicFromArray(e.terms.basic),commands:n.makeTermsCommandFromArray(e.terms.commands),messages:n.makeTermsMessages(e.terms.messages),params:n.makeParamNamesFromArray(e.terms.params)}}),exports.extractTextFromWeapon=e=>l(e,["name","description"]),exports.replaceActorText=(e,a)=>{const r=h(e,a),s=t(e.name,a),m=t(e.nickname,a),o=t(e.profile,a);return{...e,name:s,nickname:m,profile:o,note:r}},exports.replaceClassText=(e,a)=>{const r=h(e,a),s=t(e.name,a);return{...e,name:s,note:r}},exports.replaceCommonEventTexts=(e,a)=>({...e,list:_(e.list,a)}),exports.replaceEnemyText=(e,a)=>{const r=h(e,a),s=t(e.name,a);return{...e,name:s,note:r}},exports.replaceEventCommandTexts=_,exports.replaceItemText=(e,a)=>{const r=h(e,a),s=t(e.name,a),m=t(e.description,a);return{...e,name:s,description:m,note:r}},exports.replaceMapDataTexts=(e,a)=>{const r=t(e.displayName,a),s=h(e,a),m={displayName:r,events:n.repleaceMapEventCommands(e,o=>_(o,a)),note:s};return{...e,...m}},exports.replaceNoteTextByMap=h,exports.replaceSkillText=(e,a)=>{const r=h(e,a),s=t(e.name,a),m=t(e.description,a),o=t(e.message1,a),c=t(e.message2,a);return{...e,name:s,description:m,message1:o,message2:c,note:r}},exports.replaceStateText=(e,a)=>{const r=h(e,a),s=t(e.name,a),m=t(e.message1,a),o=t(e.message2,a),c=t(e.message3,a),i=t(e.message4,a);return{...e,name:s,message1:m,message2:o,message3:c,message4:i,note:r}},exports.replaceSystemTerms=L,exports.replaceSystemText=(e,a)=>({...e,gameTitle:t(e.gameTitle,a),currencyUnit:t(e.currencyUnit,a),elements:v(e.elements,a),skillTypes:v(e.skillTypes,a),weaponTypes:v(e.weaponTypes,a),armorTypes:v(e.armorTypes,a),equipTypes:v(e.equipTypes,a),terms:L(e.terms,a)}),exports.replaceTextByMap=t,exports.replaceTextForCommand=U,exports.replaceTextForCommandActor=J,exports.replaceTextForCommandShowChoices=X,exports.replaceTextForCommandShowMessage=q,exports.replaceTroopTexts=(e,a)=>{const r=e.pages.map(s=>({list:_(s.list,a),conditions:s.conditions,span:s.span}));return{...e,pages:r}};
