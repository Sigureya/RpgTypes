"use strict";var ce=Object.defineProperty;var ie=(e,a,r)=>a in e?ce(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var P=(e,a,r)=>ie(e,typeof a!="symbol"?a+"":a,r);const n=require("./make.cjs2.js"),de=require("jsonpath-js"),pe=require("@sigureya/rmmz-plugin-schema"),R=require("./mergeItemsSource.cjs.js"),D=(e,a,r)=>e.reduce((s,m)=>(m.code!==n.CHANGE_ARMORS&&m.code!==n.CHANGE_ITEMS&&m.code!==n.CHANGE_WEAPONS||s.push($(m,a,r)),s),[]),le={[n.CHANGE_WEAPONS]:"weapon",[n.CHANGE_ARMORS]:"armor",[n.CHANGE_ITEMS]:"item"},$=(e,a,r)=>{const s=e.parameters[3]===n.OPERAND_DIRECT?{direct:!0,value:e.parameters[2]}:{direct:!1,variableId:e.parameters[2]},m=e.parameters[0]===n.OPERATION_GAIN?a.gain:e.parameters[0]===n.OPERATION_LOSE?a.lose:a.unknown,c=typeof e.parameters[4]=="boolean"?{includesEquip:e.parameters[4]}:{};return{itemKind:le[e.code],dataId:e.parameters[1],code:e.code,commandNameMZ:r(e.code),operation:m,...c,...s}},ue=e=>!!e,W=(e,a)=>e.pages.map((r,s)=>a(r,s,e)),j=(e,a)=>e.events.filter(ue).flatMap(r=>W(r,a)),ye=e=>e.conditions.itemId>0&&e.conditions.itemValid?{pageCondition:{itemId:e.conditions.itemId}}:{},t=(e,a)=>{const r=e.trimEnd(),s=a.get(r);return s?s.trimEnd():r},C=(e,a,r=`
`)=>n.replaceNote(e.note,s=>t(s.value,a),r),M=(e,a)=>e.map(r=>{switch(r.code){case n.SHOW_MESSAGE:return Y(r,a);case n.SHOW_CHOICES:return q(r,a);case n.SHOW_MESSAGE_BODY:case n.COMMENT_HEAD:case n.COMMENT_BODY:case n.SHOW_SCROLLING_TEXT_BODY:return V(r,a);case n.CHANGE_NAME:case n.CHANGE_NICKNAME:case n.CHANGE_PROFILE:return U(r,a);default:return r}}),V=(e,a)=>{const r=t(e.parameters[0],a);return{code:e.code,indent:e.indent,parameters:[r]}},Y=(e,a)=>{const r=e.parameters[4]?t(e.parameters[4],a):"";return n.makeCommandShowMessage({facename:e.parameters[0],faceIndex:e.parameters[1],background:e.parameters[2],positionType:e.parameters[3],speakerName:r},e.indent)},U=(e,a)=>{const r=t(e.parameters[1],a);return{code:e.code,indent:e.indent,parameters:[e.parameters[0],r]}},q=(e,a)=>{const r=e.parameters[0].map(s=>t(s,a));return{code:n.SHOW_CHOICES,indent:e.indent,parameters:[r,e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}},F=(e,a)=>({params:Te(e.params,a),messages:xe(e.messages,a),commands:he(e.commands,a),basic:ge(e.basic,a)}),ge=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a)],he=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a),t(e[10],a),t(e[11],a),t(e[12],a),t(e[13],a),t(e[14],a),t(e[15],a),t(e[16],a),t(e[17],a),t(e[18],a),t(e[19],a),"",t(e[21],a),t(e[22],a),"",t(e[24],a),t(e[25],a)],Te=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a)],xe=(e,a)=>({actionFailure:t(e.actionFailure,a),actorDamage:t(e.actorDamage,a),actorDrain:t(e.actorDrain,a),actorGain:t(e.actorGain,a),actorLoss:t(e.actorLoss,a),actorNoDamage:t(e.actorNoDamage,a),actorNoHit:t(e.actorNoHit,a),actorRecovery:t(e.actorRecovery,a),alwaysDash:t(e.alwaysDash,a),autosave:t(e.autosave,a),bgmVolume:t(e.bgmVolume,a),bgsVolume:t(e.bgsVolume,a),buffAdd:t(e.buffAdd,a),buffRemove:t(e.buffRemove,a),commandRemember:t(e.commandRemember,a),counterAttack:t(e.counterAttack,a),criticalToActor:t(e.criticalToActor,a),criticalToEnemy:t(e.criticalToEnemy,a),defeat:t(e.defeat,a),debuffAdd:t(e.debuffAdd,a),emerge:t(e.emerge,a),enemyDamage:t(e.enemyDamage,a),enemyDrain:t(e.enemyDrain,a),enemyGain:t(e.enemyGain,a),enemyLoss:t(e.enemyLoss,a),enemyNoDamage:t(e.enemyNoDamage,a),enemyNoHit:t(e.enemyNoHit,a),enemyRecovery:t(e.enemyRecovery,a),escapeFailure:t(e.escapeFailure,a),escapeStart:t(e.escapeStart,a),evasion:t(e.evasion,a),expNext:t(e.expNext,a),expTotal:t(e.expTotal,a),file:t(e.file,a),loadMessage:t(e.loadMessage,a),levelUp:t(e.levelUp,a),magicEvasion:t(e.magicEvasion,a),magicReflection:t(e.magicReflection,a),meVolume:t(e.meVolume,a),obtainExp:t(e.obtainExp,a),obtainGold:t(e.obtainGold,a),obtainItem:t(e.obtainItem,a),obtainSkill:t(e.obtainSkill,a),partyName:t(e.partyName,a),possession:t(e.possession,a),preemptive:t(e.preemptive,a),saveMessage:t(e.saveMessage,a),seVolume:t(e.seVolume,a),substitute:t(e.substitute,a),surprise:t(e.surprise,a),touchUI:t(e.touchUI,a),useItem:t(e.useItem,a),victory:t(e.victory,a)}),I=(e,a)=>e.map(r=>t(r,a)),J=e=>e.map(a=>a.parameters[0].trimEnd()).join(`
`).trimEnd();class X{constructor(a,r){this.header=a,this.bodies=r}getBodyText(){return J(this.joinCommandBodies())}mergedBody(){return{code:this.header.code,indent:this.header.indent,parameters:[this.getBodyText()]}}joinCommandBodies(){return[this.header,...this.bodies]}normalizedCommands(){return[this.mergedBody()]}}class B{constructor(a,r,s){this.bodyCode=a,this.header=r,this.bodies=s}normalizedCommands(){const a={...this.header,code:this.header.code,indent:this.header.indent,parameters:[...this.header.parameters]};return this.bodies.length===0?[a]:[a,this.mergedBody()]}getBodyText(){return J(this.bodies)}joinCommandBodies(){return this.bodies}mergedBody(){return{code:this.bodyCode,indent:this.header.indent,parameters:[this.getBodyText()]}}}const O=(e,a,r,s)=>{const m=e[a];if(!r(m))throw new Error(`Invalid head at index ${a}: ${JSON.stringify(m)}`);const c=[];for(let o=a+1;o<e.length;o++){const i=e[o];if(!s(i))break;c.push(i)}return{header:m,bodies:c}},Ne=(e,a)=>{const{bodies:r,header:s}=((m,c)=>O(m,c,o=>o.code===n.COMMENT_HEAD,o=>o.code===n.COMMENT_BODY))(e,a);return fe(s)?new B(n.COMMENT_BODY,s,r):new X(s,r)},fe=e=>e.parameters[0]==="選択肢ヘルプ",Ee=(e,a)=>{const{bodies:r,header:s}=((m,c)=>O(m,c,o=>o.code===n.SHOW_MESSAGE,o=>o.code===n.SHOW_MESSAGE_BODY))(e,a);return new B(n.SHOW_MESSAGE_BODY,s,r)},Se=(e,a)=>{const{bodies:r,header:s}=((m,c)=>O(m,c,o=>o.code===n.SCRIPT_EVAL,o=>o.code===n.SCRIPT_EVAL_BODY))(e,a);return new X(s,r)},Ae=(e,a)=>{const{bodies:r,header:s}=((m,c)=>O(m,c,o=>o.code===n.SHOW_SCROLLING_TEXT,o=>o.code===n.SHOW_SCROLLING_TEXT_BODY))(e,a);return new B(n.SHOW_SCROLLING_TEXT_BODY,s,r)},be={[n.SHOW_MESSAGE]:(e,a,r)=>r.showMessage(Ee(e,a),a,e),[n.SCRIPT_EVAL]:(e,a,r)=>r.script(Se(e,a),a,e),[n.COMMENT_HEAD]:(e,a,r)=>r.comment(Ne(e,a),a,e),[n.SHOW_SCROLLING_TEXT]:(e,a,r)=>r.showScrollingText(Ae(e,a),a,e)},Ce=e=>((a,r)=>({code:a.code,paramIndex:r,value:a.parameters[r]}))(e,1),_=(e,a)=>z(e,a),z=(e,a)=>e.flatMap((r,s)=>ve(r,s,e,a)).filter(r=>r!==null),ve=(e,a,r,s)=>{if(e.code===n.SHOW_CHOICES)return(o=>o.parameters[0].map((i,d)=>({code:102,paramIndex:d,value:i})))(e);const m=(c=e.code,be[c]);var c;if(m){const o=m(r,a,Ie);if(o!==void 0)return[o]}return e.code===n.CHANGE_NICKNAME||e.code===n.CHANGE_NAME||e.code===n.CHANGE_PROFILE?Ce(e):e.code===n.PLUGIN_COMMAND_MZ?s(e):null},Ie={comment:e=>{return a=e,{code:n.COMMENT_HEAD,paramIndex:0,value:a.getBodyText()};var a},showMessage:e=>{return a=e,{code:n.SHOW_MESSAGE_BODY,paramIndex:0,value:a.getBodyText(),speaker:(r=a.header,r.parameters[4]?r.parameters[4].trimEnd():"")};var a,r},script:e=>(a=>({code:n.SCRIPT_EVAL,paramIndex:0,value:a.getBodyText()}))(e),showScrollingText:e=>(a=>({code:n.SHOW_SCROLLING_TEXT_BODY,paramIndex:0,value:a.getBodyText()}))(e)},K=(e,a=()=>[])=>({eventId:e.id,commands:_(e.list,a)}),Z=(e,a=()=>[])=>e.pages.map((r,s)=>({eventId:e.id,pageIndex:s,commands:_(r.list,a)})),Q=(e,a=()=>[])=>({note:e.note,noteItems:n.readNote(e.note),displayedName:e.displayName,events:_e(e,a)}),_e=(e,a)=>j(e,(r,s,m)=>({eventId:m.id,pageIndex:s,commands:_(r.list,a),note:m.note,noteItems:n.readNote(m.note),name:m.name})),ee=e=>(a=>a.kind.endsWith("[]"))(e.attr),ae=e=>e.kind==="struct",re=e=>e.attr.kind==="struct[]",Me=e=>te[e.kind.replace("[]","")].type==="number",Oe=e=>te[e.kind.replace("[]","")].type==="string",v={type:"string",hasText:!0},T={type:"number",hasText:!1},h={type:"number",hasText:!1},te={string:v,number:{type:"number",hasText:!1},boolean:{type:"boolean"},armor:T,actor:T,class:T,enemy:T,skill:T,state:T,item:T,weapon:T,common_event:T,switch:T,variable:T,troop:T,multiline_string:v,file:{type:"string",hasText:!1},"file[]":{type:"string",hasText:!1},"multiline_string[]":v,"string[]":v,combo:v,select:v,any:v,struct:{type:"struct"},"actor[]":h,"enemy[]":h,"class[]":h,"skill[]":h,"state[]":h,"item[]":h,"weapon[]":h,"common_event[]":h,"troop[]":h,"armor[]":h,"switch[]":h,"variable[]":h,"number[]":h};function De(e){return He(e,a=>!0,a=>!0)}const He=(e,a,r)=>{const s=[],m=[],c=[],o=[];return e.forEach(i=>{if(ae(i.attr))s.push({name:i.name,attr:i.attr});else if(re(i))m.push(i);else if(ee(i)){if(r(i))return void o.push(i)}else a(i)&&c.push(i)}),{structs:s,structArrays:m,scalars:c,scalarArrays:o}};function ke(e){const a=e.map(r=>[r.name,r.attr]);return Object.fromEntries(a)}const we=(e,a)=>{if(e.length!==0)return`${a}[${e.map(r=>`"${r.name}"`).join(",")}]`},Ge=(e,a)=>e.map(r=>({path:`${a}.${r.name}[*]`,param:r})),se={undefinedStruct:"undefined_struct",cyclicStruct:"cyclic_struct"};function me(e,a,r,s){const m={items:[],errs:[],frames:[{schemaName:e,basePath:a,ancestry:[]}]},c=Math.max(1,3*r.size+5),o=Array.from({length:c}).reduce(i=>i.frames.length===0?i:function(d,N,f){if(d.frames.length===0)return d;const p=d.frames[d.frames.length-1],x=d.frames.slice(0,-1);if(p.ancestry.includes(p.schemaName))return{frames:x,items:d.items,errs:[...d.errs,{code:f.cyclicStruct,path:p.basePath}]};const u=N.get(p.schemaName);if(!u)return{frames:x,items:d.items,errs:[...d.errs,{code:f.undefinedStruct,path:p.basePath}]};const S=function(g,y){const l=g.ancestry.concat(g.schemaName),A=g.basePath;return[...y.structs.map(b=>({schemaName:b.attr.struct,basePath:`${A}.${b.name}`,ancestry:l})),...y.structArrays.map(b=>({schemaName:b.attr.struct,basePath:`${A}.${b.name}[*]`,ancestry:l}))].reverse()}(p,u);if(u.scalars.length>0||u.scalarArrays.length>0){const g=function(y,{path:l,structName:A}){return{category:"struct",objectSchema:ke(y.scalars),name:A,scalarArrays:Ge(y.scalarArrays,l),scalarsPath:y.scalars.length>0?we(y.scalars,l):void 0}}(u,{path:p.basePath,structName:p.schemaName});return x.push(...S),{frames:x,items:[...d.items,g],errs:d.errs}}return x.push(...S),{frames:x,items:d.items,errs:d.errs}}(i,r,s),m);return{items:o.items,errors:o.errs}}const Be=(e,a,r,s=se)=>me(e.attr.struct,`${a}.${e.name}`,r,s),Pe=(e,a,r,s=se)=>me(e.attr.struct,`${a}.${e.name}[*]`,r,s),Re=(e,a,r,s)=>(m=>ae(m.attr))(r)?$e(e,r,s):re(r)?We(e,r,s):ee(r)?Fe(e,a,r):Le(e,a,r),Fe=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{name:"",objectSchema:{},scalarsPath:void 0,scalarArrays:[{path:`$.${r.name}[*]`,param:r}]},structs:{items:[],errors:[]},structArrays:{items:[],errors:[]}}),Le=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{name:r.attr.kind,objectSchema:{[r.name]:r.attr},scalarsPath:`$.${r.name}`,scalarArrays:[]},structArrays:{items:[],errors:[]},structs:{items:[],errors:[]}}),$e=(e,a,r)=>({rootName:a.name,rootCategory:e,scalars:void 0,structArrays:{items:[],errors:[]},structs:Be(a,"$",r)}),We=(e,a,r)=>({structArrays:Pe(a,"$",r),rootName:a.name,rootCategory:e,scalars:void 0,structs:{items:[],errors:[]}}),je=(e,a)=>a.map(r=>Ve(e,r)).flat(3),Ve=(e,a)=>[a.top?H(a,e,a.top,""):[],a.structs.map(r=>H(a,e,r)),a.structArrays.map(r=>H(a,e,r))],H=(e,a,r,s=r.bundleName)=>{const m=r.scalar?((o,i,d,N,f)=>N.pathSegments(d).map(({value:p,segments:x})=>((u,S,g,y,l)=>{if(typeof g=="object"||g===null)return null;const A=y[y.length-1];if(typeof A=="number")return null;const b=l[A];return b?{rootName:u.rootName,rootType:u.rootCategory,structName:S,value:g,param:{name:A,attr:b}}:null})(o,i,p,x,f)).filter(p=>p!==null))(e,s,a,r.scalar.jsonPathJS,r.scalar.record):[],c=r.arrays.map(o=>((i,d,N,f)=>{const p=f.jsonPathJS.find(N);if(!Array.isArray(p))return[];const x=f.schema.attr;return Oe(x)?((u,S,g,y)=>S.filter(l=>typeof l=="string").map(l=>({rootName:u.rootName,rootType:u.rootCategory,value:l,structName:g,param:y})))(i,p,d,f.schema):Me(x)?((u,S,g,y)=>S.filter(l=>typeof l=="number").map(l=>({rootName:u.rootName,rootType:u.rootCategory,value:l,structName:g,param:y})))(i,p,d,f.schema):[]})(e,s,a,o));return[m,c].flat(2)},k=(e,a)=>e.scalarsPath?{bundleName:e.name,arrays:L(e.scalarArrays,e.name,a),scalar:Ye(e.scalarsPath,e.objectSchema,a)}:{bundleName:e.name,arrays:L(e.scalarArrays,e.name,a)},L=(e,a,r)=>e.map(s=>({jsonPathJS:r(s.path),schema:s.param,parentType:a})),Ye=(e,a,r)=>({jsonPathJS:r(e),record:a}),Ue=(e,a,r,s)=>({pluginName:e,commandName:a.command,desc:a.desc??"",text:a.text??"",extractors:qe(a,r,s)}),qe=(e,a,r)=>e.args.map(s=>((m,c)=>{const o=m.scalars?k(m.scalars,c):void 0,i=m.structs.items.map(N=>k(N,c)),d=m.structArrays.items.map(N=>k(N,c));return{rootCategory:m.rootCategory,rootName:m.rootName,top:o,structs:i,structArrays:d}})(Re("args",e.command,s,a),r)),Je=(e,a)=>{const r=(s=>new Map(s.map(m=>[m.struct,De(m.params)])))(e.schema.structs);return Xe(e.pluginName,e.schema.commands,r,a)},Xe=(e,a,r,s)=>a.map(m=>[`${e}:${m.command}`,Ue(e,m,r,s)]),ne=(e,a)=>{const[r,s]=e.parameters,m=`${r}:${s}`,c=a.get(m);if(!c)return{pluginName:r,commandName:s,args:[]};return i=pe.parseDeepRecord(e.parameters[3]),{pluginName:(d=c).pluginName,commandName:d.commandName,args:je(i,d.extractors)};var i,d};class w{constructor(a){P(this,"_commandMap");this._commandMap=a}keys(){return Array.from(this._commandMap.keys())}extractMapTexts(a){return Q(a,r=>this.extractArgs(r))}extractBattleText(a){return Z(a,r=>this.extractArgs(r))}extractCommonEventText(a){return K(a,r=>this.extractArgs(r))}extractArgs(a){const r=ne(a,this._commandMap);return r.args.filter(ze).map(s=>({code:n.PLUGIN_COMMAND_MZ,value:s.value,paramIndex:3,argName:s.param.name,argTitle:s.param.attr.text??s.param.name,commandName:r.commandName,pluginName:r.pluginName}))}extractCommandTexts(a){return _(a,r=>this.extractArgs(r))}}const ze=e=>typeof e.value=="string",G=(e,a,r)=>({folder:r,key:a,image:e[a],id:e.id}),E=(e,a)=>({note:oe(e),main:a.map(r=>({key:r,text:e[r],id:e.id}))}),oe=e=>n.readNoteEx(e.note,(a,r)=>({key:a,text:r,id:e.id}));exports.buildReferenceItemSources=(e,a,r,s,m,c)=>[...n.defineTraitItems(r,s),...n.defineGameDataSources(e,a),...n.defineSystemItems(m,c)],exports.compileItemEffectDisplayData=(e,a,r)=>{const s=n.resolveItemEffectLabels(a);return R.mergeItemsSource(r?[...s,...r]:s,e)},exports.compileTraitDisplayData=(e,a)=>R.mergeItemsSource(n.resolveTraitLabels(a),e),exports.createTextDataExtractor=()=>new w(new Map),exports.createTextDataExtractorFromCommandItems=e=>{const a=new Map(e);return new w(a)},exports.createTextDataExtractorFromSchemas=e=>{const a=e.flatMap(r=>Je(r,s=>new de.JSONPathJS(s)));return new w(new Map(a))},exports.extractBattleEventTexts=Z,exports.extractCommonEventTexts=K,exports.extractImageFromActor=e=>[G(e,"faceName","faces"),G(e,"characterName","characters"),G(e,"battlerName","sv_actors")],exports.extractImageFromEnemy=e=>({key:"battlerName",image:e.battlerName,id:e.id}),exports.extractItemChangeData=$,exports.extractItemCommands=D,exports.extractItemFromMap=(e,a,r)=>j(e.map,(s,m,c)=>({...ye(s),commands:D(s.list,a,r),eventName:c.name,pageIndex:m})),exports.extractItemFromTroop=(e,a,r)=>{return s=(m,c,o)=>({commands:D(m.list,a,r),eventName:o.name,troopId:o.id,pageIndex:c}),e.flatMap(m=>W(m,s));var s},exports.extractMapText=Q,exports.extractNoteText=oe,exports.extractPluginCommandMzArgs=ne,exports.extractTextData=E,exports.extractTextFromActor=e=>E(e,["name","nickname","profile"]),exports.extractTextFromArmor=e=>E(e,["name","description"]),exports.extractTextFromClass=e=>E(e,["name"]),exports.extractTextFromEnemy=e=>E(e,["name"]),exports.extractTextFromEventCommands=e=>z(e,()=>[]),exports.extractTextFromEventCommandsEx=_,exports.extractTextFromItem=e=>E(e,["name","description"]),exports.extractTextFromSkill=e=>E(e,["name","description","message1","message2"]),exports.extractTextFromState=e=>E(e,["name","message1","message2","message3","message4"]),exports.extractTextFromSystem=e=>({gameTitle:e.gameTitle,currencyUnit:e.currencyUnit,equipTypes:[...e.equipTypes],armorTypes:[...e.armorTypes],weaponTypes:[...e.weaponTypes],terms:{basic:n.makeTermsBasicFromArray(e.terms.basic),commands:n.makeTermsCommandFromArray(e.terms.commands),messages:n.makeTermsMessages(e.terms.messages),params:n.makeParamNamesFromArray(e.terms.params)}}),exports.extractTextFromWeapon=e=>E(e,["name","description"]),exports.replaceActorText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.nickname,a),c=t(e.profile,a);return{...e,name:s,nickname:m,profile:c,note:r}},exports.replaceClassText=(e,a)=>{const r=C(e,a),s=t(e.name,a);return{...e,name:s,note:r}},exports.replaceCommonEventTexts=(e,a)=>({...e,list:M(e.list,a)}),exports.replaceEnemyText=(e,a)=>{const r=C(e,a),s=t(e.name,a);return{...e,name:s,note:r}},exports.replaceEventCommandTexts=M,exports.replaceItemText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.description,a);return{...e,name:s,description:m,note:r}},exports.replaceMapDataTexts=(e,a)=>{const r=t(e.displayName,a),s=C(e,a),m={displayName:r,events:n.repleaceMapEventCommands(e,c=>M(c,a)),note:s};return{...e,...m}},exports.replaceNoteTextByMap=C,exports.replaceSkillText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.description,a),c=t(e.message1,a),o=t(e.message2,a);return{...e,name:s,description:m,message1:c,message2:o,note:r}},exports.replaceStateText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.message1,a),c=t(e.message2,a),o=t(e.message3,a),i=t(e.message4,a);return{...e,name:s,message1:m,message2:c,message3:o,message4:i,note:r}},exports.replaceSystemTerms=F,exports.replaceSystemText=(e,a)=>({...e,gameTitle:t(e.gameTitle,a),currencyUnit:t(e.currencyUnit,a),elements:I(e.elements,a),skillTypes:I(e.skillTypes,a),weaponTypes:I(e.weaponTypes,a),armorTypes:I(e.armorTypes,a),equipTypes:I(e.equipTypes,a),terms:F(e.terms,a)}),exports.replaceTextByMap=t,exports.replaceTextForCommand=V,exports.replaceTextForCommandActor=U,exports.replaceTextForCommandShowChoices=q,exports.replaceTextForCommandShowMessage=Y,exports.replaceTroopTexts=(e,a)=>{const r=e.pages.map(s=>({list:M(s.list,a),conditions:s.conditions,span:s.span}));return{...e,pages:r}};
