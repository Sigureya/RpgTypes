"use strict";var ie=Object.defineProperty;var de=(e,a,r)=>a in e?ie(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var P=(e,a,r)=>de(e,typeof a!="symbol"?a+"":a,r);const n=require("./make.cjs2.js"),pe=require("jsonpath-js"),le=require("@sigureya/rmmz-plugin-schema"),R=require("./mergeItemsSource.cjs.js"),D=(e,a,r)=>e.reduce((s,m)=>(m.code!==n.CHANGE_ARMORS&&m.code!==n.CHANGE_ITEMS&&m.code!==n.CHANGE_WEAPONS||s.push(W(m,a,r)),s),[]),ue={[n.CHANGE_WEAPONS]:"weapon",[n.CHANGE_ARMORS]:"armor",[n.CHANGE_ITEMS]:"item"},W=(e,a,r)=>{const s=e.parameters[3]===n.OPERAND_DIRECT?{direct:!0,value:e.parameters[2]}:{direct:!1,variableId:e.parameters[2]},m=e.parameters[0]===n.OPERATION_GAIN?a.gain:e.parameters[0]===n.OPERATION_LOSE?a.lose:a.unknown,o=typeof e.parameters[4]=="boolean"?{includesEquip:e.parameters[4]}:{};return{itemKind:ue[e.code],dataId:e.parameters[1],code:e.code,commandNameMZ:r(e.code),operation:m,...o,...s}},ye=e=>!!e,j=(e,a)=>e.pages.map((r,s)=>a(r,s,e)),V=(e,a)=>e.events.filter(ye).flatMap(r=>j(r,a)),ge=e=>e.conditions.itemId>0&&e.conditions.itemValid?{pageCondition:{itemId:e.conditions.itemId}}:{},t=(e,a)=>{const r=e.trimEnd(),s=a.get(r);return s?s.trimEnd():r},C=(e,a,r=`
`)=>n.replaceNote(e.note,s=>t(s.value,a),r),M=(e,a)=>e.map(r=>{switch(r.code){case n.SHOW_MESSAGE:return U(r,a);case n.SHOW_CHOICES:return J(r,a);case n.SHOW_MESSAGE_BODY:case n.COMMENT_HEAD:case n.COMMENT_BODY:case n.SHOW_SCROLLING_TEXT_BODY:return Y(r,a);case n.CHANGE_NAME:case n.CHANGE_NICKNAME:case n.CHANGE_PROFILE:return q(r,a);default:return r}}),Y=(e,a)=>{const r=t(e.parameters[0],a);return{code:e.code,indent:e.indent,parameters:[r]}},U=(e,a)=>{const r=e.parameters[4]?t(e.parameters[4],a):"";return n.makeCommandShowMessage({facename:e.parameters[0],faceIndex:e.parameters[1],background:e.parameters[2],positionType:e.parameters[3],speakerName:r},e.indent)},q=(e,a)=>{const r=t(e.parameters[1],a);return{code:e.code,indent:e.indent,parameters:[e.parameters[0],r]}},J=(e,a)=>{const r=e.parameters[0].map(s=>t(s,a));return{code:n.SHOW_CHOICES,indent:e.indent,parameters:[r,e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}},F=(e,a)=>({params:xe(e.params,a),messages:Ne(e.messages,a),commands:Te(e.commands,a),basic:he(e.basic,a)}),he=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a)],Te=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a),t(e[10],a),t(e[11],a),t(e[12],a),t(e[13],a),t(e[14],a),t(e[15],a),t(e[16],a),t(e[17],a),t(e[18],a),t(e[19],a),"",t(e[21],a),t(e[22],a),"",t(e[24],a),t(e[25],a)],xe=(e,a)=>[t(e[0],a),t(e[1],a),t(e[2],a),t(e[3],a),t(e[4],a),t(e[5],a),t(e[6],a),t(e[7],a),t(e[8],a),t(e[9],a)],Ne=(e,a)=>({actionFailure:t(e.actionFailure,a),actorDamage:t(e.actorDamage,a),actorDrain:t(e.actorDrain,a),actorGain:t(e.actorGain,a),actorLoss:t(e.actorLoss,a),actorNoDamage:t(e.actorNoDamage,a),actorNoHit:t(e.actorNoHit,a),actorRecovery:t(e.actorRecovery,a),alwaysDash:t(e.alwaysDash,a),autosave:t(e.autosave,a),bgmVolume:t(e.bgmVolume,a),bgsVolume:t(e.bgsVolume,a),buffAdd:t(e.buffAdd,a),buffRemove:t(e.buffRemove,a),commandRemember:t(e.commandRemember,a),counterAttack:t(e.counterAttack,a),criticalToActor:t(e.criticalToActor,a),criticalToEnemy:t(e.criticalToEnemy,a),defeat:t(e.defeat,a),debuffAdd:t(e.debuffAdd,a),emerge:t(e.emerge,a),enemyDamage:t(e.enemyDamage,a),enemyDrain:t(e.enemyDrain,a),enemyGain:t(e.enemyGain,a),enemyLoss:t(e.enemyLoss,a),enemyNoDamage:t(e.enemyNoDamage,a),enemyNoHit:t(e.enemyNoHit,a),enemyRecovery:t(e.enemyRecovery,a),escapeFailure:t(e.escapeFailure,a),escapeStart:t(e.escapeStart,a),evasion:t(e.evasion,a),expNext:t(e.expNext,a),expTotal:t(e.expTotal,a),file:t(e.file,a),loadMessage:t(e.loadMessage,a),levelUp:t(e.levelUp,a),magicEvasion:t(e.magicEvasion,a),magicReflection:t(e.magicReflection,a),meVolume:t(e.meVolume,a),obtainExp:t(e.obtainExp,a),obtainGold:t(e.obtainGold,a),obtainItem:t(e.obtainItem,a),obtainSkill:t(e.obtainSkill,a),partyName:t(e.partyName,a),possession:t(e.possession,a),preemptive:t(e.preemptive,a),saveMessage:t(e.saveMessage,a),seVolume:t(e.seVolume,a),substitute:t(e.substitute,a),surprise:t(e.surprise,a),touchUI:t(e.touchUI,a),useItem:t(e.useItem,a),victory:t(e.victory,a)}),_=(e,a)=>e.map(r=>t(r,a)),X=e=>e.map(a=>a.parameters[0].trimEnd()).join(`
`).trimEnd();class z{constructor(a,r){this.header=a,this.bodies=r}getBodyText(){return X(this.joinCommandBodies())}mergedBody(){return{code:this.header.code,indent:this.header.indent,parameters:[this.getBodyText()]}}joinCommandBodies(){return[this.header,...this.bodies]}normalizedCommands(){return[this.mergedBody()]}}class B{constructor(a,r,s){this.bodyCode=a,this.header=r,this.bodies=s}normalizedCommands(){const a={...this.header,code:this.header.code,indent:this.header.indent,parameters:[...this.header.parameters]};return this.bodies.length===0?[a]:[a,this.mergedBody()]}getBodyText(){return X(this.bodies)}joinCommandBodies(){return this.bodies}mergedBody(){return{code:this.bodyCode,indent:this.header.indent,parameters:[this.getBodyText()]}}}const O=(e,a,r,s)=>{const m=e[a];if(!r(m))throw new Error(`Invalid head at index ${a}: ${JSON.stringify(m)}`);const o=[];for(let c=a+1;c<e.length;c++){const i=e[c];if(!s(i))break;o.push(i)}return{header:m,bodies:o}},fe=(e,a)=>{const{bodies:r,header:s}=((m,o)=>O(m,o,c=>c.code===n.COMMENT_HEAD,c=>c.code===n.COMMENT_BODY))(e,a);return Ee(s)?new B(n.COMMENT_BODY,s,r):new z(s,r)},Ee=e=>e.parameters[0]==="選択肢ヘルプ",Se=(e,a)=>{const{bodies:r,header:s}=((m,o)=>O(m,o,c=>c.code===n.SHOW_MESSAGE,c=>c.code===n.SHOW_MESSAGE_BODY))(e,a);return new B(n.SHOW_MESSAGE_BODY,s,r)},Ae=(e,a)=>{const{bodies:r,header:s}=((m,o)=>O(m,o,c=>c.code===n.SCRIPT_EVAL,c=>c.code===n.SCRIPT_EVAL_BODY))(e,a);return new z(s,r)},be=(e,a)=>{const{bodies:r,header:s}=((m,o)=>O(m,o,c=>c.code===n.SHOW_SCROLLING_TEXT,c=>c.code===n.SHOW_SCROLLING_TEXT_BODY))(e,a);return new B(n.SHOW_SCROLLING_TEXT_BODY,s,r)},Ce={[n.SHOW_MESSAGE]:(e,a,r)=>r.showMessage(Se(e,a),a,e),[n.SCRIPT_EVAL]:(e,a,r)=>r.script(Ae(e,a),a,e),[n.COMMENT_HEAD]:(e,a,r)=>r.comment(fe(e,a),a,e),[n.SHOW_SCROLLING_TEXT]:(e,a,r)=>r.showScrollingText(be(e,a),a,e)},H=e=>((a,r)=>({code:a.code,paramIndex:r,value:a.parameters[r]}))(e,1),ve=e=>e.parameters[0].map((a,r)=>({code:102,paramIndex:r,value:a})),I=(e,a)=>K(e,a),K=(e,a)=>e.reduce((r,s,m)=>{if(s.code===n.SHOW_CHOICES)return[...r,...ve(s)];const o=(c=s.code,Ce[c]);var c;if(o){const i=o(e,m,_e);if(i!==void 0)return[...r,i]}if(s.code===n.CHANGE_NICKNAME)return[...r,H(s)];if(s.code===n.CHANGE_NAME)return[...r,H(s)];if(s.code===n.CHANGE_PROFILE)return[...r,H(s)];if(s.code===n.PLUGIN_COMMAND_MZ){const i=a(s);return i.length===0?r:[...r,...i]}return r},[]),_e={comment:e=>{return a=e,{code:n.COMMENT_HEAD,paramIndex:0,value:a.getBodyText()};var a},showMessage:e=>{return a=e,{code:n.SHOW_MESSAGE_BODY,paramIndex:0,value:a.getBodyText(),speaker:(r=a.header,r.parameters[4]?r.parameters[4].trimEnd():"")};var a,r},script:e=>(a=>({code:n.SCRIPT_EVAL,paramIndex:0,value:a.getBodyText()}))(e),showScrollingText:e=>(a=>({code:n.SHOW_SCROLLING_TEXT_BODY,paramIndex:0,value:a.getBodyText()}))(e)},Z=(e,a=()=>[])=>({eventId:e.id,commands:I(e.list,a)}),Q=(e,a=()=>[])=>e.pages.map((r,s)=>({eventId:e.id,pageIndex:s,commands:I(r.list,a)})),ee=(e,a=()=>[])=>({note:e.note,noteItems:n.readNote(e.note),displayedName:e.displayName,events:Ie(e,a)}),Ie=(e,a)=>V(e,(r,s,m)=>({eventId:m.id,pageIndex:s,commands:I(r.list,a),note:m.note,noteItems:n.readNote(m.note),name:m.name})),ae=e=>(a=>a.kind.endsWith("[]"))(e.attr),re=e=>e.kind==="struct",te=e=>e.attr.kind==="struct[]",Me=e=>se[e.kind.replace("[]","")].type==="number",Oe=e=>se[e.kind.replace("[]","")].type==="string",v={type:"string",hasText:!0},T={type:"number",hasText:!1},h={type:"number",hasText:!1},se={string:v,number:{type:"number",hasText:!1},boolean:{type:"boolean"},armor:T,actor:T,class:T,enemy:T,skill:T,state:T,item:T,weapon:T,common_event:T,switch:T,variable:T,troop:T,multiline_string:v,file:{type:"string",hasText:!1},"file[]":{type:"string",hasText:!1},"multiline_string[]":v,"string[]":v,combo:v,select:v,any:v,struct:{type:"struct"},"actor[]":h,"enemy[]":h,"class[]":h,"skill[]":h,"state[]":h,"item[]":h,"weapon[]":h,"common_event[]":h,"troop[]":h,"armor[]":h,"switch[]":h,"variable[]":h,"number[]":h};function De(e){return He(e,a=>!0,a=>!0)}const He=(e,a,r)=>{const s=[],m=[],o=[],c=[];return e.forEach(i=>{if(re(i.attr))s.push({name:i.name,attr:i.attr});else if(te(i))m.push(i);else if(ae(i)){if(r(i))return void c.push(i)}else a(i)&&o.push(i)}),{structs:s,structArrays:m,scalars:o,scalarArrays:c}};function ke(e){const a=e.map(r=>[r.name,r.attr]);return Object.fromEntries(a)}const Ge=(e,a)=>{if(e.length!==0)return`${a}[${e.map(r=>`"${r.name}"`).join(",")}]`},we=(e,a)=>e.map(r=>({path:`${a}.${r.name}[*]`,param:r})),me={undefinedStruct:"undefined_struct",cyclicStruct:"cyclic_struct"};function ne(e,a,r,s){const m={items:[],errs:[],frames:[{schemaName:e,basePath:a,ancestry:[]}]},o=Math.max(1,3*r.size+5),c=Array.from({length:o}).reduce(i=>i.frames.length===0?i:function(d,N,f){if(d.frames.length===0)return d;const p=d.frames[d.frames.length-1],x=d.frames.slice(0,-1);if(p.ancestry.includes(p.schemaName))return{frames:x,items:d.items,errs:[...d.errs,{code:f.cyclicStruct,path:p.basePath}]};const u=N.get(p.schemaName);if(!u)return{frames:x,items:d.items,errs:[...d.errs,{code:f.undefinedStruct,path:p.basePath}]};const S=function(g,y){const l=g.ancestry.concat(g.schemaName),A=g.basePath;return[...y.structs.map(b=>({schemaName:b.attr.struct,basePath:`${A}.${b.name}`,ancestry:l})),...y.structArrays.map(b=>({schemaName:b.attr.struct,basePath:`${A}.${b.name}[*]`,ancestry:l}))].reverse()}(p,u);if(u.scalars.length>0||u.scalarArrays.length>0){const g=function(y,{path:l,structName:A}){return{category:"struct",objectSchema:ke(y.scalars),name:A,scalarArrays:we(y.scalarArrays,l),scalarsPath:y.scalars.length>0?Ge(y.scalars,l):void 0}}(u,{path:p.basePath,structName:p.schemaName});return x.push(...S),{frames:x,items:[...d.items,g],errs:d.errs}}return x.push(...S),{frames:x,items:d.items,errs:d.errs}}(i,r,s),m);return{items:c.items,errors:c.errs}}const Be=(e,a,r,s=me)=>ne(e.attr.struct,`${a}.${e.name}`,r,s),Pe=(e,a,r,s=me)=>ne(e.attr.struct,`${a}.${e.name}[*]`,r,s),Re=(e,a,r,s)=>(m=>re(m.attr))(r)?$e(e,r,s):te(r)?We(e,r,s):ae(r)?Fe(e,a,r):Le(e,a,r),Fe=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{name:"",objectSchema:{},scalarsPath:void 0,scalarArrays:[{path:`$.${r.name}[*]`,param:r}]},structs:{items:[],errors:[]},structArrays:{items:[],errors:[]}}),Le=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{name:r.attr.kind,objectSchema:{[r.name]:r.attr},scalarsPath:`$.${r.name}`,scalarArrays:[]},structArrays:{items:[],errors:[]},structs:{items:[],errors:[]}}),$e=(e,a,r)=>({rootName:a.name,rootCategory:e,scalars:void 0,structArrays:{items:[],errors:[]},structs:Be(a,"$",r)}),We=(e,a,r)=>({structArrays:Pe(a,"$",r),rootName:a.name,rootCategory:e,scalars:void 0,structs:{items:[],errors:[]}}),je=(e,a)=>a.map(r=>Ve(e,r)).flat(3),Ve=(e,a)=>[a.top?k(a,e,a.top,""):[],a.structs.map(r=>k(a,e,r)),a.structArrays.map(r=>k(a,e,r))],k=(e,a,r,s=r.bundleName)=>{const m=r.scalar?((c,i,d,N,f)=>N.pathSegments(d).map(({value:p,segments:x})=>((u,S,g,y,l)=>{if(typeof g=="object"||g===null)return null;const A=y[y.length-1];if(typeof A=="number")return null;const b=l[A];return b?{rootName:u.rootName,rootType:u.rootCategory,structName:S,value:g,param:{name:A,attr:b}}:null})(c,i,p,x,f)).filter(p=>p!==null))(e,s,a,r.scalar.jsonPathJS,r.scalar.record):[],o=r.arrays.map(c=>((i,d,N,f)=>{const p=f.jsonPathJS.find(N);if(!Array.isArray(p))return[];const x=f.schema.attr;return Oe(x)?((u,S,g,y)=>S.filter(l=>typeof l=="string").map(l=>({rootName:u.rootName,rootType:u.rootCategory,value:l,structName:g,param:y})))(i,p,d,f.schema):Me(x)?((u,S,g,y)=>S.filter(l=>typeof l=="number").map(l=>({rootName:u.rootName,rootType:u.rootCategory,value:l,structName:g,param:y})))(i,p,d,f.schema):[]})(e,s,a,c));return[m,o].flat(2)},G=(e,a)=>e.scalarsPath?{bundleName:e.name,arrays:L(e.scalarArrays,e.name,a),scalar:Ye(e.scalarsPath,e.objectSchema,a)}:{bundleName:e.name,arrays:L(e.scalarArrays,e.name,a)},L=(e,a,r)=>e.map(s=>({jsonPathJS:r(s.path),schema:s.param,parentType:a})),Ye=(e,a,r)=>({jsonPathJS:r(e),record:a}),Ue=(e,a,r,s)=>({pluginName:e,commandName:a.command,desc:a.desc??"",text:a.text??"",extractors:qe(a,r,s)}),qe=(e,a,r)=>e.args.map(s=>((m,o)=>{const c=m.scalars?G(m.scalars,o):void 0,i=m.structs.items.map(N=>G(N,o)),d=m.structArrays.items.map(N=>G(N,o));return{rootCategory:m.rootCategory,rootName:m.rootName,top:c,structs:i,structArrays:d}})(Re("args",e.command,s,a),r)),Je=(e,a)=>{const r=(s=>new Map(s.map(m=>[m.struct,De(m.params)])))(e.schema.structs);return e.schema.commands.map(s=>[`${e.pluginName}:${s.command}`,Ue(e.pluginName,s,r,a)])},oe=(e,a)=>{const[r,s]=e.parameters,m=`${r}:${s}`,o=a.get(m);if(!o)return{pluginName:r,commandName:s,args:[]};return i=le.parseDeepRecord(e.parameters[3]),{pluginName:(d=o).pluginName,commandName:d.commandName,args:je(i,d.extractors)};var i,d};class ${constructor(a){P(this,"_commandMap");this._commandMap=a}keys(){return Array.from(this._commandMap.keys())}extractMapTexts(a){return ee(a,r=>this.extractArgs(r))}extractBattleText(a){return Q(a,r=>this.extractArgs(r))}extractCommonEventText(a){return Z(a,r=>this.extractArgs(r))}extractArgs(a){const r=oe(a,this._commandMap);return r.args.filter(Xe).map(s=>({code:n.PLUGIN_COMMAND_MZ,value:s.value,paramIndex:3,argName:s.param.name,argTitle:s.param.attr.text??s.param.name,commandName:r.commandName,pluginName:r.pluginName}))}extractCommandTexts(a){return I(a,r=>this.extractArgs(r))}}const Xe=e=>typeof e.value=="string",w=(e,a,r)=>({folder:r,key:a,image:e[a],id:e.id}),E=(e,a)=>({note:ce(e),main:a.map(r=>({key:r,text:e[r],id:e.id}))}),ce=e=>n.readNoteEx(e.note,(a,r)=>({key:a,text:r,id:e.id}));exports.buildReferenceItemSources=(e,a,r,s,m,o)=>[...n.defineTraitItems(r,s),...n.defineGameDataSources(e,a),...n.defineSystemItems(m,o)],exports.compileItemEffectDisplayData=(e,a,r)=>{const s=n.resolveItemEffectLabels(a);return R.mergeItemsSource(r?[...s,...r]:s,e)},exports.compileTraitDisplayData=(e,a)=>R.mergeItemsSource(n.resolveTraitLabels(a),e),exports.createTextDataExtractorFromCommandItems=e=>{const a=new Map(e);return new $(a)},exports.createTextDataExtractorFromSchemas=e=>{const a=(r=s=>new pe.JSONPathJS(s),new Map(e.flatMap(s=>Je(s,r))));var r;return new $(a)},exports.extractBattleEventTexts=Q,exports.extractCommonEventTexts=Z,exports.extractImageFromActor=e=>[w(e,"faceName","faces"),w(e,"characterName","characters"),w(e,"battlerName","sv_actors")],exports.extractImageFromEnemy=e=>({key:"battlerName",image:e.battlerName,id:e.id}),exports.extractItemChangeData=W,exports.extractItemCommands=D,exports.extractItemFromMap=(e,a,r)=>V(e.map,(s,m,o)=>({...ge(s),commands:D(s.list,a,r),eventName:o.name,pageIndex:m})),exports.extractItemFromTroop=(e,a,r)=>{return s=(m,o,c)=>({commands:D(m.list,a,r),eventName:c.name,troopId:c.id,pageIndex:o}),e.flatMap(m=>j(m,s));var s},exports.extractMapText=ee,exports.extractNoteText=ce,exports.extractPluginCommandMzArgs=oe,exports.extractTextData=E,exports.extractTextFromActor=e=>E(e,["name","nickname","profile"]),exports.extractTextFromArmor=e=>E(e,["name","description"]),exports.extractTextFromClass=e=>E(e,["name"]),exports.extractTextFromEnemy=e=>E(e,["name"]),exports.extractTextFromEventCommands=e=>K(e,()=>[]),exports.extractTextFromEventCommandsEx=I,exports.extractTextFromItem=e=>E(e,["name","description"]),exports.extractTextFromSkill=e=>E(e,["name","description","message1","message2"]),exports.extractTextFromState=e=>E(e,["name","message1","message2","message3","message4"]),exports.extractTextFromSystem=e=>({gameTitle:e.gameTitle,currencyUnit:e.currencyUnit,equipTypes:[...e.equipTypes],armorTypes:[...e.armorTypes],weaponTypes:[...e.weaponTypes],terms:{basic:n.makeTermsBasicFromArray(e.terms.basic),commands:n.makeTermsCommandFromArray(e.terms.commands),messages:n.makeTermsMessages(e.terms.messages),params:n.makeParamNamesFromArray(e.terms.params)}}),exports.extractTextFromWeapon=e=>E(e,["name","description"]),exports.replaceActorText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.nickname,a),o=t(e.profile,a);return{...e,name:s,nickname:m,profile:o,note:r}},exports.replaceClassText=(e,a)=>{const r=C(e,a),s=t(e.name,a);return{...e,name:s,note:r}},exports.replaceCommonEventTexts=(e,a)=>({...e,list:M(e.list,a)}),exports.replaceEnemyText=(e,a)=>{const r=C(e,a),s=t(e.name,a);return{...e,name:s,note:r}},exports.replaceEventCommandTexts=M,exports.replaceItemText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.description,a);return{...e,name:s,description:m,note:r}},exports.replaceMapDataTexts=(e,a)=>{const r=t(e.displayName,a),s=C(e,a),m={displayName:r,events:n.repleaceMapEventCommands(e,o=>M(o,a)),note:s};return{...e,...m}},exports.replaceNoteTextByMap=C,exports.replaceSkillText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.description,a),o=t(e.message1,a),c=t(e.message2,a);return{...e,name:s,description:m,message1:o,message2:c,note:r}},exports.replaceStateText=(e,a)=>{const r=C(e,a),s=t(e.name,a),m=t(e.message1,a),o=t(e.message2,a),c=t(e.message3,a),i=t(e.message4,a);return{...e,name:s,message1:m,message2:o,message3:c,message4:i,note:r}},exports.replaceSystemTerms=F,exports.replaceSystemText=(e,a)=>({...e,gameTitle:t(e.gameTitle,a),currencyUnit:t(e.currencyUnit,a),elements:_(e.elements,a),skillTypes:_(e.skillTypes,a),weaponTypes:_(e.weaponTypes,a),armorTypes:_(e.armorTypes,a),equipTypes:_(e.equipTypes,a),terms:F(e.terms,a)}),exports.replaceTextByMap=t,exports.replaceTextForCommand=Y,exports.replaceTextForCommandActor=q,exports.replaceTextForCommandShowChoices=J,exports.replaceTextForCommandShowMessage=U,exports.replaceTroopTexts=(e,a)=>{const r=e.pages.map(s=>({list:M(s.list,a),conditions:s.conditions,span:s.span}));return{...e,pages:r}};
