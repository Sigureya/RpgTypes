"use strict";var ie=Object.defineProperty;var de=(e,a,r)=>a in e?ie(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var R=(e,a,r)=>de(e,typeof a!="symbol"?a+"":a,r);const o=require("./make.cjs2.js"),pe=require("jsonpath-js"),ue=require("@sigureya/rmmz-plugin-schema"),F=require("./mergeItemsSource.cjs.js"),M=(e,a,r)=>e.reduce((t,m)=>(m.code!==o.CHANGE_ARMORS&&m.code!==o.CHANGE_ITEMS&&m.code!==o.CHANGE_WEAPONS||t.push(V(m,a,r)),t),[]),le={[o.CHANGE_WEAPONS]:"weapon",[o.CHANGE_ARMORS]:"armor",[o.CHANGE_ITEMS]:"item"},V=(e,a,r)=>{const t=e.parameters[3]===o.OPERAND_DIRECT?{direct:!0,value:e.parameters[2]}:{direct:!1,variableId:e.parameters[2]},m=e.parameters[0]===o.OPERATION_GAIN?a.gain:e.parameters[0]===o.OPERATION_LOSE?a.lose:a.unknown,n=typeof e.parameters[4]=="boolean"?{includesEquip:e.parameters[4]}:{};return{itemKind:le[e.code],dataId:e.parameters[1],code:e.code,commandNameMZ:r(e.code),operation:m,...n,...t}},ye=e=>!!e,G=(e,a)=>e.pages.map((r,t)=>a(r,t,e)),Y=(e,a)=>e.events.filter(ye).flatMap(r=>G(r,a)),ge=e=>e.conditions.itemId>0&&e.conditions.itemValid?{pageCondition:{itemId:e.conditions.itemId}}:{},s=(e,a)=>{const r=e.trimEnd(),t=a.get(r);return t?t.trimEnd():r},h=(e,a,r=`
`)=>o.replaceNote(e.note,t=>s(t.value,a),r),_=(e,a)=>e.map(r=>{switch(r.code){case o.SHOW_MESSAGE:return q(r,a);case o.SHOW_CHOICES:return X(r,a);case o.SHOW_MESSAGE_BODY:case o.COMMENT_HEAD:case o.COMMENT_BODY:case o.SHOW_SCROLLING_TEXT_BODY:return U(r,a);case o.CHANGE_NAME:case o.CHANGE_NICKNAME:case o.CHANGE_PROFILE:return J(r,a);default:return r}}),U=(e,a)=>{const r=s(e.parameters[0],a);return{code:e.code,indent:e.indent,parameters:[r]}},q=(e,a)=>{const r=e.parameters[4]?s(e.parameters[4],a):"";return o.makeCommandShowMessage({facename:e.parameters[0],faceIndex:e.parameters[1],background:e.parameters[2],positionType:e.parameters[3],speakerName:r},e.indent)},J=(e,a)=>{const r=s(e.parameters[1],a);return{code:e.code,indent:e.indent,parameters:[e.parameters[0],r]}},X=(e,a)=>{const r=e.parameters[0].map(t=>s(t,a));return{code:o.SHOW_CHOICES,indent:e.indent,parameters:[r,e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}},L=(e,a)=>({params:xe(e.params,a),messages:Ne(e.messages,a),commands:Te(e.commands,a),basic:he(e.basic,a)}),he=(e,a)=>[s(e[0],a),s(e[1],a),s(e[2],a),s(e[3],a),s(e[4],a),s(e[5],a),s(e[6],a),s(e[7],a),s(e[8],a),s(e[9],a)],Te=(e,a)=>[s(e[0],a),s(e[1],a),s(e[2],a),s(e[3],a),s(e[4],a),s(e[5],a),s(e[6],a),s(e[7],a),s(e[8],a),s(e[9],a),s(e[10],a),s(e[11],a),s(e[12],a),s(e[13],a),s(e[14],a),s(e[15],a),s(e[16],a),s(e[17],a),s(e[18],a),s(e[19],a),"",s(e[21],a),s(e[22],a),"",s(e[24],a),s(e[25],a)],xe=(e,a)=>[s(e[0],a),s(e[1],a),s(e[2],a),s(e[3],a),s(e[4],a),s(e[5],a),s(e[6],a),s(e[7],a),s(e[8],a),s(e[9],a)],Ne=(e,a)=>({actionFailure:s(e.actionFailure,a),actorDamage:s(e.actorDamage,a),actorDrain:s(e.actorDrain,a),actorGain:s(e.actorGain,a),actorLoss:s(e.actorLoss,a),actorNoDamage:s(e.actorNoDamage,a),actorNoHit:s(e.actorNoHit,a),actorRecovery:s(e.actorRecovery,a),alwaysDash:s(e.alwaysDash,a),autosave:s(e.autosave,a),bgmVolume:s(e.bgmVolume,a),bgsVolume:s(e.bgsVolume,a),buffAdd:s(e.buffAdd,a),buffRemove:s(e.buffRemove,a),commandRemember:s(e.commandRemember,a),counterAttack:s(e.counterAttack,a),criticalToActor:s(e.criticalToActor,a),criticalToEnemy:s(e.criticalToEnemy,a),defeat:s(e.defeat,a),debuffAdd:s(e.debuffAdd,a),emerge:s(e.emerge,a),enemyDamage:s(e.enemyDamage,a),enemyDrain:s(e.enemyDrain,a),enemyGain:s(e.enemyGain,a),enemyLoss:s(e.enemyLoss,a),enemyNoDamage:s(e.enemyNoDamage,a),enemyNoHit:s(e.enemyNoHit,a),enemyRecovery:s(e.enemyRecovery,a),escapeFailure:s(e.escapeFailure,a),escapeStart:s(e.escapeStart,a),evasion:s(e.evasion,a),expNext:s(e.expNext,a),expTotal:s(e.expTotal,a),file:s(e.file,a),loadMessage:s(e.loadMessage,a),levelUp:s(e.levelUp,a),magicEvasion:s(e.magicEvasion,a),magicReflection:s(e.magicReflection,a),meVolume:s(e.meVolume,a),obtainExp:s(e.obtainExp,a),obtainGold:s(e.obtainGold,a),obtainItem:s(e.obtainItem,a),obtainSkill:s(e.obtainSkill,a),partyName:s(e.partyName,a),possession:s(e.possession,a),preemptive:s(e.preemptive,a),saveMessage:s(e.saveMessage,a),seVolume:s(e.seVolume,a),substitute:s(e.substitute,a),surprise:s(e.surprise,a),touchUI:s(e.touchUI,a),useItem:s(e.useItem,a),victory:s(e.victory,a)}),b=(e,a)=>e.map(r=>s(r,a)),z=e=>e.map(a=>a.parameters[0].trimEnd()).join(`
`).trimEnd();class K{constructor(a,r){this.header=a,this.bodies=r}getBodyText(){return z(this.joinCommandBodies())}mergedBody(){return{code:this.header.code,indent:this.header.indent,parameters:[this.getBodyText()]}}joinCommandBodies(){return[this.header,...this.bodies]}normalizedCommands(){return[this.mergedBody()]}}class w{constructor(a,r,t){this.bodyCode=a,this.header=r,this.bodies=t}normalizedCommands(){const a={...this.header,code:this.header.code,indent:this.header.indent,parameters:[...this.header.parameters]};return this.bodies.length===0?[a]:[a,this.mergedBody()]}getBodyText(){return z(this.bodies)}joinCommandBodies(){return this.bodies}mergedBody(){return{code:this.bodyCode,indent:this.header.indent,parameters:[this.getBodyText()]}}}const I=(e,a,r,t)=>{const m=e[a];if(!r(m))throw new Error(`Invalid head at index ${a}: ${JSON.stringify(m)}`);const n=[];for(let c=a+1;c<e.length;c++){const i=e[c];if(!t(i))break;n.push(i)}return{header:m,bodies:n}},fe=(e,a)=>{const{bodies:r,header:t}=((m,n)=>I(m,n,c=>c.code===o.COMMENT_HEAD,c=>c.code===o.COMMENT_BODY))(e,a);return Ee(t)?new w(o.COMMENT_BODY,t,r):new K(t,r)},Ee=e=>e.parameters[0]==="選択肢ヘルプ",Se=(e,a)=>{const{bodies:r,header:t}=((m,n)=>I(m,n,c=>c.code===o.SHOW_MESSAGE,c=>c.code===o.SHOW_MESSAGE_BODY))(e,a);return new w(o.SHOW_MESSAGE_BODY,t,r)},Ae=(e,a)=>{const{bodies:r,header:t}=((m,n)=>I(m,n,c=>c.code===o.SCRIPT_EVAL,c=>c.code===o.SCRIPT_EVAL_BODY))(e,a);return new K(t,r)},be=(e,a)=>{const{bodies:r,header:t}=((m,n)=>I(m,n,c=>c.code===o.SHOW_SCROLLING_TEXT,c=>c.code===o.SHOW_SCROLLING_TEXT_BODY))(e,a);return new w(o.SHOW_SCROLLING_TEXT_BODY,t,r)},Ce={[o.SHOW_MESSAGE]:(e,a,r)=>r.showMessage(Se(e,a),a,e),[o.SCRIPT_EVAL]:(e,a,r)=>r.script(Ae(e,a),a,e),[o.COMMENT_HEAD]:(e,a,r)=>r.comment(fe(e,a),a,e),[o.SHOW_SCROLLING_TEXT]:(e,a,r)=>r.showScrollingText(be(e,a),a,e)},O=e=>((a,r)=>({code:a.code,paramIndex:r,value:a.parameters[r]}))(e,1),ve=e=>e.parameters[0].map((a,r)=>({code:102,paramIndex:r,value:a})),C=(e,a)=>Z(e,a),Z=(e,a)=>e.reduce((r,t,m)=>{if(t.code===o.SHOW_CHOICES)return[...r,...ve(t)];const n=(c=t.code,Ce[c]);var c;if(n){const i=n(e,m,_e);if(i!==void 0)return[...r,i]}if(t.code===o.CHANGE_NICKNAME)return[...r,O(t)];if(t.code===o.CHANGE_NAME)return[...r,O(t)];if(t.code===o.CHANGE_PROFILE)return[...r,O(t)];if(t.code===o.PLUGIN_COMMAND_MZ){const i=a(t);return i.length===0?r:[...r,...i]}return r},[]),_e={comment:e=>{return a=e,{code:o.COMMENT_HEAD,paramIndex:0,value:a.getBodyText()};var a},showMessage:e=>{return a=e,{code:o.SHOW_MESSAGE_BODY,paramIndex:0,value:a.getBodyText(),speaker:(r=a.header,r.parameters[4]?r.parameters[4].trimEnd():"")};var a,r},script:e=>(a=>({code:o.SCRIPT_EVAL,paramIndex:0,value:a.getBodyText()}))(e),showScrollingText:e=>(a=>({code:o.SHOW_SCROLLING_TEXT_BODY,paramIndex:0,value:a.getBodyText()}))(e)},Q=(e,a=()=>[])=>{return r=(t,m,{id:n})=>({eventId:n,commands:C(t.list,a)}),e.map(t=>r(t,0,t));var r},ee=(e,a=()=>[])=>((r,t)=>r.map(m=>G(m,t)))(e,(r,t,{id:m})=>({eventId:m,pageIndex:t,commands:C(r.list,a)})),ae=(e,a=()=>[])=>({note:e.note,noteItems:o.readNote(e.note),displayedName:e.displayName,events:Ie(e,a)}),Ie=(e,a)=>Y(e,(r,t,m)=>({eventId:m.id,pageIndex:t,commands:C(r.list,a),note:m.note,noteItems:o.readNote(m.note),name:m.name})),re=e=>(a=>a.kind.endsWith("[]"))(e.attr),te=e=>e.kind==="struct",se=e=>e.attr.kind==="struct[]",x={type:"string",hasText:!0},u={type:"number",hasText:!1},p={type:"number",hasText:!1},$={string:x,number:{type:"number",hasText:!1},boolean:{type:"boolean"},armor:u,actor:u,class:u,enemy:u,skill:u,state:u,item:u,weapon:u,common_event:u,switch:u,variable:u,troop:u,multiline_string:x,file:{type:"string",hasText:!1},"file[]":{type:"string",hasText:!1},"multiline_string[]":x,"string[]":x,combo:x,select:x,any:x,struct:{type:"struct"},"actor[]":p,"enemy[]":p,"class[]":p,"skill[]":p,"state[]":p,"item[]":p,"weapon[]":p,"common_event[]":p,"troop[]":p,"armor[]":p,"switch[]":p,"variable[]":p,"number[]":p},Me=e=>Oe(e,a=>!0,a=>!0),Oe=(e,a,r)=>{const t=[],m=[],n=[],c=[];return e.forEach(i=>{if(te(i.attr))t.push({name:i.name,attr:i.attr});else if(se(i))m.push(i);else if(re(i)){if(r(i))return void c.push(i)}else a(i)&&n.push(i)}),{structs:t,structArrays:m,scalars:n,scalarArrays:c}};function De(e){const a=e.map(r=>[r.name,r.attr]);return Object.fromEntries(a)}const He=(e,a)=>{if(e.length!==0)return`${a}[${e.map(r=>`"${r.name}"`).join(",")}]`},ke=(e,a)=>e.map(r=>({path:`${a}.${r.name}[*]`,param:r})),me={undefinedStruct:"undefined_struct",cyclicStruct:"cyclic_struct"};function ne(e,a,r,t){const m={items:[],errs:[],frames:[{schemaName:e,basePath:a,ancestry:[]}]},n=Math.max(1,3*r.size+5),c=Array.from({length:n}).reduce(i=>i.frames.length===0?i:function(d,y,B){if(d.frames.length===0)return d;const g=d.frames[d.frames.length-1],N=d.frames.slice(0,-1);if(g.ancestry.includes(g.schemaName))return{frames:N,items:d.items,errs:[...d.errs,{code:B.cyclicStruct,path:g.basePath}]};const f=y.get(g.schemaName);if(!f)return{frames:N,items:d.items,errs:[...d.errs,{code:B.undefinedStruct,path:g.basePath}]};const P=function(E,T){const S=E.ancestry.concat(E.schemaName),v=E.basePath;return[...T.structs.map(A=>({schemaName:A.attr.struct,basePath:`${v}.${A.name}`,ancestry:S})),...T.structArrays.map(A=>({schemaName:A.attr.struct,basePath:`${v}.${A.name}[*]`,ancestry:S}))].reverse()}(g,f);if(f.scalars.length>0||f.scalarArrays.length>0){const E=function(T,{path:S,structName:v}){return{category:"struct",objectSchema:De(T.scalars),name:v,scalarArrays:ke(T.scalarArrays,S),scalarsPath:T.scalars.length>0?He(T.scalars,S):void 0}}(f,{path:g.basePath,structName:g.schemaName});return N.push(...P),{frames:N,items:[...d.items,E],errs:d.errs}}return N.push(...P),{frames:N,items:d.items,errs:d.errs}}(i,r,t),m);return{items:c.items,errors:c.errs}}const Ge=(e,a,r,t=me)=>{const m=e.map(n=>ne(n.attr.struct,`${a}.${n.name}`,r,t));return{items:m.flatMap(n=>n.items),errors:m.flatMap(n=>n.errors)}},we=(e,a,r,t=me)=>{const m=e.map(n=>ne(n.attr.struct,`${a}.${n.name}[*]`,r,t));return{items:m.flatMap(n=>n.items),errors:m.flatMap(n=>n.errors)}},Be=(e,a,r,t)=>(m=>te(m.attr))(r)?Fe(e,r,t):se(r)?Le(e,r,t):re(r)?Pe(e,a,r):Re(e,a,r),Pe=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{category:e,name:"array",objectSchema:{},scalarsPath:void 0,scalarArrays:[{path:`$.${r.name}[*]`,param:r}]},structs:{items:[],errors:[]},structArrays:{items:[],errors:[]}}),Re=(e,a,r)=>({rootCategory:e,rootName:a,scalars:{category:"primitive",name:r.attr.kind,objectSchema:{[r.name]:r.attr},scalarsPath:`$.${r.name}`,scalarArrays:[]},structArrays:{items:[],errors:[]},structs:{items:[],errors:[]}}),Fe=(e,a,r)=>({rootName:a.name,rootCategory:e,scalars:void 0,structArrays:{items:[],errors:[]},structs:Ge([a],"$",r)}),Le=(e,a,r)=>({structArrays:we([a],"$",r),rootName:a.name,rootCategory:e,scalars:void 0,structs:{items:[],errors:[]}}),$e=(e,a)=>a.map(r=>We(e,r)).flat(3),We=(e,a)=>[a.top?D(a,e,a.top):[],a.structs.map(r=>D(a,e,r)),a.structArrays.map(r=>D(a,e,r))],D=(e,a,r)=>{const t=r.bundleName;return[r.scalar?je(e,t,a,r.scalar.jsonPathJS,r.scalar.record):[],r.arrays.map(m=>Ve(e,t,a,m))].flat(2)},je=(e,a,r,t,m)=>t.pathSegments(r).reduce((n,{value:c,segments:i})=>{if(typeof c=="object")return n;const d=i[i.length-1];if(typeof d=="number")return n;const y=m[d];return y&&n.push({roootName:e.rootName,rootType:e.rootCategory,category:"struct",name:a,value:c,param:{name:d,attr:y}}),n},[]),Ve=(e,a,r,t)=>{const m=t.jsonPathJS.find(r);if(!Array.isArray(m))return[];const n=t.schema.attr;return(c=>$[c.kind.replace("[]","")].type==="string")(n)?m.filter(c=>typeof c=="string").map(c=>({value:c,category:"struct",rootType:e.rootCategory,roootName:e.rootName,name:a,param:t.schema})):(c=>$[c.kind.replace("[]","")].type==="number")(n)?m.filter(c=>typeof c=="number").map(c=>({roootName:e.rootName,rootType:e.rootCategory,value:c,category:"struct",name:a,param:t.schema})):[]},H=(e,a)=>e.scalarsPath?{bundleName:e.name,arrays:W(e.scalarArrays,e.name,a),scalar:Ye(e.scalarsPath,e.objectSchema,a)}:{bundleName:e.name,arrays:W(e.scalarArrays,e.name,a)},W=(e,a,r)=>e.map(t=>({jsonPathJS:r(t.path),schema:t.param,parentType:a})),Ye=(e,a,r)=>({jsonPathJS:r(e),record:a}),Ue=(e,a,r,t)=>({pluginName:e,commandName:a.command,desc:a.desc??"",text:a.text??"",extractors:qe(a,r,t)}),qe=(e,a,r)=>e.args.map(t=>((m,n)=>{const c=m.scalars?H(m.scalars,n):void 0,i=m.structs.items.map(y=>H(y,n)),d=m.structArrays.items.map(y=>H(y,n));return{rootCategory:m.rootCategory,rootName:m.rootName,top:c,structs:i,structArrays:d}})(Be("args",e.command,t,a),r)),Je=(e,a)=>{const r=(t=>new Map(t.map(m=>[m.struct,Me(m.params)])))(e.schema.structs);return e.schema.commands.map(t=>[`${e.pluginName}:${t.command}`,Ue(e.pluginName,t,r,a)])},oe=(e,a)=>{const[r,t]=e.parameters,m=`${r}:${t}`,n=a.get(m);if(!n)return{pluginName:r,commandName:t,args:[]};return i=ue.parseDeepRecord(e.parameters[3]),{pluginName:(d=n).pluginName,commandName:d.commandName,args:$e(i,d.extractors)};var i,d};class j{constructor(a){R(this,"_commandMap");this._commandMap=a}keys(){return Array.from(this._commandMap.keys())}extractMapTexts(a){return ae(a,r=>this.extractArgs(r))}extractBattleText(a){return ee(a,r=>this.extractArgs(r))}extractCommonEventText(a){return Q(a,r=>this.extractArgs(r))}extractArgs(a){const r=oe(a,this._commandMap);return r.args.filter(Xe).map(t=>({code:o.PLUGIN_COMMAND_MZ,value:t.value,paramIndex:3,argName:t.param.name,argTitle:t.param.attr.text??t.param.name,commandName:r.commandName,pluginName:r.pluginName}))}extractCommandTexts(a){return C(a,r=>this.extractArgs(r))}}const Xe=e=>typeof e.value=="string",k=(e,a,r)=>({folder:r,key:a,image:e[a],id:e.id}),l=(e,a)=>({note:ce(e),main:a.map(r=>({key:r,text:e[r],id:e.id}))}),ce=e=>o.readNoteEx(e.note,(a,r)=>({key:a,text:r,id:e.id}));exports.buildReferenceItemSources=(e,a,r,t,m,n)=>[...o.defineTraitItems(r,t),...o.defineGameDataSources(e,a),...o.defineSystemItems(m,n)],exports.compileItemEffectDisplayData=(e,a,r)=>{const t=o.resolveItemEffectLabels(a);return F.mergeItemsSource(r?[...t,...r]:t,e)},exports.compileTraitDisplayData=(e,a)=>F.mergeItemsSource(o.resolveTraitLabels(a),e),exports.createTextDataExtractorFromCommandItems=e=>{const a=new Map(e);return new j(a)},exports.createTextDataExtractorFromSchemas=e=>{const a=(r=t=>new pe.JSONPathJS(t),new Map(e.flatMap(t=>Je(t,r))));var r;return new j(a)},exports.extractBattleEventTexts=ee,exports.extractCommonEventTexts=Q,exports.extractImageFromActor=e=>[k(e,"faceName","faces"),k(e,"characterName","characters"),k(e,"battlerName","sv_actors")],exports.extractImageFromEnemy=e=>({key:"battlerName",image:e.battlerName,id:e.id}),exports.extractItemChangeData=V,exports.extractItemCommands=M,exports.extractItemFromMap=(e,a,r)=>Y(e.map,(t,m,n)=>({...ge(t),commands:M(t.list,a,r),eventName:n.name,pageIndex:m})),exports.extractItemFromTroop=(e,a,r)=>{return t=(m,n,c)=>({commands:M(m.list,a,r),eventName:c.name,troopId:c.id,pageIndex:n}),e.flatMap(m=>G(m,t));var t},exports.extractMapText=ae,exports.extractNoteText=ce,exports.extractPluginCommandMzArgs=oe,exports.extractTextData=l,exports.extractTextFromActor=e=>l(e,["name","nickname","profile"]),exports.extractTextFromArmor=e=>l(e,["name","description"]),exports.extractTextFromClass=e=>l(e,["name"]),exports.extractTextFromEnemy=e=>l(e,["name"]),exports.extractTextFromEventCommands=e=>Z(e,()=>[]),exports.extractTextFromEventCommandsEx=C,exports.extractTextFromItem=e=>l(e,["name","description"]),exports.extractTextFromSkill=e=>l(e,["name","description","message1","message2"]),exports.extractTextFromState=e=>l(e,["name","message1","message2","message3","message4"]),exports.extractTextFromSystem=e=>({gameTitle:e.gameTitle,currencyUnit:e.currencyUnit,equipTypes:[...e.equipTypes],armorTypes:[...e.armorTypes],weaponTypes:[...e.weaponTypes],terms:{basic:o.makeTermsBasicFromArray(e.terms.basic),commands:o.makeTermsCommandFromArray(e.terms.commands),messages:o.makeTermsMessages(e.terms.messages),params:o.makeParamNamesFromArray(e.terms.params)}}),exports.extractTextFromWeapon=e=>l(e,["name","description"]),exports.replaceActorText=(e,a)=>{const r=h(e,a),t=s(e.name,a),m=s(e.nickname,a),n=s(e.profile,a);return{...e,name:t,nickname:m,profile:n,note:r}},exports.replaceClassText=(e,a)=>{const r=h(e,a),t=s(e.name,a);return{...e,name:t,note:r}},exports.replaceCommonEventTexts=(e,a)=>({...e,list:_(e.list,a)}),exports.replaceEnemyText=(e,a)=>{const r=h(e,a),t=s(e.name,a);return{...e,name:t,note:r}},exports.replaceEventCommandTexts=_,exports.replaceItemText=(e,a)=>{const r=h(e,a),t=s(e.name,a),m=s(e.description,a);return{...e,name:t,description:m,note:r}},exports.replaceMapDataTexts=(e,a)=>{const r=s(e.displayName,a),t=h(e,a),m={displayName:r,events:o.repleaceMapEventCommands(e,n=>_(n,a)),note:t};return{...e,...m}},exports.replaceNoteTextByMap=h,exports.replaceSkillText=(e,a)=>{const r=h(e,a),t=s(e.name,a),m=s(e.description,a),n=s(e.message1,a),c=s(e.message2,a);return{...e,name:t,description:m,message1:n,message2:c,note:r}},exports.replaceStateText=(e,a)=>{const r=h(e,a),t=s(e.name,a),m=s(e.message1,a),n=s(e.message2,a),c=s(e.message3,a),i=s(e.message4,a);return{...e,name:t,message1:m,message2:n,message3:c,message4:i,note:r}},exports.replaceSystemTerms=L,exports.replaceSystemText=(e,a)=>({...e,gameTitle:s(e.gameTitle,a),currencyUnit:s(e.currencyUnit,a),elements:b(e.elements,a),skillTypes:b(e.skillTypes,a),weaponTypes:b(e.weaponTypes,a),armorTypes:b(e.armorTypes,a),equipTypes:b(e.equipTypes,a),terms:L(e.terms,a)}),exports.replaceTextByMap=s,exports.replaceTextForCommand=U,exports.replaceTextForCommandActor=J,exports.replaceTextForCommandShowChoices=X,exports.replaceTextForCommandShowMessage=q,exports.replaceTroopTexts=(e,a)=>{const r=e.pages.map(t=>({list:_(t.list,a),conditions:t.conditions,span:t.span}));return{...e,pages:r}};
