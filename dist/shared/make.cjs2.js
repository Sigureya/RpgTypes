"use strict";const Q=require("ajv"),o=require("./make.cjs.js"),D=(e,t)=>`\\${e}[${t}]`,le=(e={})=>({switch1Id:e.switch1Id??0,switch1Valid:e.switch1Id!==void 0,switch2Id:e.switch2Id??0,switch2Valid:e.switch2Id!==void 0,variableId:e.variableId??0,variableValid:e.variableId!==void 0,variableValue:e.variableValue??0,selfSwitchCh:e.selfSwitchCh??"A",selfSwitchValid:e.selfSwitchCh!==void 0,itemId:e.itemId??0,itemValid:e.itemId!==void 0,actorId:e.actorId??0,actorValid:e.actorId!==void 0}),it=()=>({characterIndex:0,characterName:"",direction:2,pattern:0,tileId:0}),nt={type:"object",required:["image","moveRoute","conditions","directionFix","moveFrequency"],properties:{moveFrequency:{type:"integer"},directionFix:{type:"boolean"},conditions:{type:"object",required:["switch1Id","switch1Valid","switch2Id","switch2Valid","variableId","variableValid","selfSwitchCh","selfSwitchValid","variableValue","itemId","itemValid","actorId","actorValid"],properties:{switch1Id:{type:"integer",minimum:0},switch1Valid:{type:"boolean"},switch2Id:{type:"integer",minimum:0},switch2Valid:{type:"boolean"},variableId:{type:"integer",minimum:0},variableValid:{type:"boolean"},selfSwitchCh:{type:"string"},selfSwitchValid:{type:"boolean"},variableValue:{type:"integer"},itemId:{type:"integer",minimum:0},itemValid:{type:"boolean"},actorId:{type:"integer"},actorValid:{type:"boolean"}}},image:{type:"object",required:["characterIndex","characterName","direction","pattern","tileId"],properties:{characterIndex:{type:"integer",minimum:0},characterName:{type:"string"},direction:{type:"integer",enum:[2,4,6,8]},pattern:{type:"integer"},tileId:{type:"integer"}}},moveRoute:{type:"object",required:["wait","repeat","skippable","list"],properties:{wait:{type:"boolean"},repeat:{type:"boolean"},skippable:{type:"boolean"},list:{type:"array",items:{type:"object",required:["code","parameters"],properties:{code:{type:"integer"},parameters:{type:"array",items:{oneOf:[{type:"string"},{type:"number"},{type:"object",required:["name","pan","pitch","volume"],properties:{name:{type:"string"},pan:{type:"integer"},pitch:{type:"integer"},volume:{type:"integer"}}}]}}}}}}}}},ot={type:"object",required:["battleback1Name","battleback2Name","note","width","height","x","y","parallaxSy","parallaxSx","parallaxLoopY","parallaxLoopX","disableDashing","parallaxName","parallaxShow","displayName","data","autoplayBgm","bgm","autoplayBgs","bgs"],properties:{data:{type:"array",items:{type:"integer"}},battleback1Name:{type:"string"},battleback2Name:{type:"string"},parallaxLoopY:{type:"boolean"},parallaxLoopX:{type:"boolean"},parallaxName:{type:"string"},parallaxShow:{type:"boolean"},parallaxSy:{type:"integer"},parallaxSx:{type:"integer"},x:{type:"integer",minimum:0},y:{type:"integer",minimum:0},width:{type:"integer",minimum:0},height:{type:"integer",minimum:0},note:{type:"string"},displayName:{type:"string"},disableDashing:{type:"boolean"},autoplayBgm:{type:"boolean"},bgm:{type:"object",required:["name","pan","pitch","volume"],properties:{name:{type:"string"},pan:{type:"integer"},pitch:{type:"integer"},volume:{type:"integer"}}},autoplayBgs:{type:"boolean"},bgs:{type:"object",required:["name","pan","pitch","volume"],properties:{name:{type:"string"},pan:{type:"integer"},pitch:{type:"integer"},volume:{type:"integer"}}},encounterList:{type:"array",items:{type:"object",required:["regionSet","troopId","weight"],properties:{regionSet:{type:"array",items:{type:"integer"}},troopId:{type:"integer"},weight:{type:"integer"}}}},events:{type:"array",items:{type:"object",required:["id","name","x","y","pages"],properties:{id:{type:"integer"},name:{type:"string"},x:{type:"integer"},y:{type:"integer"},note:{type:"string"},pages:{type:"array",items:nt}}}}}},je=new Q({strict:!0}),mt=je.compile({type:"object",required:["name","id","expanded","order","parentId","scrollX","scrollY"],properties:{name:{type:"string"},id:{type:"integer",minimum:0},expanded:{type:"boolean"},order:{type:"integer"},parentId:{type:"integer"},scrollX:{type:"number"},scrollY:{type:"number"}}}),st=je.compile(ot),ue={actor:{title:"アクター",options:{initialEquipments:"初期装備",faceImage:"顔画像",characterImage:"キャラクター画像",svBattlerImage:"SVバトラー画像",nickname:"ニックネーム",profile:"プロフィール",classId:"職業ID",initialLevel:"初期レベル",maxLevel:"最大レベル"}},class:{title:"職業",options:{params:"パラメータ",learnings:"習得スキル",expParams:"経験値パラメータ"}},armor:{title:"防具",options:{armorTypeId:"防具タイプID",slotTypeId:"スロットタイプID"}},enemy:{title:"敵キャラ",options:{dropItems:"ドロップアイテム",battlerHue:"バトラーヒュー",battlerName:"バトラー名",gold:"ゴールド"}},item:{title:"アイテム",options:{consumable:"消耗品"}},skill:{title:"スキル",options:{requiredWeaponTypeId1:"必要武器タイプ1",requiredWeaponTypeId2:"必要武器タイプ2",mpCost:"MP消費",tpCost:"TP消費"}},state:{title:"ステート",options:{restriction:"制約",priority:"優先度",motion:"モーション",overlay:"オーバーレイ",removeAtBattleEnd:"戦闘終了時解除",removeByRestriction:"制約による解除",autoRemovalTiming:"自動解除タイミング",minTurns:"最小ターン数",maxTurns:"最大ターン数",removeByDamage:"ダメージによる解除",chanceByDamage:"ダメージによる解除確率",removeByWalking:"歩行による解除",stepsToRemove:"解除までの歩数"}},weapon:{title:"武器",options:{weaponTypeId:"武器タイプID"}},usableItem:{title:"",options:{scope:"範囲",speed:"速度補正",successRate:"成功率"}},commonEvent:{title:"コモンイベント",options:{trigger:"トリガー",switchId:"スイッチID",name:"名前",id:"ID",list:"コマンドリスト"}}},ye={title:"ダメージ",options:{}},F=(e={})=>({type:e.type??0,elementId:e.elementId??0,formula:e.formula??"",variance:e.variance??0,critical:e.critical??!1}),ge=(e={})=>({dataId:e.dataId??0,denominator:e.denominator??0,kind:e.kind??0}),l="{name}",M="{name} * {value}%",Ee="{name} + {value}%",Ie="{value}",Ae={title:"特徴",options:{regularParam:{title:"基本能力値",format:M,options:{maxHp:"最大HP",maxMp:"最大MP",atk:"攻撃力",def:"防御力",matk:"魔法攻撃力",mdef:"魔法防御力",agi:"敏捷性",luk:"運"}},extraParam:{title:"追加能力値",format:Ee,options:{hitRate:"命中率",evasionRate:"回避率",criticalRate:"クリティカル率",criticalEvasionRate:"クリティカル回避率",magicEvasionRate:"魔法回避率",magicReflectionRate:"魔法反射率",counterAttackRate:"反撃率",hpRegenerationRate:"HP再生率",mpRegenerationRate:"MP再生率",tpRegenerationRate:"TP再生率"}},specialParam:{title:"特殊能力値",format:M,options:{targetRate:"狙われ率",guardEffectRate:"防御効果率",recoveryEffectRate:"回復効果率",pharmacology:"薬の知識",mpCostRate:"MP消費率",tpChargeRate:"TPチャージ率",physicalDamageRate:"物理ダメージ率",magicDamageRate:"魔法ダメージ率",floorDamageRate:"床ダメージ率",experienceRate:"経験値率"}},specialFlag:{title:"特殊フラグ",format:l,options:{autoBattle:"自動戦闘",guard:"防御",substitute:"身代わり",preventEscape:"逃走防止"}},collaps:{title:"消滅エフェクト",format:l,options:{bossCollaps:"ボス崩壊",instantCollaps:"即時崩壊",noneCollaps:"崩壊なし"}},partyAbility:{title:"パーティ能力",format:l,options:{cancelSurprise:"不意打ち無効",dropItemDouble:"アイテムドロップ2倍",encounterHalf:"エンカウント半減",encounterNone:"エンカウントなし",goldDouble:"ゴールド2倍",raisePreemptive:"先制攻撃率アップ"}},elementRate:{title:"属性有効度",format:M},debuffRate:{title:"弱体有効度",format:M},stateRate:{title:"ステート有効度",format:M},stateResist:{title:"ステート無効",format:l},attackElement:{title:"攻撃属性",format:l},attackState:{title:"攻撃ステート",format:Ee},attackSpeed:{title:"攻撃速度補正",format:Ie},attackTimes:{title:"攻撃追加回数",format:Ie},actionPlus:{title:"行動追加",format:M},attackSkill:{title:"攻撃スキル",format:l},equipWeaponType:{title:"装備武器タイプ",format:l},equipArmorType:{title:"装備防具タイプ",format:l},equipLock:{title:"装備固定",format:l},equipSeal:{title:"装備封印",format:l},slotType:{title:"スロットタイプ",format:l},skillAdd:{title:"スキル追加",format:l},skillSeal:{title:"スキルタイプ封印",format:l},skillTypeAdd:{title:"スキルタイプ追加",format:l},skillTypeSeal:{title:"スキルタイプ封印",format:l}}},pt={itemMapper:{placeHolder:"name",dataIdKey:"dataId",kindKey:"code"},placeHolder:{numbers:["value"]}},Te="{name} {value1}%",j="{value1}% + {value2}",_e="{name} {value1}ターン",L="{name}",be={title:"使用効果",options:{addBuff:{desc:"バフを付与する",domainName:"バフ付与",format:_e},addDebuff:{desc:"デバフを付与する",domainName:"デバフ付与",format:_e},gainTp:{desc:"TPを指定した量だけ増加させます。",domainName:"TP増加",format:j},grow:{desc:"成長効果",domainName:"成長効果",format:"{name} + {value1}"},learnSkill:{desc:"スキルを習得する",domainName:"スキル習得",format:L},recoverHp:{desc:"HPを回復します。最大HPに対する割合と一定値のいずれか一方または両方を指定します。アイテムの場合は、特殊能力値[薬の知識]の倍率が適用されます。",domainName:"HP回復",format:j},recoverMp:{desc:"MPを回復します。最大MPに対する割合と一定値のいずれか一方または両方を指定します。アイテムの場合は、特殊能力値[薬の知識]の倍率が適用されます。",domainName:"MP回復",format:j},removeBuff:{desc:"バフを解除する",domainName:"バフ解除",format:L},removeDebuff:{desc:"デバフを解除する",domainName:"デバフ解除",format:L},removeState:{desc:"指定したステートを付加します。",domainName:"ステート付加",format:Te},special:{desc:"特殊効果",domainName:"特殊効果",format:L},addState:{desc:"状態異常を解除する",domainName:"ステート解除",format:Te},commonEvent:{desc:"コモンイベントを実行する",domainName:"コモンイベント",format:L}}},W=(e,t)=>`<${e}:${t}>`,ct=()=>/<([^<>:]{1,100}):([^>]{1,1000})>/g,Y=(e,t)=>{const a=/<([^<>:]{1,100}):([^>]{1,1000})>/g;return Array.from(e.matchAll(a),r=>t(r[1],r[2]))},Se={id:"識別子",name:"名前",note:"メモ",description:"説明",iconIndex:"アイコンインデックス",occasion:"使用タイミング",params:"パラメータ",repeats:"繰り返し回数",scope:"範囲",speed:"速度補正",successRate:"成功率",animationId:"アニメーションID",displayType:"表示タイプ",characterIndex:"キャラクターインデックス",characterName:"キャラクター名",effectName:"効果名",faceIndex:"顔グラフィックインデックス",faceName:"顔グラフィック名",flashTimings:"フラッシュタイミング",list:"リスト",messageType:"メッセージタイプ",offsetX:"オフセットX",offsetY:"オフセットY",overlay:"オーバーレイ",priority:"優先度",restriction:"制約",rotation:"回転",scale:"スケール",soundTimings:"サウンドタイミング",stepsToRemove:"解除までの歩数",type:"タイプ",variance:"分散度",unknownCode:"不明なコード",content:"内容",apply:"適用",turn:"ターン",commonEvent:"コモンイベント",normal:"通常",dualWield:"二刀流",bossCollaps:"ボス崩壊",instantCollaps:"即時崩壊",noneCollaps:"崩壊なし",escape:"逃走"},b=(e,t,a=0)=>({code:e,parameters:[o.makeAudioFileParams(t)],indent:a}),Ce=e=>[e.eventId??0],Ne=e=>[e.min,e.max,e.value],ee=e=>[e],fe=(e,t=0)=>({code:108,indent:t,parameters:ee(e)}),Oe=(e,t=0)=>({code:408,indent:t,parameters:ee(e)}),Re=e=>[e.variableId??0,e.digits??0],he=(e,t=0)=>({code:355,indent:t,parameters:[e]}),ve=(e,t=0)=>({code:655,indent:t,parameters:[e]}),dt={HP:0,MP:1,MHP:2,MMP:3,ATK:4,DEF:5,MAT:6,MDF:7,AGI:8,LUK:9,TP:10},Me=e=>[...e],lt=e=>typeof e=="string"||typeof e=="number"||typeof e=="boolean",C=new Q({strict:!0}),ut=C.compile({type:"object",required:["code","parameters","indent"],properties:{code:{type:"integer",enum:[320,324,325]},indent:{type:"integer"},parameters:{type:"array",minItems:2,maxItems:2,items:[{type:"integer",minimum:0},{type:"string"}]}},additionalProperties:!1}),yt=C.compile({type:"object",properties:{code:{type:"number",const:105},indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:2,maxItems:2,items:[{type:"number"},{type:"boolean"}]}},required:["code","indent","parameters"]}),gt=C.compile({type:"object",required:["code","parameters","indent"],properties:{indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:0,maxItems:0},code:{type:"integer",enum:[0,109,112,113,115,204,206,213,214,216,217,221,222,243,244,251,314,315,340,351,352,353,354,411]}},additionalProperties:!1}),Et=C.compile({type:"object",required:["code","parameters","indent"],properties:{code:{type:"integer",enum:[108,355,401,405,408,655]},indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:1,maxItems:1,items:[{type:"string"}]}},additionalProperties:!1}),R=e=>Et(e),It=C.compile({type:"object",properties:{code:{type:"number",const:117},indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:1,maxItems:1,items:[{type:"number",minimum:0,default:0}]}},required:["code","indent","parameters"]}),At=C.compile({type:"object",properties:{code:{type:"number",const:102},indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:5,maxItems:5,items:[{type:"array",items:{type:"string"}},{type:"integer"},{type:"integer"},{type:"integer"},{type:"integer"}]}},required:["code","indent","parameters"]}),Tt=C.compile({type:"object",properties:{code:{type:"number",const:402},indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:2,maxItems:2,items:[{type:"integer"},{type:"string"}]}},required:["code","indent","parameters"]}),_t=C.compile({type:"object",properties:{code:{type:"number",const:103},indent:{type:"integer",minimum:0},parameters:{type:"array",minItems:2,maxItems:2,items:[{type:"number"},{type:"number"}]}},required:["code","indent","parameters"]}),bt=C.compile({type:"object",required:["code","parameters","indent"],properties:{code:{type:"integer",const:101},indent:{type:"integer",minimum:0},parameters:{type:"array",items:[{type:"string"},{type:"integer",minimum:0,maximum:7},{type:"integer",minimum:0,maximum:2},{type:"integer",minimum:0,maximum:2},{type:"string"}],minItems:5,maxItems:5}}}),We=(e,t)=>({type:"array",items:t,...S(e),...N(e.default)}),S=e=>({...typeof e.text=="string"?{title:e.text}:{},...typeof e.desc=="string"?{description:e.desc}:{}}),N=e=>e!==void 0?{default:e}:{},ke=e=>e===void 0||e===0,St=e=>We(e,{type:"string"}),Ct=e=>{switch(e.kind){case"string":case"multiline_string":return(a=>({type:"string",...S(a),...N(a.default)}))(e);case"file":case"combo":return(a=>({type:"string",...N(a.default),...S(a)}))(e);case"select":return(a=>({type:"string",...N(a.default),...S(a),...a.options?{enum:a.options.map(r=>r.value)}:{}}))(e);case"file[]":case"string[]":case"multiline_string[]":return St(e);case"number[]":return(a=>({type:"array",items:{type:ke(a.decimals)?"integer":"number"},...N(a.default),...S(a)}))(e);case"actor[]":case"weapon[]":case"armor[]":case"skill[]":case"item[]":case"enemy[]":case"state[]":case"class[]":case"troop[]":return(a=>We(a,{type:"integer"}))(e);case"number":return(a=>({type:ke(a.decimals)?"integer":"number",...N(a.default),...S(a)}))(e);case"actor":case"weapon":case"armor":case"skill":case"item":case"enemy":case"state":case"class":case"troop":return(a=>({type:"integer",...N(a.default),...S(a)}))(e);case"boolean":return(a=>({type:"boolean",...N(a.default),...S(a)}))(e);case"struct":return{$ref:`#/definitions/${(t=e).struct}`,...S(t)};default:return{}}var t},Ye=(e,t)=>Object.entries(t).reduce((a,[r,s])=>{if(r in e){const p=e[r];if(typeof p=="string")return{...a,[r]:s(p)}}return a},{}),f=(e,t,a,r)=>({default:t,...Ye(a,r),kind:e}),G=(e,t,a)=>({default:[],...Ye(t,a),kind:e}),ze="help",J="kind",z="text",Pe="struct",Xe=e=>{const t=JSON.parse(e);return Array.isArray(t)?t.map(U):typeof t=="object"&&t!==null?Object.fromEntries(Object.entries(t).map(([a,r])=>[a,U(r)])):t},U=e=>{if(typeof e!="string")return e;try{const t=JSON.parse(e);return Array.isArray(t)?t.map(U):typeof t=="object"&&t!==null?Object.fromEntries(Object.entries(t).map(([a,r])=>[a,U(r)])):t}catch{return e}},Nt=e=>{if(J in e.attr){const t=ft[e.attr.kind];if(t)return t(e)}return f("any","",e.attr,V)},m=e=>e,Ke=e=>e.replace("[","").replace("]","").split(",").map(t=>parseFloat(t.replaceAll('"',"").trim())).filter(t=>!isNaN(t)),V={default:m,text:m,desc:m,parent:m},Le=e=>f("string","",e.attr,V),xe=e=>{const t={default:a=>Xe(a),text:m,desc:m,parent:m};return G("string[]",e.attr,t)},g=(e,t)=>{const a={default:Ke,text:m,desc:m,parent:m};return G(t,e.attr,a)},E=(e,t)=>{const a={default:r=>parseInt(r,10),text:m,desc:m,parent:m};return f(t,0,e.attr,a)},ft={number:e=>(t=>{const a={default:r=>parseFloat(r),text:m,desc:m,decimals:r=>parseInt(r,10),min:r=>parseFloat(r),max:r=>parseFloat(r),parent:m};return f("number",0,t.attr,a)})(e),"number[]":e=>{const t={default:Ke,text:m,desc:m,decimals:a=>parseInt(a,10),min:a=>parseFloat(a),max:a=>parseFloat(a),parent:m};return G("number[]",e.attr,t)},string:Le,"string[]":xe,multiline_string:Le,"multiline_string[]":xe,combo:e=>{var a;const t=((a=e.options)==null?void 0:a.map(r=>r.option))??[];return{...f("combo","",e.attr,V),options:t}},select:e=>{var a;const t=((a=e.options)==null?void 0:a.map(r=>({option:r.option,value:r.value})))??[];return{...f("select","",e.attr,V),options:t}},actor:e=>E(e,"actor"),"actor[]":e=>g(e,"actor[]"),class:e=>E(e,"class"),"class[]":e=>g(e,"class[]"),skill:e=>E(e,"skill"),"skill[]":e=>g(e,"skill[]"),item:e=>E(e,"item"),"item[]":e=>g(e,"item[]"),weapon:e=>E(e,"weapon"),"weapon[]":e=>g(e,"weapon[]"),armor:e=>E(e,"armor"),"armor[]":e=>g(e,"armor[]"),state:e=>E(e,"state"),"state[]":e=>g(e,"state[]"),enemy:e=>E(e,"enemy"),"enemy[]":e=>g(e,"enemy[]"),common_event:e=>E(e,"common_event"),"common_event[]":e=>g(e,"common_event[]"),switch:e=>E(e,"switch"),"switch[]":e=>g(e,"switch[]"),variable:e=>E(e,"variable"),"variable[]":e=>g(e,"variable[]"),troop:e=>E(e,"troop"),"troop[]":e=>g(e,"troop[]"),boolean:e=>{const t={default:a=>a==="true",text:m,desc:m,on:m,off:m,parent:m};return f("boolean",!0,e.attr,t)},file:e=>{const t={default:m,text:m,desc:m,parent:m,dir:m};return{dir:"",...f("file","",e.attr,t)}},"file[]":e=>{const t={default:a=>Xe(a),text:m,desc:m,parent:m,dir:m};return{dir:"",...G("file[]",e.attr,t)}}},Je="BODY",$e="STRUCT",H="NONE",Ot=(e,t)=>{const a=e.lines.length>0?te(e):e,r=t[1]||void 0;return{...a,structName:r,blockType:r?$e:"INVALID",locale:t[2],lines:[]}},Rt=e=>({...e.lines.length>0?te(e):e,blockType:Je,structName:void 0,locale:void 0,lines:[]}),te=e=>e.blockType===Je?{...e,bodies:e.bodies.concat([{lines:[...e.lines]}]),lines:[],blockType:H}:e.structName&&e.blockType===$e?{...e,structs:e.structs.concat([{struct:e.structName,locale:e.locale,lines:[...e.lines]}]),blockType:H,structName:void 0,locale:void 0,lines:[]}:{...e,blockType:H,structName:void 0,lines:[]},ht=e=>e.currentOption?{items:e.items.concat({option:e.currentOption,value:e.currentOption})}:e,$=e=>({...typeof e.desc=="string"?{desc:e.desc}:{},...typeof e.text=="string"?{text:e.text}:{}}),B=e=>{const t=vt(e),a=kt(t);return Mt(a)},vt=e=>{if(e.currentParam&&e.currentOption){const t=e.currentParam.attr.kind;if(t==="select"||t==="combo")return{...e,currentParam:{...e.currentParam,options:ht(e.currentOption).items}}}return e},Mt=e=>e.currentParam?{...e,params:[...e.params,e.currentParam],currentParam:null,currentContext:null}:e,kt=e=>{if(e.currentCommand){const t=e.currentParam?[...e.currentCommand.args,e.currentParam]:e.currentCommand.args,a={...$(e.currentCommand),command:e.currentCommand.command,args:t};return{...e,commands:[...e.commands,a],currentCommand:null,currentParam:null,currentContext:null,currentOption:null}}return e},De=(e,t)=>{const a=e.lines.reduce((r,s)=>{const p=s.trim().replace(/^\*\s?/,"");if(!p.startsWith("@"))return r.currentContext===ze?{...r,helpLines:r.helpLines.concat(p)}:r;const[d,...u]=p.slice(1).split(" "),y=u.join(" ").trim(),A=t[d];return A?A(r,y):r},Lt());return B(a)},Pt=(e,t)=>{const a=(d=>{const u=d.split(`
`),y={structs:[],bodies:[],structName:void 0,locale:void 0,lines:[],blockType:H},A=u.reduce((T,x)=>{const O=x.trim(),P=O.match(/^\/\*~struct~([A-Za-z0-9_]+)(?::([A-Za-z0-9_-]+))?/);return P?Ot(T,P):O==="/*:"?Rt(T):O==="*/"?T.lines.length>0?te(T):T:{...T,lines:T.lines.concat([O])}},y);return{structs:A.structs,bodies:A.bodies}})(e),r=a.structs.map(d=>(u=>{const y=De(u,Ze);return{name:u.struct,params:y.params}})(d)),s=(d=>{if(d.bodies.length!==0)return d.bodies[0]})(a);if(!s)return{params:[],commands:[],meta:{},helpLines:[],structs:r};const p=De(s,t);return{params:p.params,commands:p.commands,meta:p.meta,helpLines:p.helpLines,structs:r}},Lt=()=>({helpLines:[],params:[],commands:[],currentParam:null,currentCommand:null,currentContext:null,currentOption:null,dependencies:{base:[],orderBefore:[],orderAfter:[]},meta:{}}),_=(e,t,a)=>e.currentParam&&!(t in e.currentParam.attr)?{...e,currentParam:{...e.currentParam,attr:{...e.currentParam.attr,[t]:a}}}:e,X=(e,t,a)=>({...e,meta:{[t]:a,...e.meta}}),Ze={param:(e,t)=>{const a=B(e);return a.params.some(r=>r.name===t)?a:{...a,currentContext:"param",currentParam:{name:t,attr:{}}}},text:(e,t)=>e.currentParam?_(e,z,t):e.currentCommand&&!(z in e.currentCommand)?{...e,currentCommand:{...$(e.currentCommand),command:e.currentCommand.command,args:e.currentCommand.args,[z]:t}}:e,desc:(e,t)=>e.currentParam?_(e,"desc",t):e.currentCommand?{...e,currentCommand:{...e.currentCommand,desc:t}}:e,command:(e,t)=>{const a=B(e);return a.commands.some(r=>r.command===t)?a:{...a,currentCommand:{command:t,args:[]},currentParam:null}},arg:(e,t)=>{if(!e.currentCommand)return e;if(e.currentParam){const a={...$(e.currentCommand),command:e.currentCommand.command,args:e.currentCommand.args.concat(e.currentParam)};return{...e,commands:e.commands,currentCommand:a,currentContext:"arg",currentParam:{name:t,attr:{}}}}return{...e,currentParam:{name:t,attr:{}}}},help:e=>({...B(e),currentContext:ze}),option:(e,t)=>{if(!e.currentParam)return e;const a=((r,s)=>r.currentOption?{items:r.items.concat({option:r.currentOption,value:r.currentOption}),currentOption:s}:{items:r.items,currentOption:s})(e.currentOption??{items:[]},t);return{...e,currentOption:a}},value:(e,t)=>{if(!e.currentOption)return e;const a=((r,s)=>r.currentOption?{items:r.items.concat({option:r.currentOption,value:s})}:{items:r.items})(e.currentOption,t);return{...e,currentOption:a}},type:(e,t)=>{if((a=>a.endsWith(">")&&a.startsWith("struct<"))(t)){const a=t.slice(7,-1),r=_(e,Pe,a);return _(r,J,Pe)}return e.currentParam?_(e,J,t):e},default:(e,t)=>_(e,"default",t),on:(e,t)=>_(e,"on",t),off:(e,t)=>_(e,"off",t),min:(e,t)=>_(e,"min",t),max:(e,t)=>_(e,"max",t),base:(e,t)=>{return{...e,dependencies:(a=e.dependencies,r=t,{orderAfter:a.orderAfter,orderBefore:a.orderBefore,base:a.base.concat(r)})};var a,r},orderAfter:(e,t)=>{return{...e,dependencies:(a=e.dependencies,r=t,{base:a.base,orderBefore:a.orderBefore,orderAfter:a.orderAfter.concat(r)})};var a,r},orderBefore:(e,t)=>{return{...e,dependencies:(a=e.dependencies,r=t,{base:a.base,orderAfter:a.orderAfter,orderBefore:a.orderBefore.concat(r)})};var a,r},author:(e,t)=>X(e,"author",t),plugindesc:(e,t)=>X(e,"plugindesc",t),url:(e,t)=>X(e,"url",t)},xt=e=>Dt((t=>Pt(t,Ze))(e)),Dt=e=>({target:"MZ",meta:e.meta,commands:Ft(e.commands),params:Qe(e.params)}),Qe=e=>e.reduce((t,a)=>({[a.name]:Nt(a),...t}),{}),Ft=e=>e.reduce((t,a)=>{const r={desc:a.desc,text:a.text,args:Qe(a.args)};return{[a.command]:r,...t}},{}),Fe=(e={})=>({gameId:e.gameId??0,screenWidth:e.screenWidth??0,screenHeight:e.screenHeight??0,uiAreaWidth:e.uiAreaWidth??0,uiAreaHeight:e.uiAreaHeight??0,windowOpacity:e.windowOpacity??0,screenScale:e.screenScale??1,numberFontFilename:e.numberFontFilename??"",mainFontFilename:e.mainFontFilename??"",fallbackFonts:e.fallbackFonts??"",fontSize:e.fontSize??28}),we=(e={})=>[o.makeAudioFileParams(e.cursor),o.makeAudioFileParams(e.ok),o.makeAudioFileParams(e.cancel),o.makeAudioFileParams(e.buzzer),o.makeAudioFileParams(e.equip),o.makeAudioFileParams(e.save),o.makeAudioFileParams(e.load),o.makeAudioFileParams(e.battleStart),o.makeAudioFileParams(e.escape),o.makeAudioFileParams(e.enemyAttack),o.makeAudioFileParams(e.enemyDamage),o.makeAudioFileParams(e.enemyCollapse),o.makeAudioFileParams(e.bossCollapes1),o.makeAudioFileParams(e.bossCollapes2),o.makeAudioFileParams(e.actorDamage),o.makeAudioFileParams(e.actorCollapse),o.makeAudioFileParams(e.playRecovery),o.makeAudioFileParams(e.playMiss),o.makeAudioFileParams(e.playEvasion),o.makeAudioFileParams(e.playMagicEvasion),o.makeAudioFileParams(e.playReflection),o.makeAudioFileParams(e.shop),o.makeAudioFileParams(e.useItem),o.makeAudioFileParams(e.useSkill)],He=(e={})=>[e.item??!0,e.weapon??!0,e.armor??!0,e.keyItem??!0],Be=(e={})=>[e.item??!0,e.skill??!0,e.equip??!0,e.status??!0,e.formation??!0,e.save??!0],wt={required:["itemCategories","menuCommands"],additionalProperties:!1,type:"object",properties:{itemCategories:{type:"array",maxItems:4,minItems:4,items:{type:"boolean"}},menuCommands:{type:"array",maxItems:6,minItems:6,items:{type:"boolean"}}}},Ge=(e={})=>({optAutosave:e.optAutosave??!0,optDisplayTp:e.optDisplayTp??!0,optDrawTitle:e.optDrawTitle??!0,optExtraExp:e.optExtraExp??!0,optFloorDeath:e.optFloorDeath??!0,optFollowers:e.optFollowers??!0,optKeyItemsNumber:e.optKeyItemsNumber??!0,optSideView:e.optSideView??!0,optSlipDeath:e.optSlipDeath??!0,optTransparent:e.optTransparent??!0,optMessageSkip:e.optMessageSkip??!0,optSplashScreen:e.optSplashScreen??!0}),I={type:"boolean"},Ht={type:"object",additionalProperties:!1,required:["optAutosave","optDisplayTp","optDrawTitle","optExtraExp","optFloorDeath","optFollowers","optKeyItemsNumber","optSideView","optSlipDeath","optTransparent","optMessageSkip","optSplashScreen"],properties:{optAutosave:I,optDisplayTp:I,optDrawTitle:I,optExtraExp:I,optFloorDeath:I,optFollowers:I,optKeyItemsNumber:I,optSideView:I,optSlipDeath:I,optTransparent:I,optMessageSkip:I,optSplashScreen:I}},Ue=e=>({armorTypes:h(e.armorTypes),elements:h(e.elements),equipTypes:h(e.equipTypes),weaponTypes:h(e.weaponTypes),skillTypes:h(e.skillTypes),variables:h(e.variables),switches:h(e.switches)}),h=e=>e?[...e]:[],et=e=>[e.mhp??"",e.mmp??"",e.atk??"",e.def??"",e.mat??"",e.mdf??"",e.agi??"",e.luk??"",e.hit??"",e.eva??""],w=(e={})=>({characterIndex:e.characterIndex??0,characterName:e.characterName??"",bgm:o.makeAudioFileParams(e.bgm??{}),startMapId:e.startMapId??0,startX:e.startX??0,startY:e.startY??0}),Ve=(e={})=>({jsonFormatLevel:e.jsonFormatLevel??0,messageWidth1:e.messageWidth1??816,messageWidth2:e.messageWidth2??816}),tt={type:"object",additionalProperties:!1,required:["type","weaponImageId"],properties:{type:{type:"number"},weaponImageId:{type:"number"}}},at={additionalProperties:!1,type:"object",required:["tileSize","faceSize","iconSize"],properties:{tileSize:{type:"integer",minimum:0},faceSize:{type:"integer",minimum:0},iconSize:{type:"integer",minimum:0}}},rt={additionalProperties:!1,type:"object",required:["actorId","equips","level"],properties:{actorId:{type:"integer"},level:{type:"integer",minimum:1},equips:{type:"array",items:{type:"integer"}}}},k={type:"object",properties:{name:{type:"string"},volume:{type:"integer",minimum:0,maximum:100},pitch:{type:"integer",minimum:0,maximum:100},pan:{type:"integer",minimum:-100,maximum:100}},required:["name","volume","pitch","pan"],additionalProperties:!1},Bt={additionalProperties:!1,type:"object",required:["battleBgm","victoryMe","gameoverMe","titleBgm","defeatMe","sounds"],properties:{battleBgm:k,victoryMe:k,gameoverMe:k,titleBgm:k,defeatMe:k,sounds:{type:"array",items:k,minItems:24,maxItems:24}}},Gt={type:"object",additionalProperties:!1,required:["magicSkills","battleSystem"],properties:{magicSkills:{type:"array",items:{type:"number"},minItems:0,uniqueItems:!0},battleSystem:{type:"number"}}},Ut={additionalProperties:!1,type:"object",required:["startMapId","startX","startY","partyMembersArray"],properties:{startMapId:{type:"integer",minimum:0},startX:{type:"integer",minimum:0},startY:{type:"integer",minimum:0},partyMembersArray:{type:"array",items:{type:"integer",minimum:0}}}},Vt={additionalProperties:!1,type:"object",required:["title1Name","title2Name"],properties:{title1Name:{type:"string"},title2Name:{type:"string"}}},qt={type:"object",additionalProperties:!1,required:["locale","versionId","windowTone"],properties:{locale:{type:"string"},versionId:{type:"number"},windowTone:{type:"array",items:{type:"number"},minItems:4,maxItems:4}}},v={type:"array",items:{type:"string"}},jt={additionalProperties:!1,type:"object",required:["weaponTypes","skillTypes","elements","variables","equipTypes","switches","armorTypes"],properties:{weaponTypes:v,skillTypes:v,elements:v,variables:v,equipTypes:v,switches:v,armorTypes:v}},c={type:"string"},qe={type:"string",nullable:!0},i={type:"string"},Wt={required:["terms","currencyUnit","gameTitle"],additionalProperties:!1,type:"object",properties:{currencyUnit:{type:"string"},gameTitle:{type:"string"},terms:{additionalProperties:!1,type:"object",required:["messages","commands","basic","params"],properties:{messages:{type:"object",additionalProperties:!1,required:["actionFailure","actorDamage","actorNoDamage","actorRecovery","actorGain","actorLoss","actorDrain","alwaysDash","bgmVolume","bgsVolume","commandRemember","criticalToActor","criticalToEnemy","counterAttack","debuffAdd","defeat","enemyDamage","enemyNoDamage","enemyRecovery","enemyGain","enemyLoss","enemyDrain","evasion","expNext","expTotal","escapeFailure","escapeStart","file","loadMessage","meVolume","magicEvasion","magicReflection","obtainExp","obtainGold","obtainItem","obtainSkill","partyName","preemptive","saveMessage","seVolume","substitute","touchUI","victory","useItem"],properties:{actionFailure:i,actorDamage:i,actorNoDamage:i,actorRecovery:i,actorGain:i,actorLoss:i,actorDrain:i,alwaysDash:i,bgmVolume:i,bgsVolume:i,commandRemember:i,criticalToActor:i,criticalToEnemy:i,counterAttack:i,debuffAdd:i,defeat:i,enemyDamage:i,enemyNoDamage:i,enemyRecovery:i,enemyGain:i,enemyLoss:i,enemyDrain:i,evasion:i,expNext:i,expTotal:i,escapeFailure:i,escapeStart:i,file:i,loadMessage:i,meVolume:i,magicEvasion:i,magicReflection:i,obtainExp:i,obtainGold:i,obtainItem:i,obtainSkill:i,partyName:i,preemptive:i,saveMessage:i,seVolume:i,substitute:i,touchUI:i,victory:i,useItem:i,buffAdd:i,buffRemove:i,actorNoHit:i,enemyNoHit:i,autosave:i,emerge:i,levelUp:i,possession:i,surprise:i}},commands:{type:"array",items:[c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,qe,c,c,qe,c,c],minItems:26,maxItems:26},basic:{type:"array",items:{type:"string"},minItems:10,maxItems:10},params:{type:"array",items:{type:"string",minLength:1},minItems:10,maxItems:10,uniqueItems:!0}}}}},Yt={additionalProperties:!1,type:"object",required:["battleback1Name","battleback2Name","battlerHue","battlerName","editMapId","editor","testBattlers","testTroopId"],properties:{testBattlers:{type:"array",items:rt},testTroopId:{type:"integer",minimum:0},battleback1Name:{type:"string"},battleback2Name:{type:"string"},editMapId:{type:"integer",minimum:0},battlerHue:{type:"integer",minimum:0},battlerName:{type:"string"},editor:{additionalProperties:!1,type:"object",required:["messageWidth1","messageWidth2","jsonFormatLevel"],properties:{messageWidth1:{type:"integer",minimum:0,maximum:1e3},messageWidth2:{type:"integer",minimum:0,maximum:1e3},jsonFormatLevel:{type:"integer",minimum:0,maximum:4}}}}},K={additionalProperties:!1,type:"object",required:["characterIndex","characterName","bgm","startMapId","startX","startY"],properties:{characterIndex:{type:"integer",minimum:0,maximum:7},characterName:{type:"string",minLength:1},bgm:{type:"object",additionalProperties:!1,required:["name","volume","pitch","pan"],properties:{name:{type:"string"},volume:{type:"integer",minimum:0,maximum:100},pitch:{type:"integer",minimum:50,maximum:150},pan:{type:"integer",minimum:-100,maximum:100}}},startMapId:{type:"integer",minimum:0},startX:{type:"integer",minimum:0,maximum:5e3},startY:{type:"integer",minimum:0,maximum:5e3}}},zt={additionalProperties:!1,required:["airship","boat","ship","advanced","attackMotions"],type:"object",properties:{airship:K,boat:K,ship:K,advanced:{type:"object",properties:{gameId:{type:"integer"},screenWidth:{type:"integer"},screenHeight:{type:"integer"},uiAreaWidth:{type:"integer"},uiAreaHeight:{type:"integer"},windowOpacity:{type:"integer"},screenScale:{type:"number"},numberFontFilename:{type:"string"},mainFontFilename:{type:"string"},fallbackFonts:{type:"string"},fontSize:{type:"integer"}},required:["gameId","screenWidth","screenHeight","uiAreaWidth","uiAreaHeight","windowOpacity","screenScale","numberFontFilename","mainFontFilename","fallbackFonts","fontSize"],additionalProperties:!1},attackMotions:{type:"array",items:tt}}},Xt=e=>e.reduce((t,a)=>({required:[...t.required,...a.required],properties:{...t.properties,...a.properties}}),{required:[],properties:{}}),q=new Q({strict:!0}),Kt=(e=>{const t=Xt(e);return{additionalProperties:!1,type:"object",required:Array.from(new Set(t.required)),properties:t.properties}})([zt,Bt,Gt,wt,Ht,Ut,at,qt,jt,Wt,Vt,Yt]),Jt=q.compile(Kt),$t=q.compile(rt);q.compile(tt);const Zt=q.compile(at),Qt=e=>[e.level??"Level",e.levelA??"Level",e.hp??"HP",e.hpA??"HP",e.mp??"MP",e.mpA??"MP",e.tp??"TP",e.tpA??"TP",e.experience??"EXP",e.exp??"EXP"],ea=(e,t)=>[e.fight??"Fight",e.escape??"Escape",e.attack??"Attack",e.guard??"Guard",e.item??"Item",e.skill??"Skill",e.equip??"Equip",e.status??"Status",e.formation??"Formation",e.save??"Save",e.gameEnd??"Game End",e.options??"Options",e.weapon??"Weapon",e.armor??"Armor",e.keyItem??"Key Item",e.equip2??"Equip2",e.optimize??"Optimize",e.clear??"Clear",e.newGame??"New Game",e.continue_??"Continue",t,e.toTitle??"To Title",e.cancel??"Cancel",t,e.buy??"Buy",e.sell??"Sell"],n=(e,t)=>typeof e=="string"?e:t,ta=e=>{return{basic:Qt(e.basic??{}),commands:(a=e.commands??{},ea(a,"")),params:et(e.params??{}),messages:(t=e.messages??{},{actionFailure:n(t.actionFailure,"Action failed."),actorDamage:n(t.actorDamage,"%1 took %2 damage."),actorRecovery:n(t.actorRecovery,"%1 recovered %2 HP."),actorGain:n(t.actorGain,"%1 gained %2."),actorLoss:n(t.actorLoss,"%1 lost %2."),actorDrain:n(t.actorDrain,"%1 drained %2 HP."),actorNoDamage:n(t.actorNoDamage,"%1 was not damaged."),actorNoHit:n(t.actorNoHit,"%1 was not hit."),alwaysDash:n(t.alwaysDash,"Always dash."),bgmVolume:n(t.bgmVolume,"BGM volume"),bgsVolume:n(t.bgsVolume,"BGS volume"),commandRemember:n(t.commandRemember,"Command remember."),criticalToActor:n(t.criticalToActor,"%1 dealt %2 damage to %3."),criticalToEnemy:n(t.criticalToEnemy,"%1 dealt %2 damage to %3."),counterAttack:n(t.counterAttack,"%1 countered!"),debuffAdd:n(t.debuffAdd,"%1's %2 was lowered."),defeat:n(t.defeat,"Defeat."),enemyDamage:n(t.enemyDamage,"%1 took %2 damage."),enemyDrain:n(t.enemyDrain,"%1 drained %2 HP."),enemyGain:n(t.enemyGain,"%1 gained %2."),enemyLoss:n(t.enemyLoss,"%1 lost %2."),enemyNoDamage:n(t.enemyNoDamage,"%1 was not damaged."),enemyNoHit:n(t.enemyNoHit,"%1 was not hit."),enemyRecovery:n(t.enemyRecovery,"%1 recovered %2 HP."),evasion:n(t.evasion,"%1 evaded the attack!"),autosave:n(t.autosave,"Autosave"),escapeFailure:n(t.escapeFailure,"Escape failed."),escapeStart:n(t.escapeStart,"%1 started to escape!"),emerge:n(t.emerge,"%1 appeared!"),expNext:n(t.expNext,"Next level in %1 EXP."),expTotal:n(t.expTotal,"Total EXP: %1"),file:n(t.file,"File"),buffAdd:n(t.buffAdd,"%1's %2 was raised."),buffRemove:n(t.buffRemove,"%1's %2 was lowered."),obtainExp:n(t.obtainExp,"%1 EXP obtained."),obtainGold:n(t.obtainGold,"%1 gold obtained."),obtainItem:n(t.obtainItem,"%1 obtained %2."),obtainSkill:n(t.obtainSkill,"%1 learned %2."),levelUp:n(t.levelUp,"%1 leveled up!"),partyName:n(t.partyName,"Party"),loadMessage:n(t.loadMessage,"Load %1?"),meVolume:n(t.meVolume,"ME volume"),possession:n(t.possession,"Possession"),preemptive:n(t.preemptive,"%1 attacked first!"),saveMessage:n(t.saveMessage,"Save %1?"),seVolume:n(t.seVolume,"SE volume"),magicEvasion:n(t.magicEvasion,"%1 evaded the magic!"),magicReflection:n(t.magicReflection,"%1 reflected the magic!"),substitute:n(t.substitute,"%1 took the hit!"),surprise:n(t.surprise,"%1 surprised the enemy!"),touchUI:n(t.touchUI,"Touch UI"),useItem:n(t.useItem,"%1 used %2."),victory:n(t.victory,"Victory!")})};var t,a},Z=e=>e?[...e]:[],aa=e=>(t=>Zt(t))(e)?{tileSize:e.tileSize,faceSize:e.faceSize,iconSize:e.iconSize}:{tileSize:48,faceSize:144,iconSize:32},ra=(e,t)=>e?e.map(t):[],ia=e=>(t=>$t(t))(e)?{actorId:e.actorId,equips:Z(e.equips),level:e.level}:{actorId:0,equips:[],level:1};exports.ABORT_BATTLE=340,exports.BATTLE_PROCESSING=301,exports.CHANGE_ACTOR_IMAGES=322,exports.CHANGE_ARMORS=128,exports.CHANGE_BATTLE_BACKGROUND=283,exports.CHANGE_BATTLE_BGM=132,exports.CHANGE_CLASS=321,exports.CHANGE_DEFEAT_ME=139,exports.CHANGE_ENCOUNTER=136,exports.CHANGE_ENEMY_HP=331,exports.CHANGE_ENEMY_MP=332,exports.CHANGE_ENEMY_STATE=333,exports.CHANGE_ENEMY_TP=342,exports.CHANGE_EXP=315,exports.CHANGE_FORMATION_ACCESS=137,exports.CHANGE_GOLD=125,exports.CHANGE_HP=311,exports.CHANGE_ITEMS=126,exports.CHANGE_MENU_ACCESS=135,exports.CHANGE_MP=312,exports.CHANGE_NAME=320,exports.CHANGE_NICKNAME=324,exports.CHANGE_PARALLAX=284,exports.CHANGE_PARTY_MEMBER=129,exports.CHANGE_PLAYER_FOLLOWERS=216,exports.CHANGE_PROFILE=325,exports.CHANGE_SAVE_ACCESS=134,exports.CHANGE_TILESET=282,exports.CHANGE_TP=313,exports.CHANGE_TRANSPARENCY=211,exports.CHANGE_VEHICLE_BGM=140,exports.CHANGE_VEHICLE_IMAGE=323,exports.CHANGE_VICTORY_ME=133,exports.CHANGE_WEAPONS=127,exports.CHANGE_WINDOW_COLOR=138,exports.COMMENT_BODY=408,exports.COMMENT_HEAD=108,exports.COMMON_EVENT=117,exports.CONDITIONAL_BRANCH=111,exports.CONDITIONAL_BRANCH_ELSE=411,exports.CONTROL_SELF_SWITCH=123,exports.CONTROL_SWITCHES=121,exports.CONTROL_TIMER=124,exports.CONTROL_VARIABLES=122,exports.DEFAULT_DAMAGE_LABELS=ye,exports.DEFAULT_GLOBAL_LABELS=Se,exports.DEFAULT_ITEM_LABELS={title:"アイテム",options:{consumable:"消耗品"}},exports.DEFAULT_SKILL_LABELS={title:"スキル",options:{requiredWeaponTypeId1:"必要武器タイプ1",requiredWeaponTypeId2:"必要武器タイプ2",mpCost:"MP消費",tpCost:"TP消費"}},exports.DEFAULT_SYSTEM_LABELS_BOOLEAN={title:"オプション",options:{optDrawTitle:"ゲームタイトルの描画",optDisplayTp:"ウィンドウにTPを表示",optFloorDeath:"床ダメージで戦闘不能",optSlipDeath:"スリップダメージで戦闘不能",optAutosave:"オートセーブを有効化",optExtraExp:"控えメンバーも経験値を獲得",optFollowers:"隊列歩行",optSideView:"戦闘をサイドビューにする",optKeyItemsNumber:"大事なものの個数を表示",optTransparent:"透明状態で開始",optMessageSkip:"メッセージスキップを有効化",optSplashScreen:"スプラッシュ画面を表示"}},exports.DEFAULT_SYSTEM_LABELS_DATA_TYPES={title:"タイプ",format:"{name}",options:{elements:"属性",equipTypes:"装備タイプ",skillTypes:"スキルタイプ",weaponTypes:"武器タイプ",armorTypes:"防具タイプ",switches:"スイッチ",variables:"変数"}},exports.DEFAULT_USABLE_ITEM_LABELS={title:"",options:{scope:"範囲",speed:"速度補正",successRate:"成功率"}},exports.ENEMY_APPEAR=335,exports.ENEMY_RECOVER_ALL=334,exports.ENEMY_TRANSFORM=336,exports.ERASE_EVENT=214,exports.ERASE_PICTURE=235,exports.EXIT_EVENT_PROCESSING=115,exports.FADEIN_SCREEN=222,exports.FADEOUT_BGM=242,exports.FADEOUT_BGS=246,exports.FADEOUT_SCREEN=221,exports.FILENAME_ACTORS="Actors.json",exports.FILENAME_ANIMATIONS="Animations.json",exports.FILENAME_ARMORS="Armors.json",exports.FILENAME_CLASSES="Classes.json",exports.FILENAME_COMMON_EVENTS="CommonEvents.json",exports.FILENAME_ENEMIES="Enemies.json",exports.FILENAME_ITEMS="Items.json",exports.FILENAME_MAP_INFOS="MapInfos.json",exports.FILENAME_SKILLS="Skills.json",exports.FILENAME_STATES="States.json",exports.FILENAME_SYSTEM="System.json",exports.FILENAME_TILESET="Tilesets.json",exports.FILENAME_TROOPS="Troops.json",exports.FILENAME_WEAPONS="Weapons.json",exports.FLASH_SCREEN=224,exports.FOLDER_AUDIO="audio",exports.FOLDER_AUDIO_BGM="bgm",exports.FOLDER_AUDIO_BGS="bgs",exports.FOLDER_AUDIO_ME="me",exports.FOLDER_AUDIO_SE="se",exports.FOLDER_DATA="data",exports.FOLDER_IMG="img",exports.FOLDER_IMG_BATTLEBACK1="battlebacks1",exports.FOLDER_IMG_BATTLEBACK2="battlebacks2",exports.FOLDER_IMG_CHACTERS="characters",exports.FOLDER_IMG_ENEMIES="enemies",exports.FOLDER_IMG_FACES="faces",exports.FOLDER_IMG_PARALLACES="parallaxes",exports.FOLDER_IMG_PICTURES="pictures",exports.FOLDER_IMG_SV_ACTORS="sv_actors",exports.FOLDER_IMG_SV_ENEMIES="sv_enemies",exports.FOLDER_IMG_SYSTEM="system",exports.FOLDER_IMG_TILESETS="tilesets",exports.FOLDER_IMG_TITLES1="titles1",exports.FOLDER_IMG_TITLES2="titles2",exports.FOLDER_JS="js",exports.FORCE_ACTION=339,exports.GAME_OVER=353,exports.GATHER_FOLLOWERS=217,exports.GET_LOCATION_INFO=285,exports.GET_ONOFF_VEHICLE=206,exports.HITTYPE_CERTAIN=0,exports.HITTYPE_MAGICAL=2,exports.HITTYPE_PHYSICAL=1,exports.INPUT_NUMBER=103,exports.LABEL=118,exports.LABELS_DATA_WEAPON={title:"武器",options:{weaponTypeId:"武器タイプID"}},exports.LABELS_SYSTEM_BATTLER_PARAMS={title:"能力値",options:{agi:"敏捷",atk:"攻撃力",def:"防御力",eva:"回避",hit:"命中",luk:"運",mat:"魔法攻撃力",mdf:"魔法防御力",mhp:"最大HP",mmp:"最大MP"}},exports.LABELS_SYSTEM_GAME_COMMANDS={title:"コマンド",options:{item:"アイテム",skill:"スキル",equip:"装備",status:"ステータス",formation:"編成",options:"オプション",save:"セーブ",gameEnd:"ゲーム終了",armor:"防具",weapon:"武器",newGame:"ニューゲーム",attack:"攻撃",guard:"防御",escape:"逃げる",fight:"戦う",buy:"買う",sell:"売る",cancel:"キャンセル",clear:"クリア",continue_:"続きから",equip2:"装備2",keyItem:"大事なもの",optimize:"最強装備",toTitle:"タイトルへ戻る"}},exports.LABEL_JUMP=119,exports.LABEL_SET_DATA=ue,exports.LABEL_SET_ITEM_EFFECT=be,exports.LABEL_SET_TRAIT=Ae,exports.LOOP=112,exports.LOOP_BREAK=113,exports.MODULE_DATA="data",exports.MOVE_PICTURE=232,exports.NAME_INPUT_PROCESSING=303,exports.NO_OPERATION=0,exports.OPEN_MENU_SCREEN=351,exports.OPEN_SAVE_SCREEN=352,exports.OPERAND_CONSTANT=0,exports.OPERAND_GAMEDATA=3,exports.OPERAND_RANDOM=2,exports.OPERAND_SCRIPT=4,exports.OPERAND_VARIABLE=1,exports.PLAY_BGM=241,exports.PLAY_BGS=245,exports.PLAY_ME=249,exports.PLAY_MOVIE=261,exports.PLAY_SE=250,exports.PLUGIN_COMMAND_MV=356,exports.PLUGIN_COMMAND_MZ=357,exports.RECOVER_ALL=314,exports.RESUME_BGM=244,exports.RETURN_TO_TITLE_SCREEN=354,exports.ROTATE_PICTURE=233,exports.ROUTE_CHANGE_BLEND_MODE=43,exports.ROUTE_CHANGE_FREQ=30,exports.ROUTE_CHANGE_IMAGE=41,exports.ROUTE_CHANGE_OPACITY=42,exports.ROUTE_CHANGE_SPEED=29,exports.ROUTE_DIR_FIX_OFF=36,exports.ROUTE_DIR_FIX_ON=35,exports.ROUTE_END=0,exports.ROUTE_JUMP=14,exports.ROUTE_MOVE_AWAY=11,exports.ROUTE_MOVE_BACKWARD=13,exports.ROUTE_MOVE_DOWN=1,exports.ROUTE_MOVE_FORWARD=12,exports.ROUTE_MOVE_LEFT=2,exports.ROUTE_MOVE_LOWER_L=5,exports.ROUTE_MOVE_LOWER_R=6,exports.ROUTE_MOVE_RANDOM=9,exports.ROUTE_MOVE_RIGHT=3,exports.ROUTE_MOVE_TOWARD=10,exports.ROUTE_MOVE_UP=4,exports.ROUTE_MOVE_UPPER_L=7,exports.ROUTE_MOVE_UPPER_R=8,exports.ROUTE_PLAY_SE=44,exports.ROUTE_SCRIPT=45,exports.ROUTE_STEP_ANIME_OFF=34,exports.ROUTE_STEP_ANIME_ON=33,exports.ROUTE_SWITCH_OFF=28,exports.ROUTE_SWITCH_ON=27,exports.ROUTE_THROUGH_OFF=38,exports.ROUTE_THROUGH_ON=37,exports.ROUTE_TRANSPARENT_OFF=40,exports.ROUTE_TRANSPARENT_ON=39,exports.ROUTE_TURN_180D=22,exports.ROUTE_TURN_90D_L=21,exports.ROUTE_TURN_90D_R=20,exports.ROUTE_TURN_90D_R_L=23,exports.ROUTE_TURN_AWAY=26,exports.ROUTE_TURN_DOWN=16,exports.ROUTE_TURN_LEFT=17,exports.ROUTE_TURN_RANDOM=24,exports.ROUTE_TURN_RIGHT=18,exports.ROUTE_TURN_TOWARD=25,exports.ROUTE_TURN_UP=19,exports.ROUTE_WAIT=15,exports.ROUTE_WALK_ANIME_OFF=32,exports.ROUTE_WALK_ANIME_ON=31,exports.SAVE_BGM=243,exports.SCHEMA_DATA_WEAPON={type:"object",required:["name","id","description","iconIndex","price","params","traits","note","etypeId","animationId"],properties:{name:{type:"string"},id:{type:"integer",minimum:0},description:{type:"string"},iconIndex:{type:"integer",minimum:0},price:{type:"integer",minimum:0},note:{type:"string"},etypeId:{type:"integer",minimum:0},wtypeId:{type:"integer",minimum:0},animationId:{type:"integer",minimum:0},params:{type:"array",items:[{type:"integer"},{type:"integer"},{type:"integer"},{type:"integer"},{type:"integer"},{type:"integer"},{type:"integer"},{type:"integer"}],minItems:8,maxItems:8},damage:{type:"object",properties:{type:{type:"integer",minimum:0},elementId:{type:"integer",minimum:0},formula:{type:"string"},variance:{type:"integer",minimum:0,maximum:100},critical:{type:"boolean",default:!1}},required:["type","elementId","formula","variance","critical"]},traits:{type:"array",items:{type:"object",properties:{code:{type:"integer"},dataId:{type:"integer"},value:{type:"integer"}},required:["code","dataId","value"]}}}},exports.SCRIPT_EVAL=355,exports.SCRIPT_EVAL_BODY=655,exports.SCROLL_MAP=204,exports.SELECT_ITEM=104,exports.SET_EVENT_LOCATION=203,exports.SET_MOVEMENT_ROUTE=205,exports.SET_VEHICLE_LOCATION=202,exports.SET_WEATHER_EFFECT=236,exports.SHAKE_SCREEN=225,exports.SHOP_PROCESSING=302,exports.SHOP_PROCESSING_BODY=605,exports.SHOW_ANIMATION=212,exports.SHOW_BALLOON_ICON=213,exports.SHOW_BATTLE_ANIMATION=337,exports.SHOW_CHOICES=102,exports.SHOW_CHOICES_ITEM=402,exports.SHOW_MESSAGE=101,exports.SHOW_MESSAGE_BODY=401,exports.SHOW_PICTURE=231,exports.SHOW_SCROLLING_TEXT=105,exports.SHOW_SCROLLING_TEXT_BODY=405,exports.SKIP=109,exports.SPECIAL_EFFECT_ESCAPE=0,exports.SRC_DATA_ACTOR="actor",exports.SRC_DATA_ARMOR="armor",exports.SRC_DATA_CLASS="class",exports.SRC_DATA_COMMON_EVNET="common_event",exports.SRC_DATA_ENEMY="enemy",exports.SRC_DATA_ITEMS="item",exports.SRC_DATA_MAP="map",exports.SRC_DATA_SKILL="skill",exports.SRC_DATA_STATE="state",exports.SRC_DATA_TROOP="troop",exports.SRC_DATA_WEAPON="weapon",exports.STOP_SE=251,exports.TINT_PICTURE=234,exports.TINT_SCREEN=223,exports.TRANSFER_PLAYER=201,exports.WAIT=230,exports.cloneChoices=e=>({code:e.code,indent:e.indent,parameters:[[...e.parameters[0]],e.parameters[1],e.parameters[2],e.parameters[3],e.parameters[4]]}),exports.cloneEventCommand=e=>({code:e.code,indent:e.indent,parameters:Me(e.parameters)}),exports.cloneParameters=Me,exports.convertCommentArrayToObject=e=>({comment:e[0]}),exports.createActorControlChars=e=>e.map(t=>({text:t.name,controlChar:D("N",t.id)})),exports.createControlCharFormat=D,exports.createEventCommand=(e,t,a=0)=>({code:e,indent:a,parameters:t}),exports.createNoteEntity=W,exports.createSystemVariableControlChars=e=>e.variables.map((t,a)=>({text:t||"",controlChar:D("V",a)})).filter(t=>t.text!==""),exports.formatItemEffectText=(e,t,a)=>{const r=a.find(p=>p.id===t.dataId),s=r?r.name:"Unknown Item";return e.pattern.replaceAll("{value1}",t.value1.toString()).replaceAll("{value2}",t.value2.toString()).replaceAll("{name}",s)},exports.formatTraitText=(e,t,a)=>{const r=o.compileFormatRule(pt);return o.applyFormatRule(t,a,r,e.pattern,s=>s.dataId)},exports.fromArrayCommonEvent=e=>({eventId:e[0]}),exports.fromArrayControlSwitches=e=>({min:e[0],max:e[1],value:e[2]}),exports.fromArrayInputNumber=e=>({variableId:e[0],digits:e[1]}),exports.fromArraySetupChoice=e=>({choices:e[0],cancelType:e[1],defaultType:e[2],positionType:e[3],background:e[4]}),exports.fromArraySetupChoiceItem=e=>({index:e[0],name:e[1]}),exports.fromArrayShowMessageHeader=e=>({facename:e[0],faceIndex:e[1],background:e[2],positionType:e[3],speakerName:e[4]}),exports.fromStringArray=(e,t)=>t.map((a,r)=>({text:a,controlChar:D(e,r)})),exports.getActorValue=(e,t)=>{switch(t[6]){case 0:return e.level;case 1:return e.currentExp();case 2:return e.hp;case 3:return e.mp;case 12:return e.tp}return t[6]>=4&&t[6]<=11?e.param(t[6]-4):0},exports.getArmorCategoryEnabled=e=>e.itemCategories[2],exports.getControlChars=e=>Array.from(e.matchAll(/\\([A-Za-z]+)\[(\d+)]/g)).map(t=>({char:t[1],id:parseInt(t[2],10)})),exports.getEnemyValue=(e,t)=>{switch(t[6]){case 0:return e.hp;case 1:return e.mp;case 10:return e.tp}return t[6]>=2&&t[6]<=9?e.param(t[6]-2):0},exports.getEquipCommandEnabled=e=>e.menuCommands[2],exports.getFormationCommandEnabled=e=>e.menuCommands[4],exports.getItemCategoryEnabled=e=>e.itemCategories[0],exports.getItemCommandEnabled=e=>e.menuCommands[0],exports.getKeyItemCategoryEnabled=e=>e.itemCategories[3],exports.getNoteValue=(e,t)=>{const a=/<([^<>:]{1,100}):([^>]{1,1000})>/g,r=Array.from(e.matchAll(a)).find(s=>s[1]===t);return r?r[2]:void 0},exports.getParamNames=e=>e.terms.params.map((t,a)=>({name:t,id:a})),exports.getSaveCommandEnabled=e=>e.menuCommands[5],exports.getSkillCommandEnabled=e=>e.menuCommands[1],exports.getStatusCommandEnabled=e=>e.menuCommands[3],exports.getWeaponCategoryEnabled=e=>e.itemCategories[1],exports.isCloneableCommand=e=>e.parameters.every(lt),exports.isCommandChangeActorText=e=>ut(e),exports.isCommandCommentBody=e=>R(e)&&e.code===408,exports.isCommandCommentHeader=e=>R(e)&&e.code===108,exports.isCommandCommonEvent=e=>It(e),exports.isCommandInputNumber=e=>_t(e),exports.isCommandNonParam=e=>gt(e),exports.isCommandScriptBody=e=>R(e)&&e.code===655,exports.isCommandScriptHeader=e=>R(e)&&e.code===355,exports.isCommandScrollTextHead=e=>yt(e),exports.isCommandShowChoiceItem=e=>Tt(e),exports.isCommandShowChoices=e=>At(e),exports.isCommandShowMessage=e=>bt(e),exports.isCommandShowMessageBody=e=>R(e)&&e.code===401,exports.isCommandShowScrollingTextBody=e=>R(e)&&e.code===405,exports.isCommandTextBody=R,exports.isDataMap=e=>st(e),exports.isDataMapInfo=e=>mt(e),exports.isDataSystem=e=>Jt(e),exports.labelsRegistry=()=>({rpg:{damage:ye,data:ue,traits:Ae,itemEffect:be},global:Se}),exports.makeActorData=(e={})=>({name:e.name??"",id:e.id??0,battlerName:e.battlerName??"",characterName:e.characterName??"",characterIndex:e.characterIndex??0,faceName:e.faceName??"",faceIndex:e.faceIndex??0,traits:[],note:e.note??"",classId:e.classId??0,nickname:e.nickname??"",profile:e.profile??"",equips:[],initialLevel:e.initialLevel??0,maxLevel:e.maxLevel??0}),exports.makeArmorData=(e={})=>({id:e.id??0,name:e.name??"",iconIndex:e.iconIndex??0,description:e.description??"",traits:e.traits??[],note:e.note??"",atypeId:e.atypeId??0,params:e.params??[0,0,0,0,0,0,0,0],etypeId:e.etypeId??0,price:e.price??0}),exports.makeAudioCommand=(e,t)=>b(e,o.makeAudioFileParams({name:t})),exports.makeBooleanOptions=Ge,exports.makeClassData=(e={})=>({name:e.name??"",id:e.id??0,traits:[],note:e.note??"",params:[0,0,0,0,0,0,0,0],learnings:e.learnings??[],expParams:e.expParams??[]}),exports.makeCommandAudioAny=b,exports.makeCommandChangeActorImages=({actorId:e=1,faceIndex:t=0,faceName:a="",characterIndex:r=0,characterName:s="",battlerName:p=""}={},d=0)=>({code:322,indent:d,parameters:[e,s,r,a,t,p]}),exports.makeCommandChangeActorName=(e,t=0)=>({code:320,parameters:[e.actorId,e.name],indent:t}),exports.makeCommandChangeActorNickName=(e,t=0)=>({code:324,parameters:[e.actorId,e.nickname],indent:t}),exports.makeCommandChangeActorProfile=(e,t=0)=>({code:325,parameters:[e.actorId,e.profile],indent:t}),exports.makeCommandChangeBattleBGM=(e,t=0)=>b(132,e,t),exports.makeCommandChangeDefeatME=(e,t=0)=>b(139,e,t),exports.makeCommandChangeVictoryME=(e,t=0)=>b(133,e,t),exports.makeCommandCommentBody=Oe,exports.makeCommandCommentHeader=fe,exports.makeCommandCommonEvent=(e,t=0)=>({code:117,indent:t,parameters:Ce(e??{})}),exports.makeCommandControlSwitches=(e,t=0)=>({code:121,indent:t,parameters:Ne(e)}),exports.makeCommandInputNumber=(e,t=0)=>({code:103,indent:t,parameters:Re(e??{})}),exports.makeCommandMovePicture=({pictureId:e,origin:t,x:a,y:r,scaleX:s,scaleY:p,opacity:d,blendMode:u,wait:y=!1,easingType:A=0})=>({code:232,indent:0,parameters:[e,t,a,r,s,p,d,u,y,A]}),exports.makeCommandPlayBGM=(e,t=0)=>b(241,e,t),exports.makeCommandPlayBGS=(e,t=0)=>b(245,e,t),exports.makeCommandPlayME=(e,t=0)=>b(249,e,t),exports.makeCommandPlaySE=(e,t=0)=>b(250,e,t),exports.makeCommandScriptArray=(e,t=0)=>e.map((a,r)=>r===0?he(a,t):ve(a,t)),exports.makeCommandScriptBody=ve,exports.makeCommandScriptHeader=he,exports.makeCommandSetupChoice=(e,t=0)=>({code:102,indent:t,parameters:[(e==null?void 0:e.choices)??[],(e==null?void 0:e.cancelType)??0,(e==null?void 0:e.defaultType)??0,(e==null?void 0:e.positionType)??2,(e==null?void 0:e.background)??0]}),exports.makeCommandShowChoiceItem=(e,t=0)=>({code:402,indent:t,parameters:[(e==null?void 0:e.index)??0,(e==null?void 0:e.name)??""]}),exports.makeCommandShowMessage=(e,t=0)=>({code:101,indent:t,parameters:[(e==null?void 0:e.facename)??"",(e==null?void 0:e.faceIndex)??0,(e==null?void 0:e.background)??0,(e==null?void 0:e.positionType)??2,(e==null?void 0:e.speakerName)??""]}),exports.makeCommandShowMessageBody=(e,t=0)=>({code:401,indent:t,parameters:[e]}),exports.makeCommandShowPicture=({pictureId:e=0,origin:t=0,name:a="",x:r=0,y:s=0,scaleX:p=100,scaleY:d=100,opacity:u=255,blendMode:y=0})=>({code:231,indent:0,parameters:[e,a,t,r,s,p,d,u,y]}),exports.makeCommentArray=ee,exports.makeCommentCommandArray=(e,t=0)=>e.map((a,r)=>r===0?fe(a,t):Oe(a,t)),exports.makeCommonEventData=(e={})=>({id:e.id??0,name:e.name??"",trigger:e.trigger??0,list:e.list??[],switchId:e.switchId??0}),exports.makeDamage=F,exports.makeDataNames=Ue,exports.makeDropItem=ge,exports.makeEditorSetting=Ve,exports.makeEnemyAction=(e={})=>({conditionParam1:e.conditionParam1??0,conditionParam2:e.conditionParam2??0,conditionType:e.conditionType??0,rating:e.rating??0,skillId:e.skillId??0}),exports.makeEnemyData=(e={})=>{var t;return{name:e.name??"",id:e.id??0,battlerName:e.battlerName??"",battlerHue:e.battlerHue??0,dropItems:((t=e.dropItems)==null?void 0:t.map(()=>ge()))??[],exp:e.exp??0,gold:e.gold??0,traits:[],note:e.note??"",params:[0,0,0,0,0,0,0,0],actions:[]}},exports.makeEventPageCondition=le,exports.makeGameInitial=(e={})=>({startMapId:e.startMapId??0,startX:e.startX??0,startY:e.startY??0,partyMembersArray:e.partyMembersArray?Array.from(e.partyMembersArray):[1]}),exports.makeItemCategories=He,exports.makeItemCategoriesFromArray=e=>({item:e[0],weapon:e[1],armor:e[2],keyItem:e[3]}),exports.makeItemData=(e={})=>({animationId:e.animationId??0,id:e.id??0,name:e.name??"",iconIndex:e.iconIndex??0,description:e.description??"",itypeId:e.itypeId??0,note:e.note??"",consumable:e.consumable??!1,scope:e.scope??0,occasion:e.occasion??0,speed:e.speed??0,successRate:e.successRate??0,repeats:e.repeats??0,tpGain:e.tpGain??0,hitType:e.hitType??0,damage:F(e.damage??{}),effects:[],price:0}),exports.makeMapData=(e={})=>({data:e.data??[],battleback1Name:e.battleback1Name??"",battleback2Name:e.battleback2Name??"",autoplayBgm:e.autoplayBgm??!1,autoplayBgs:e.autoplayBgs??!1,parallaxLoopX:e.parallaxLoopX??!1,parallaxLoopY:e.parallaxLoopY??!1,parallaxName:e.parallaxName??"",parallaxShow:e.parallaxShow??!1,parallaxSx:e.parallaxSx??0,parallaxSy:e.parallaxSy??0,x:e.x??0,y:e.y??0,width:e.width??0,height:e.height??0,note:e.note??"",bgm:e.bgm??{name:"",pan:0,pitch:100,volume:100},bgs:e.bgs??{name:"",pan:0,pitch:100,volume:100},disableDashing:e.disableDashing??!1,displayName:e.displayName??"",encounterList:e.encounterList??[],events:e.events??[]}),exports.makeMapEvent=()=>({id:1,name:"",pages:[],note:"",x:0,y:0}),exports.makeMapEventIamge=it,exports.makeMapEventPage=()=>({conditions:le(),list:[],directionFix:!1,image:{characterIndex:0,characterName:"",direction:2,pattern:0,tileId:0},moveFrequency:5,moveRoute:{list:[],repeat:!1,skippable:!1,wait:!1}}),exports.makeMapInfoData=(e={id:0})=>{return{name:e.name??(t=e.id,t.toString().padStart(3,"0")),id:e.id,expanded:e.expanded??!1,order:e.order??0,parentId:e.parentId??0,scrollX:e.scrollX??0,scrollY:e.scrollY??0};var t},exports.makeMenuCommandsEnabled=Be,exports.makeMenuCommandsEnabledFromArray=e=>({item:e[0],skill:e[1],equip:e[2],status:e[3],formation:e[4],save:e[5]}),exports.makeParamNamesArray=et,exports.makeRegex=ct,exports.makeSkillData=(e={})=>({stypeId:e.stypeId??0,requiredWtypeId1:e.requiredWtypeId1??0,requiredWtypeId2:e.requiredWtypeId2??0,animationId:e.animationId??0,damage:F(e.damage??{}),description:e.description??"",effects:[],hitType:e.hitType??0,iconIndex:e.iconIndex??0,id:e.id??0,message1:e.message1??"",message2:e.message2??"",messageType:e.messageType??0,name:e.name??"",note:e.note??"",mpCost:e.mpCost??0,occasion:e.occasion??0,repeats:e.repeats??0,scope:e.scope??0,speed:e.speed??0,successRate:e.successRate??0,tpCost:e.tpCost??0,tpGain:e.tpGain??0}),exports.makeSoundsArray=we,exports.makeSoundsObject=e=>({cursor:e[0],ok:e[1],cancel:e[2],buzzer:e[3],equip:e[4],save:e[5],load:e[6],battleStart:e[7],escape:e[8],enemyAttack:e[9],enemyDamage:e[10],enemyCollapse:e[11],bossCollapes1:e[12],bossCollapes2:e[13],actorDamage:e[14],actorCollapse:e[15],playRecovery:e[16],playMiss:e[17],playEvasion:e[18],playMagicEvasion:e[19],playReflection:e[20],shop:e[21],useItem:e[22],useSkill:e[23]}),exports.makeStateData=(e={})=>({name:e.name??"",id:e.id??0,iconIndex:e.iconIndex??0,message1:e.message1??"",message2:e.message2??"",message3:e.message3??"",message4:e.message4??"",traits:[],note:e.note??"",messageType:e.messageType??0,releaseByDamage:e.releaseByDamage??!1,restriction:e.restriction??0,priority:e.priority??0,motion:e.motion??0,overlay:e.overlay??0,removeAtBattleEnd:e.removeAtBattleEnd??!1,removeByRestriction:e.removeByRestriction??!1,autoRemovalTiming:e.autoRemovalTiming??0,minTurns:e.minTurns??0,maxTurns:e.maxTurns??0,removeByDamage:e.removeByDamage??!1,chanceByDamage:e.chanceByDamage??0,removeByWalking:e.removeByWalking??!1,stepsToRemove:e.stepsToRemove??0}),exports.makeSystemAdvanced=Fe,exports.makeSystemData=e=>{var a,r,s,p,d,u,y,A,T,x,O,P,ae,re,ie,ne,oe,me,se,pe,ce,de;const t=aa(e.size);return{...Ge(e.options),currencyUnit:((a=e.texts)==null?void 0:a.currencyUnit)??"",gameTitle:((r=e.texts)==null?void 0:r.gameTitle)??"",sounds:we(e.sounds),editor:Ve(e.editing),advanced:Fe(e.advanced),title1Name:((s=e.images)==null?void 0:s.title1Name)??"",title2Name:((p=e.images)==null?void 0:p.title2Name)??"",...Ue(e.dataNames??{}),magicSkills:Z([]),airship:w((d=e.vehicles)==null?void 0:d.airship),boat:w((u=e.vehicles)==null?void 0:u.boat),ship:w((y=e.vehicles)==null?void 0:y.ship),defeatMe:o.makeAudioFileParams((A=e.me)==null?void 0:A.defeatMe),gameoverMe:o.makeAudioFileParams((T=e.me)==null?void 0:T.gameoverMe),titleBgm:o.makeAudioFileParams((x=e.bgm)==null?void 0:x.titleBgm),tileSize:t.tileSize,faceSize:t.faceSize,iconSize:t.iconSize,versionId:1,attackMotions:[],battleback1Name:((O=e.battleTest)==null?void 0:O.battleback1Name)??"",battleback2Name:((P=e.battleTest)==null?void 0:P.battleback2Name)??"",testTroopId:((ae=e.battleTest)==null?void 0:ae.testTroopId)??0,testBattlers:ra((re=e.battleTest)==null?void 0:re.testBattlers,ia),battleBgm:o.makeAudioFileParams((ie=e.bgm)==null?void 0:ie.battleBgm),victoryMe:o.makeAudioFileParams((ne=e.me)==null?void 0:ne.victoryMe),editMapId:((oe=e.editorTemporary)==null?void 0:oe.editMapId)??0,battlerName:((me=e.editorTemporary)==null?void 0:me.battlerName)??"",locale:"",startMapId:((se=e.gameInit)==null?void 0:se.startMapId)??0,startX:((pe=e.gameInit)==null?void 0:pe.startX)??0,startY:((ce=e.gameInit)==null?void 0:ce.startY)??0,windowTone:[0,0,0,0],terms:ta(e.terms??{}),itemCategories:He(e.itemCategories),partyMembersArray:Z((de=e.gameInit)==null?void 0:de.partyMembersArray),battleSystem:0,battlerHue:0,menuCommands:Be(e.menuComamnds)}},exports.makeTitleCommandWindow=e=>({background:e.background??0,offsetX:e.offsetX??0,offsetY:e.offsetY??0}),exports.makeTroopData=(e={})=>({id:e.id??0,name:e.name??"",members:e.members??[],pages:e.pages??[]}),exports.makeTroopEventConditions=(e={})=>({actorHp:e.actorHp??0,actorId:e.actorId??0,enemyValid:e.enemyValid??0,switchValid:e.switchValid??0}),exports.makeTroopMember=(e={})=>({enemyId:e.enemyId??0,x:e.x??0,y:e.y??0,hidden:e.hidden??!1}),exports.makeVehicleData=w,exports.makeWeaponData=(e={})=>({id:e.id??0,name:e.name??"",iconIndex:e.iconIndex??0,description:e.description??"",traits:e.traits??[],note:e.note??"",animationId:e.animationId??0,params:e.params??[0,0,0,0,0,0,0,0],etypeId:e.etypeId??0,price:e.price??0,damage:F(e.damage??{}),wtypeId:e.wtypeId??0}),exports.normalizeDataActor=e=>({name:e.name??"",id:e.id??0,battlerName:e.battlerName??"",characterName:e.characterName??"",characterIndex:e.characterIndex??0,faceName:e.faceName??"",faceIndex:e.faceIndex??0,traits:[],note:e.note??"",classId:e.classId??0,nickname:e.nickname??"",profile:e.profile??"",equips:[],initialLevel:e.initialLevel??0,maxLevel:e.maxLevel??0}),exports.pluginSourceToJSON=e=>xt(e),exports.readNote=e=>Y(e,(t,a)=>[t,a]),exports.readNoteEx=Y,exports.readNoteObject=(e,t)=>Y(e.note,(a,r)=>t(a,r,e)),exports.replaceNote=(e,t)=>{if(e.length>=3e3)throw new Error("Note text is too long. Please shorten it.");return e.replaceAll(/<([^<>:]{1,100}):([^>]{1,1000})>/g,(a,r,s)=>{const p=t(r,s);if(p.length>=1e3)throw new Error("Note text is too long. Please shorten it.");return W(r,p)})},exports.setNoteValue=(e,t,a)=>{const r=/<([^<>:]{1,100}):([^>]{1,1000})>/g;return e.replace(r,(s,p)=>p===t?W(p,a):s)},exports.structToJSONSchema=e=>(t=>{const a=Object.entries(t).reduce((r,[s,p])=>{const d=Ct(p);return{...r,[s]:d}},{});return{type:"object",properties:a,required:Object.keys(a),additionalProperties:!1}})(e),exports.toArrayCommonEvent=Ce,exports.toArrayControlSwitches=Ne,exports.toArrayInputNumber=Re,exports.toArrayOperandActorStatus=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,3,3,t.index,t.param],exports.toArrayOperandConstant=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,0,t.value],exports.toArrayOperandEnemyStatus=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,3,4,t.index,dt[t.param]],exports.toArrayOperandItemData=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,3,t.type,t.itemId],exports.toArrayOperandRandom=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,2,t.min,t.max],exports.toArrayOperandScript=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,4,t.code],exports.toArrayOperandVariable=(e,t,a=0)=>[e.startId,e.endId??e.startId,a,1,t.variableId],exports.toArraySetupChoice=e=>[e.choices??[],e.cancelType??0,e.defaultType??0,e.positionType??2,e.background??0],exports.toArraySetupChoiceItem=e=>[e.index??0,e.name??""],exports.toArrayShowMessageHeader=e=>[e.facename,e.faceIndex,e.background,e.positionType,e.speakerName];
